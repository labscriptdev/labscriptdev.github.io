import{V as k,a as q,R as $e,B as je,L as We,b as he,T as Qe,c as Ze,F as Ie,d as Re,e as Ke,f as we}from"./three.module.6da1ccc8.js";import{B as ne}from"./entry.0189ed9e.js";const fe=new Map,Je=5,te=(E,d=!1)=>{if(!fe.has(E))fe.set(E,1);else{const p=fe.get(E);if(typeof p>"u"||p>=Je)return;fe.set(E,p+1)}d?console.error(`%c [enable3d] ${E} `,"background: #222; color: #bada55"):console.warn(`%c [enable3d] ${E} `,"background: #222; color: #bada55")};var Pe={},ve={};Object.defineProperty(ve,"__esModule",{value:!0});ve.VERSION=void 0;ve.VERSION="0.0.5";/**
 * @package      npmjs.com/package/@yandeu/events (events.min.js)
 *
 * @author       Arnout Kazemier (https://github.com/3rd-Eden)
 * @copyright    Copyright (c) 2014 Arnout Kazemier
 * @license      {@link https://github.com/primus/eventemitter3/blob/master/LICENSE|MIT}
 *
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/yandeu/events
 * @license      {@link https://github.com/yandeu/events/blob/master/LICENSE|MIT}
 */var Fe=ne&&ne.__spreadArray||function(E,d){for(var p=0,M=d.length,h=E.length;p<M;p++,h++)E[h]=d[p];return E};Object.defineProperty(Pe,"__esModule",{value:!0});var Xe=Pe.Events=void 0,Ye=ve,qe=function(){function E(d,p,M){M===void 0&&(M=!1),this.fn=d,this.context=p,this.once=M}return E}(),He=function(E,d,p,M,h){if(typeof p!="function")throw new TypeError("The listener must be a function");var e=new qe(p,M||E,h);return E._events.has(d)?E._events.get(d).fn?E._events.set(d,[E._events.get(d),e]):E._events.get(d).push(e):(E._events.set(d,e),E._eventsCount++),E},ce=function(E,d){--E._eventsCount===0?E._events=new Map:E._events.delete(d)},_e=function(){function E(){this._events=new Map,this._eventsCount=0}return Object.defineProperty(E,"VERSION",{get:function(){return Ye.VERSION},enumerable:!1,configurable:!0}),E.prototype.eventNames=function(){return Array.from(this._events.keys())},E.prototype.listeners=function(d){var p=this._events.get(d);if(!p)return[];if(p.fn)return[p.fn];for(var M=0,h=p.length,e=new Array(h);M<h;M++)e[M]=p[M].fn;return e},E.prototype.listenerCount=function(d){var p=this._events.get(d);return p?p.fn?1:p.length:0},E.prototype.emit=function(d){for(var p,M,h=[],e=1;e<arguments.length;e++)h[e-1]=arguments[e];if(!this._events.has(d))return!1;var o=this._events.get(d),i;if(o.fn)return o.once&&this.removeListener(d,o.fn,void 0,!0),(p=o.fn).call.apply(p,Fe([o.context],h)),!0;var a=o.length;for(i=0;i<a;i++)o[i].once&&this.removeListener(d,o[i].fn,void 0,!0),(M=o[i].fn).call.apply(M,Fe([o[i].context],h));return!0},E.prototype.on=function(d,p,M){return He(this,d,p,M,!1)},E.prototype.once=function(d,p,M){return He(this,d,p,M,!0)},E.prototype.removeListener=function(d,p,M,h){if(!this._events.has(d))return this;if(!p)return ce(this,d),this;var e=this._events.get(d);if(e.fn)e.fn===p&&(!h||e.once)&&(!M||e.context===M)&&ce(this,d);else{for(var o=0,i=[],a=e.length;o<a;o++)(e[o].fn!==p||h&&!e[o].once||M&&e[o].context!==M)&&i.push(e[o]);i.length?this._events.set(d,i.length===1?i[0]:i):ce(this,d)}return this},E.prototype.removeAllListeners=function(d){return d?this._events.delete(d)&&ce(this,d):(this._events=new Map,this._eventsCount=0),this},Object.defineProperty(E.prototype,"off",{get:function(){return this.removeListener},enumerable:!1,configurable:!0}),Object.defineProperty(E.prototype,"addListener",{get:function(){return this.on},enumerable:!1,configurable:!0}),E}();Xe=Pe.Events=_e;/**
 * @author       Kevin Lee (https://github.com/InfiniteLee)
 * @copyright    Copyright (c) 2020 Kevin Lee; Project Url: https://github.com/InfiniteLee/three-to-ammo
 * @license      {@link https://github.com/InfiniteLee/three-to-ammo/blob/master/LICENSE|MPL-2.0}
 */const ie={BOX:"box",CYLINDER:"cylinder",SPHERE:"sphere",CAPSULE:"capsule",CONE:"cone",HULL:"hull",HACD:"hacd",VHACD:"vhacd",MESH:"mesh",HEIGHTFIELD:"heightfield"},re={ALL:"all",MANUAL:"manual"},pt=function(){const E=new k,d=new k,p=new q;return function(M,h,e,o={}){if(o.type=ie.HULL,pe(o),o.fit===re.MANUAL)return console.warn("cannot use fit: manual with type: hull"),null;const i=Ce(M,h),a=new Ammo.btVector3,f=new Ammo.btConvexHullShape;f.setMargin(o.margin),d.addVectors(i.max,i.min).multiplyScalar(.5);let l=0;for(let n=0;n<M.length;n++)l+=M[n].length/3;const c=o.hullMaxVertices||1e5;l>c&&console.warn(`too many vertices for hull shape; sampling ~${c} from ~${l} vertices`);const r=Math.min(1,c/l);for(let n=0;n<M.length;n++){const s=M[n];p.fromArray(h[n]);for(let u=0;u<s.length;u+=3){const v=n===M.length-1&&u===s.length-3;(Math.random()<=r||v)&&(E.set(s[u],s[u+1],s[u+2]).applyMatrix4(p).sub(d),a.setValue(E.x,E.y,E.z),f.addPoint(a,v))}}let t=f;if(f.getNumVertices()>=100){const n=new Ammo.btShapeHull(f);n.buildHull(o.margin),Ammo.destroy(f),t=new Ammo.btConvexHullShape(Ammo.getPointer(n.getVertexPointer()),n.numVertices()),Ammo.destroy(n)}return Ammo.destroy(a),ge(t,o,xe(e,o)),t}}(),gt=function(){const E=new k,d=new k,p=new q;return function(M,h,e,o,i={}){if(i.type=ie.HACD,pe(i),i.fit===re.MANUAL)return console.warn("cannot use fit: manual with type: hacd"),[];if(!Ammo.hasOwnProperty("HACD"))return console.warn("HACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const a=Ce(M,h);xe(o,i);let f=0,l=0;d.addVectors(a.max,a.min).multiplyScalar(.5);for(let S=0;S<M.length;S++)f+=M[S].length/3,e&&e[S]?l+=e[S].length/3:l+=M[S].length/9;const c=new Ammo.HACD;i.hasOwnProperty("compacityWeight")&&c.SetCompacityWeight(i.compacityWeight),i.hasOwnProperty("volumeWeight")&&c.SetVolumeWeight(i.volumeWeight),i.hasOwnProperty("nClusters")&&c.SetNClusters(i.nClusters),i.hasOwnProperty("nVerticesPerCH")&&c.SetNVerticesPerCH(i.nVerticesPerCH),i.hasOwnProperty("concavity")&&c.SetConcavity(i.concavity);const r=Ammo._malloc(f*3*8),t=Ammo._malloc(l*3*4);c.SetPoints(r),c.SetTriangles(t),c.SetNPoints(f),c.SetNTriangles(l);let n=r/8,s=t/4;for(let S=0;S<M.length;S++){const w=M[S];p.fromArray(h[S]);for(let P=0;P<w.length;P+=3)E.set(w[P+0],w[P+1],w[P+2]).applyMatrix4(p).sub(d),Ammo.HEAPF64[n+0]=E.x,Ammo.HEAPF64[n+1]=E.y,Ammo.HEAPF64[n+2]=E.z,n+=3;if(e[S]){const P=e[S];for(let m=0;m<P.length;m++)Ammo.HEAP32[s]=P[m],s++}else for(let P=0;P<w.length/3;P++)Ammo.HEAP32[s]=P,s++}c.Compute(),Ammo._free(r),Ammo._free(t);const u=c.GetNClusters(),v=[];for(let S=0;S<u;S++){const w=new Ammo.btConvexHullShape;w.setMargin(i.margin);const P=c.GetNPointsCH(S),m=c.GetNTrianglesCH(S),g=Ammo._malloc(P*3*8),y=Ammo._malloc(m*3*4);c.GetCH(S,g,y);const x=g/8;for(let A=0;A<P;A++){const C=new Ammo.btVector3,V=Ammo.HEAPF64[x+A*3+0],T=Ammo.HEAPF64[x+A*3+1],I=Ammo.HEAPF64[x+A*3+2];C.setValue(V,T,I),w.addPoint(C,A===P-1),Ammo.destroy(C)}ge(),v.push(w)}return v}}(),xt=function(){const E=new k,d=new k,p=new q;return function(M,h,e,o,i={}){if(i.type=ie.VHACD,pe(i),i.fit===re.MANUAL)return console.warn("cannot use fit: manual with type: vhacd"),[];if(!Ammo.hasOwnProperty("VHACD"))return console.warn("VHACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const a=Ce(M,h);xe(o,i);let f=0,l=0;d.addVectors(a.max,a.min).multiplyScalar(.5);for(let P=0;P<M.length;P++)f+=M[P].length/3,e&&e[P]?l+=e[P].length/3:l+=M[P].length/9;const c=new Ammo.VHACD,r=new Ammo.Parameters;i.hasOwnProperty("resolution")&&r.set_m_resolution(i.resolution),i.hasOwnProperty("depth")&&r.set_m_depth(i.depth),i.hasOwnProperty("concavity")&&r.set_m_concavity(i.concavity),i.hasOwnProperty("planeDownsampling")&&r.set_m_planeDownsampling(i.planeDownsampling),i.hasOwnProperty("convexhullDownsampling")&&r.set_m_convexhullDownsampling(i.convexhullDownsampling),i.hasOwnProperty("alpha")&&r.set_m_alpha(i.alpha),i.hasOwnProperty("beta")&&r.set_m_beta(i.beta),i.hasOwnProperty("gamma")&&r.set_m_gamma(i.gamma),i.hasOwnProperty("pca")&&r.set_m_pca(i.pca),i.hasOwnProperty("mode")&&r.set_m_mode(i.mode),i.hasOwnProperty("maxNumVerticesPerCH")&&r.set_m_maxNumVerticesPerCH(i.maxNumVerticesPerCH),i.hasOwnProperty("minVolumePerCH")&&r.set_m_minVolumePerCH(i.minVolumePerCH),i.hasOwnProperty("convexhullApproximation")&&r.set_m_convexhullApproximation(i.convexhullApproximation),i.hasOwnProperty("oclAcceleration")&&r.set_m_oclAcceleration(i.oclAcceleration);const t=Ammo._malloc(f*3*8+3),n=Ammo._malloc(l*3*4);let s=t/8,u=n/4;for(let P=0;P<M.length;P++){const m=M[P];p.fromArray(h[P]);for(let g=0;g<m.length;g+=3)E.set(m[g+0],m[g+1],m[g+2]).applyMatrix4(p).sub(d),Ammo.HEAPF64[s+0]=E.x,Ammo.HEAPF64[s+1]=E.y,Ammo.HEAPF64[s+2]=E.z,s+=3;if(e[P]){const g=e[P];for(let y=0;y<g.length;y++)Ammo.HEAP32[u]=g[y],u++}else for(let g=0;g<m.length/3;g++)Ammo.HEAP32[u]=g,u++}c.Compute(t,3,f,n,3,l,r),Ammo._free(t),Ammo._free(n);const v=c.GetNConvexHulls(),S=[],w=new Ammo.ConvexHull;for(let P=0;P<v;P++){c.GetConvexHull(P,w);const m=w.get_m_nPoints();w.get_m_points();const g=new Ammo.btConvexHullShape;g.setMargin(i.margin);for(let y=0;y<m;y++){const x=new Ammo.btVector3,A=w.get_m_points(y*3+0),C=w.get_m_points(y*3+1),V=w.get_m_points(y*3+2);x.setValue(A,C,V),g.addPoint(x,y===m-1),Ammo.destroy(x)}ge(),S.push(g)}return Ammo.destroy(w),Ammo.destroy(c),S}}(),dt=function(){const E=new k,d=new k,p=new k,M=new q;return function(h,e,o,i,a={}){if(a.type=ie.MESH,pe(a),a.fit===re.MANUAL)return console.warn("cannot use fit: manual with type: mesh"),null;const f=xe(i,a),l=new Ammo.btVector3,c=new Ammo.btVector3,r=new Ammo.btVector3,t=new Ammo.btTriangleMesh(!0,!1);for(let u=0;u<h.length;u++){const v=h[u],S=o[u]?o[u]:null;if(M.fromArray(e[u]),S)for(let w=0;w<S.length;w+=3){const P=S[w]*3,m=S[w+1]*3,g=S[w+2]*3;E.set(v[P],v[P+1],v[P+2]).applyMatrix4(M),d.set(v[m],v[m+1],v[m+2]).applyMatrix4(M),p.set(v[g],v[g+1],v[g+2]).applyMatrix4(M),l.setValue(E.x,E.y,E.z),c.setValue(d.x,d.y,d.z),r.setValue(p.x,p.y,p.z),t.addTriangle(l,c,r,!1)}else for(let w=0;w<v.length;w+=9)E.set(v[w+0],v[w+1],v[w+2]).applyMatrix4(M),d.set(v[w+3],v[w+4],v[w+5]).applyMatrix4(M),p.set(v[w+6],v[w+7],v[w+8]).applyMatrix4(M),l.setValue(E.x,E.y,E.z),c.setValue(d.x,d.y,d.z),r.setValue(p.x,p.y,p.z),t.addTriangle(l,c,r,!1)}const n=new Ammo.btVector3(f.x,f.y,f.z);t.setScaling(n),Ammo.destroy(n);let s;return a.concave?s=new Ammo.btBvhTriangleMeshShape(t,!0,!0):s=new Ammo.btConvexTriangleMeshShape(t,!0),s.resources=[t],Ammo.destroy(l),Ammo.destroy(c),Ammo.destroy(r),ge(),s}}();function pe(E){E.type=E.type||ie.HULL,E.margin=E.hasOwnProperty("margin")?E.margin:.01}const ge=function(E,d,p){},yt=function(){const E=new q;return function(d,p,M){parseInt($e)>=123?E.copy(d.matrixWorld).invert():E.getInverse(d.matrixWorld),new k().setFromMatrixScale(d.matrixWorld),d.traverse(e=>{const o=new q;e.isMesh&&(p.includeInvisible||e.el&&e.el.object3D.visible||e.visible)&&(e===d?o.identity():(e.updateWorldMatrix(!0),o.multiplyMatrices(E,e.matrixWorld)),M(e.geometry.isBufferGeometry?e.geometry.attributes.position.array:e.geometry.vertices,o.elements,e.geometry.index?e.geometry.index.array:null))})}}(),xe=function(){const E=new q;return function(d,p={}){const M=new k(1,1,1);return p.fit===re.ALL&&(E.fromArray(d),M.setFromMatrixScale(E)),M}}();(function(){const E=new k;return function(d,p,M){let h=0,{x:e,y:o,z:i}=M.getCenter(E);return ze(d,p,a=>{const f=e-a.x,l=o-a.y,c=i-a.z;h=Math.max(h,f*f+l*l+c*c)}),Math.sqrt(h)}})();const Ce=function(E,d){const p=new je;let M=1/0,h=1/0,e=1/0,o=-1/0,i=-1/0,a=-1/0;return p.min.set(0,0,0),p.max.set(0,0,0),ze(E,d,f=>{f.x<M&&(M=f.x),f.y<h&&(h=f.y),f.z<e&&(e=f.z),f.x>o&&(o=f.x),f.y>i&&(i=f.y),f.z>a&&(a=f.z)}),p.min.set(M,h,e),p.max.set(o,i,a),p},ze=function(){const E=new k,d=new q;return function(p,M,h){for(let e=0;e<p.length;e++){d.fromArray(M[e]);for(let o=0;o<p[e].length;o+=3)E.set(p[e][o],p[e][o+1],p[e][o+2]).applyMatrix4(d),h(E)}}}(),me=0,et=1,tt=new k,Be=new We,ye=new he,Le=new k,ue=new Qe;class nt{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new De,this.unassigned=new De,this.vertices=[]}setFromPoints(d){if(d.length>=4){this.makeEmpty();for(let p=0,M=d.length;p<M;p++)this.vertices.push(new it(d[p]));this.compute()}return this}setFromObject(d){const p=[];return d.updateMatrixWorld(!0),d.traverse(function(M){const h=M.geometry;if(h!==void 0){const e=h.attributes.position;if(e!==void 0)for(let o=0,i=e.count;o<i;o++){const a=new k;a.fromBufferAttribute(e,o).applyMatrix4(M.matrixWorld),p.push(a)}}}),this.setFromPoints(p)}containsPoint(d){const p=this.faces;for(let M=0,h=p.length;M<h;M++)if(p[M].distanceToPoint(d)>this.tolerance)return!1;return!0}intersectRay(d,p){const M=this.faces;let h=-1/0,e=1/0;for(let o=0,i=M.length;o<i;o++){const a=M[o],f=a.distanceToPoint(d.origin),l=a.normal.dot(d.direction);if(f>0&&l>=0)return null;const c=l!==0?-f/l:0;if(!(c<=0)&&(l>0?e=Math.min(c,e):h=Math.max(c,h),h>e))return null}return h!==-1/0?d.at(h,p):d.at(e,p),p}intersectsRay(d){return this.intersectRay(d,tt)!==null}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(d,p){return d.face=p,p.outside===null?this.assigned.append(d):this.assigned.insertBefore(p.outside,d),p.outside=d,this}removeVertexFromFace(d,p){return d===p.outside&&(d.next!==null&&d.next.face===p?p.outside=d.next:p.outside=null),this.assigned.remove(d),this}removeAllVerticesFromFace(d){if(d.outside!==null){const p=d.outside;let M=d.outside;for(;M.next!==null&&M.next.face===d;)M=M.next;return this.assigned.removeSubList(p,M),p.prev=M.next=null,d.outside=null,p}}deleteFaceVertices(d,p){const M=this.removeAllVerticesFromFace(d);if(M!==void 0)if(p===void 0)this.unassigned.appendChain(M);else{let h=M;do{const e=h.next;p.distanceToPoint(h.point)>this.tolerance?this.addVertexToFace(h,p):this.unassigned.append(h),h=e}while(h!==null)}return this}resolveUnassignedPoints(d){if(this.unassigned.isEmpty()===!1){let p=this.unassigned.first();do{const M=p.next;let h=this.tolerance,e=null;for(let o=0;o<d.length;o++){const i=d[o];if(i.mark===me){const a=i.distanceToPoint(p.point);if(a>h&&(h=a,e=i),h>1e3*this.tolerance)break}}e!==null&&this.addVertexToFace(p,e),p=M}while(p!==null)}return this}computeExtremes(){const d=new k,p=new k,M=[],h=[];for(let e=0;e<3;e++)M[e]=h[e]=this.vertices[0];d.copy(this.vertices[0].point),p.copy(this.vertices[0].point);for(let e=0,o=this.vertices.length;e<o;e++){const i=this.vertices[e],a=i.point;for(let f=0;f<3;f++)a.getComponent(f)<d.getComponent(f)&&(d.setComponent(f,a.getComponent(f)),M[f]=i);for(let f=0;f<3;f++)a.getComponent(f)>p.getComponent(f)&&(p.setComponent(f,a.getComponent(f)),h[f]=i)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(d.x),Math.abs(p.x))+Math.max(Math.abs(d.y),Math.abs(p.y))+Math.max(Math.abs(d.z),Math.abs(p.z))),{min:M,max:h}}computeInitialHull(){const d=this.vertices,p=this.computeExtremes(),M=p.min,h=p.max;let e=0,o=0;for(let r=0;r<3;r++){const t=h[r].point.getComponent(r)-M[r].point.getComponent(r);t>e&&(e=t,o=r)}const i=M[o],a=h[o];let f,l;e=0,Be.set(i.point,a.point);for(let r=0,t=this.vertices.length;r<t;r++){const n=d[r];if(n!==i&&n!==a){Be.closestPointToPoint(n.point,!0,Le);const s=Le.distanceToSquared(n.point);s>e&&(e=s,f=n)}}e=-1,ye.setFromCoplanarPoints(i.point,a.point,f.point);for(let r=0,t=this.vertices.length;r<t;r++){const n=d[r];if(n!==i&&n!==a&&n!==f){const s=Math.abs(ye.distanceToPoint(n.point));s>e&&(e=s,l=n)}}const c=[];if(ye.distanceToPoint(l.point)<0){c.push(Q.create(i,a,f),Q.create(l,a,i),Q.create(l,f,a),Q.create(l,i,f));for(let r=0;r<3;r++){const t=(r+1)%3;c[r+1].getEdge(2).setTwin(c[0].getEdge(t)),c[r+1].getEdge(1).setTwin(c[t+1].getEdge(0))}}else{c.push(Q.create(i,f,a),Q.create(l,i,a),Q.create(l,a,f),Q.create(l,f,i));for(let r=0;r<3;r++){const t=(r+1)%3;c[r+1].getEdge(2).setTwin(c[0].getEdge((3-r)%3)),c[r+1].getEdge(0).setTwin(c[t+1].getEdge(1))}}for(let r=0;r<4;r++)this.faces.push(c[r]);for(let r=0,t=d.length;r<t;r++){const n=d[r];if(n!==i&&n!==a&&n!==f&&n!==l){e=this.tolerance;let s=null;for(let u=0;u<4;u++){const v=this.faces[u].distanceToPoint(n.point);v>e&&(e=v,s=this.faces[u])}s!==null&&this.addVertexToFace(n,s)}}return this}reindexFaces(){const d=[];for(let p=0;p<this.faces.length;p++){const M=this.faces[p];M.mark===me&&d.push(M)}return this.faces=d,this}nextVertexToAdd(){if(this.assigned.isEmpty()===!1){let d,p=0;const M=this.assigned.first().face;let h=M.outside;do{const e=M.distanceToPoint(h.point);e>p&&(p=e,d=h),h=h.next}while(h!==null&&h.face===M);return d}}computeHorizon(d,p,M,h){this.deleteFaceVertices(M),M.mark=et;let e;p===null?e=p=M.getEdge(0):e=p.next;do{const o=e.twin,i=o.face;i.mark===me&&(i.distanceToPoint(d)>this.tolerance?this.computeHorizon(d,o,i,h):h.push(e)),e=e.next}while(e!==p);return this}addAdjoiningFace(d,p){const M=Q.create(d,p.tail(),p.head());return this.faces.push(M),M.getEdge(-1).setTwin(p.twin),M.getEdge(0)}addNewFaces(d,p){this.newFaces=[];let M=null,h=null;for(let e=0;e<p.length;e++){const o=p[e],i=this.addAdjoiningFace(d,o);M===null?M=i:i.next.setTwin(h),this.newFaces.push(i.face),h=i}return M.next.setTwin(h),this}addVertexToHull(d){const p=[];return this.unassigned.clear(),this.removeVertexFromFace(d,d.face),this.computeHorizon(d.point,null,d.face,p),this.addNewFaces(d,p),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let d;for(this.computeInitialHull();(d=this.nextVertexToAdd())!==void 0;)this.addVertexToHull(d);return this.reindexFaces(),this.cleanup(),this}}class Q{constructor(){this.normal=new k,this.midpoint=new k,this.area=0,this.constant=0,this.outside=null,this.mark=me,this.edge=null}static create(d,p,M){const h=new Q,e=new Se(d,h),o=new Se(p,h),i=new Se(M,h);return e.next=i.prev=o,o.next=e.prev=i,i.next=o.prev=e,h.edge=e,h.compute()}getEdge(d){let p=this.edge;for(;d>0;)p=p.next,d--;for(;d<0;)p=p.prev,d++;return p}compute(){const d=this.edge.tail(),p=this.edge.head(),M=this.edge.next.head();return ue.set(d.point,p.point,M.point),ue.getNormal(this.normal),ue.getMidpoint(this.midpoint),this.area=ue.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(d){return this.normal.dot(d)-this.constant}}class Se{constructor(d,p){this.vertex=d,this.prev=null,this.next=null,this.twin=null,this.face=p}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const d=this.head(),p=this.tail();return p!==null?p.point.distanceTo(d.point):-1}lengthSquared(){const d=this.head(),p=this.tail();return p!==null?p.point.distanceToSquared(d.point):-1}setTwin(d){return this.twin=d,d.twin=this,this}}class it{constructor(d){this.point=d,this.prev=null,this.next=null,this.face=null}}class De{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(d,p){return p.prev=d.prev,p.next=d,p.prev===null?this.head=p:p.prev.next=p,d.prev=p,this}insertAfter(d,p){return p.prev=d,p.next=d.next,p.next===null?this.tail=p:p.next.prev=p,d.next=p,this}append(d){return this.head===null?this.head=d:this.tail.next=d,d.prev=this.tail,d.next=null,this.tail=d,this}appendChain(d){for(this.head===null?this.head=d:this.tail.next=d,d.prev=this.tail;d.next!==null;)d=d.next;return this.tail=d,this}remove(d){return d.prev===null?this.head=d.next:d.prev.next=d.next,d.next===null?this.tail=d.prev:d.next.prev=d.prev,this}removeSubList(d,p){return d.prev===null?this.head=p.next:d.prev.next=p.next,p.next===null?this.tail=d.prev:p.next.prev=d.prev,this}isEmpty(){return this.head===null}}class rt extends Ze{constructor(d=[]){super();const p=[],M=[],e=new nt().setFromPoints(d).faces;for(let o=0;o<e.length;o++){const i=e[o];let a=i.edge;do{const f=a.head().point;p.push(f.x,f.y,f.z),M.push(i.normal.x,i.normal.y,i.normal.z),a=a.next}while(a!==i.edge)}this.setAttribute("position",new Ie(p,3)),this.setAttribute("normal",new Ie(M,3))}}const Oe=E=>{const d=window.THREE&&window.THREE.ConvexGeometry?window.THREE.ConvexGeometry:rt;return new d(E)},K=function(E,d){this.minSizeForBreak=E||1.4,this.smallDelta=d||1e-4,this.tempLine1=new We,this.tempPlane1=new he,this.tempPlane2=new he,this.tempPlane_Cut=new he,this.tempCM1=new k,this.tempCM2=new k,this.tempVector3=new k,this.tempVector3_2=new k,this.tempVector3_3=new k,this.tempVector3_P0=new k,this.tempVector3_P1=new k,this.tempVector3_P2=new k,this.tempVector3_N0=new k,this.tempVector3_N1=new k,this.tempVector3_AB=new k,this.tempVector3_CB=new k,this.tempResultObjects={object1:null,object2:null},this.segments=[];for(var p=30*30,M=0;M<p;M++)this.segments[M]=!1};K.prototype={constructor:K,prepareBreakableObject:function(E,d,p,M,h){E.geometry.isBufferGeometry||console.error("THREE.ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry."),E.userData.ammoPhysicsData={};var e=E.userData.ammoPhysicsData;e.mass=d,e.velocity=p.clone(),e.angularVelocity=M.clone(),e.breakable=h},subdivideByImpact:function(E,d,p,M,h){var e=[],o=this.tempPlane1,i=this.tempPlane2;this.tempVector3.addVectors(d,p),o.setFromCoplanarPoints(d,E.position,this.tempVector3);var a=h+M,f=this;function l(c,r,t,n){if(Math.random()<n*.05||n>a){e.push(c);return}var s=Math.PI;n===0?(i.normal.copy(o.normal),i.constant=o.constant):n<=M?(s=(t-r)*(.2+.6*Math.random())+r,f.tempVector3_2.copy(E.position).sub(d).applyAxisAngle(p,s).add(d),i.setFromCoplanarPoints(d,f.tempVector3,f.tempVector3_2)):(s=(.5*(n&1)+.2*(2-Math.random()))*Math.PI,f.tempVector3_2.copy(d).sub(c.position).applyAxisAngle(p,s).add(c.position),f.tempVector3_3.copy(p).add(c.position),i.setFromCoplanarPoints(c.position,f.tempVector3_3,f.tempVector3_2)),f.cutByPlane(c,i,f.tempResultObjects);var u=f.tempResultObjects.object1,v=f.tempResultObjects.object2;u&&l(u,r,s,n+1),v&&l(v,s,t,n+1)}return l(E,0,2*Math.PI,0),e},cutByPlane:function(E,d,p){var M=E.geometry,h=M.attributes.position.array,e=M.attributes.normal.array,o=h.length/3,i=o/3,a=M.getIndex();a&&(a=a.array,i=a.length/3);function f(Y,se){var _=Y*3+se;return a?a[_]:_}for(var l=[],c=[],r=this.smallDelta,t=o*o,n=0;n<t;n++)this.segments[n]=!1;for(var s=this.tempVector3_P0,u=this.tempVector3_P1,v=this.tempVector3_N0,S=this.tempVector3_N1,n=0;n<i-1;n++){var w=f(n,0),P=f(n,1),m=f(n,2);v.set(e[w],e[w]+1,e[w]+2);for(var g=n+1;g<i;g++){var y=f(g,0),x=f(g,1),A=f(g,2);S.set(e[y],e[y]+1,e[y]+2);var C=1-v.dot(S)<r;C&&(w===y||w===x||w===A?P===y||P===x||P===A?(this.segments[w*o+P]=!0,this.segments[P*o+w]=!0):(this.segments[m*o+w]=!0,this.segments[w*o+m]=!0):(P===y||P===x||P===A)&&(this.segments[m*o+P]=!0,this.segments[P*o+m]=!0))}}var V=this.tempPlane_Cut;E.updateMatrix(),K.transformPlaneToLocalSpace(d,E.matrix,V);for(var n=0;n<i;n++)for(var T=f(n,0),I=f(n,1),F=f(n,2),R=0;R<3;R++){var B=R===0?T:R===1?I:F,H=R===0?I:R===1?F:T,L=this.segments[B*o+H];if(!L){this.segments[B*o+H]=!0,this.segments[H*o+B]=!0,s.set(h[3*B],h[3*B+1],h[3*B+2]),u.set(h[3*H],h[3*H+1],h[3*H+2]);var O=0,N=V.distanceToPoint(s);N>r?(O=2,c.push(s.clone())):N<-r?(O=1,l.push(s.clone())):(O=3,l.push(s.clone()),c.push(s.clone()));var W=0,N=V.distanceToPoint(u);if(N>r?(W=2,c.push(u.clone())):N<-r?(W=1,l.push(u.clone())):(W=3,l.push(u.clone()),c.push(u.clone())),O===1&&W===2||O===2&&W===1){this.tempLine1.start.copy(s),this.tempLine1.end.copy(u);var D=new k;if(D=V.intersectLine(this.tempLine1,D),D===void 0)return console.error("Internal error: segment does not intersect plane."),p.segmentedObject1=null,p.segmentedObject2=null,0;l.push(D),c.push(D.clone())}}}var G=E.userData.ammoPhysicsData.mass*.5;this.tempCM1.set(0,0,0);var b=0,$=l.length;if($>0){for(var n=0;n<$;n++)this.tempCM1.add(l[n]);this.tempCM1.divideScalar($);for(var n=0;n<$;n++){var z=l[n];z.sub(this.tempCM1),b=Math.max(b,z.x,z.y,z.z)}this.tempCM1.add(E.position)}this.tempCM2.set(0,0,0);var j=0,U=c.length;if(U>0){for(var n=0;n<U;n++)this.tempCM2.add(c[n]);this.tempCM2.divideScalar(U);for(var n=0;n<U;n++){var z=c[n];z.sub(this.tempCM2),j=Math.max(j,z.x,z.y,z.z)}this.tempCM2.add(E.position)}var J=null,X=null,ee=0;if($>4)try{J=new Re(Oe(l),E.material),J.position.copy(this.tempCM1),J.quaternion.copy(E.quaternion),J.userData=E.userData,this.prepareBreakableObject(J,G,E.userData.ammoPhysicsData.velocity,E.userData.ammoPhysicsData.angularVelocity,2*b>this.minSizeForBreak),ee++}catch(Y){te("Error in ConvexObjectBreaker.ts",!0),te(Y,!0)}if(U>4)try{X=new Re(Oe(c),E.material),X.position.copy(this.tempCM2),X.quaternion.copy(E.quaternion),X.userData=E.userData,this.prepareBreakableObject(X,G,E.userData.ammoPhysicsData.velocity,E.userData.ammoPhysicsData.angularVelocity,2*j>this.minSizeForBreak),ee++}catch(Y){te("Error in ConvexObjectBreaker.ts",!0),te(Y,!0)}return p.object1=J,p.object2=X,ee}};K.transformFreeVector=function(E,d){var p=E.x,M=E.y,h=E.z,e=d.elements;return E.x=e[0]*p+e[4]*M+e[8]*h,E.y=e[1]*p+e[5]*M+e[9]*h,E.z=e[2]*p+e[6]*M+e[10]*h,E};K.transformFreeVectorInverse=function(E,d){var p=E.x,M=E.y,h=E.z,e=d.elements;return E.x=e[0]*p+e[1]*M+e[2]*h,E.y=e[4]*p+e[5]*M+e[6]*h,E.z=e[8]*p+e[9]*M+e[10]*h,E};K.transformTiedVectorInverse=function(E,d){var p=E.x,M=E.y,h=E.z,e=d.elements;return E.x=e[0]*p+e[1]*M+e[2]*h-e[12],E.y=e[4]*p+e[5]*M+e[6]*h-e[13],E.z=e[8]*p+e[9]*M+e[10]*h-e[14],E};K.transformPlaneToLocalSpace=function(){var E=new k;return function(p,M,h){h.normal.copy(p.normal),h.constant=p.constant;var e=K.transformTiedVectorInverse(p.coplanarPoint(E),M);K.transformFreeVectorInverse(h.normal,M),h.constant=-e.dot(h.normal)}}();const st=(()=>{try{if(typeof WebAssembly=="object"&&typeof WebAssembly.instantiate=="function"){const E=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(E instanceof WebAssembly.Module)return new WebAssembly.Instance(E)instanceof WebAssembly.Instance}}catch(E){E instanceof Error&&console.error(E.message)}return!1})(),ke=(E,d)=>{var p=document.createElement("script");p.onload=()=>{d()},p.onerror=()=>{throw new Error(`failed to load ${E}`)},p.async=!0,p.src=E,document.head.appendChild(p)},St=(E,d)=>{st?ke(`${E}/ammo.wasm.js`,()=>d()):ke(`${E}/ammo.js`,()=>d())};function be(E,d){d.forEach(p=>{Object.getOwnPropertyNames(p.prototype).forEach(M=>{Object.defineProperty(E.prototype,M,Object.getOwnPropertyDescriptor(p.prototype,M)||Object.create(null))})})}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|LGPL-3.0}
 */class at{constructor(d){this.physics=d}getHitPointWorld(){const d=this._btRayCallback.get_m_hitPointWorld();return{x:d.x(),y:d.y(),z:d.z()}}getHitNormalWorld(){const d=this._btRayCallback.get_m_hitNormalWorld();return{x:d.x(),y:d.y(),z:d.z()}}getCollisionObject(){return Ammo.castObject(this._btRayCallback.get_m_collisionObject(),Ammo.btRigidBody).threeObject}}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|LGPL-3.0}
 */class ot{constructor(d){this.physics=d}getHitPointsWorld(){const d=this._btRayCallback.get_m_hitPointWorld(),p=[];for(let M=d.size()-1;M>=0;M--){const h=d.at(M);p.push({x:h.x(),y:h.y(),z:h.z()})}return p}getHitPointWorld(){return te("Use getHitPointsWorld() instead of getHitPointWorld() for the AllHitsRayCaster!"),this.getHitPointsWorld()}getHitNormalsWorld(){const d=this._btRayCallback.get_m_hitNormalWorld(),p=[];for(let M=d.size()-1;M>=0;M--){const h=d.at(M);p.push({x:h.x(),y:h.y(),z:h.z()})}return p}getCollisionObjects(){const d=[],p=this._btRayCallback.get_m_collisionObjects();for(let M=p.size()-1;M>=0;M--){const h=Ammo.castObject(p.at(M),Ammo.btRigidBody);d.push(h.threeObject)}return d}}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|LGPL-3.0}
 */class Ne{constructor(d){this.physics=d}setRayFromWorld(d=0,p=0,M=0){this._btRayFrom.setValue(d,p,M)}setRayToWorld(d=0,p=0,M=0){this._btRayTo.setValue(d,p,M)}hasHit(){return this._btRayCallback.hasHit()}rayTest(){typeof this._btRayCallback<"u"&&Ammo.destroy(this._btRayCallback),this._btRayCallback=this.type==="closest"?new Ammo.ClosestRayResultCallback(this._btRayFrom,this._btRayTo):new Ammo.AllHitsRayResultCallback(this._btRayFrom,this._btRayTo),this.physics.physicsWorld.rayTest(this._btRayFrom,this._btRayTo,this._btRayCallback)}destroy(){typeof this._btRayFrom<"u"&&Ammo.destroy(this._btRayFrom),typeof this._btRayTo<"u"&&Ammo.destroy(this._btRayTo),typeof this._btRayCallback<"u"&&Ammo.destroy(this._btRayCallback)}}class lt{constructor(d){this.physics=d,this.type="closest",this._btRayFrom=new Ammo.btVector3(0,0,0),this._btRayTo=new Ammo.btVector3(0,0,0)}}class ft{constructor(d){this.physics=d,this.type="allHits",this._btRayFrom=new Ammo.btVector3(0,0,0),this._btRayTo=new Ammo.btVector3(0,0,0)}}be(lt,[Ne,at]);be(ft,[Ne,ot]);const ct="0.25.4",ut=`Powered by enable3d v${ct}`;console.log(`%c %c %c %c %c ${ut} %c https://enable3d.io/`,"background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none");/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|LGPL-3.0}
 */document.createElement("canvas");new Ke;new we;new we;new we;var ht={exports:{}};/*!
 * matter-js 0.19.0 by @liabru
 * http://brm.io/matter-js/
 * License MIT
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) Liam Brummitt and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(E,d){(function(M,h){E.exports=h()})(ne,function(){return function(p){var M={};function h(e){if(M[e])return M[e].exports;var o=M[e]={i:e,l:!1,exports:{}};return p[e].call(o.exports,o,o.exports,h),o.l=!0,o.exports}return h.m=p,h.c=M,h.d=function(e,o,i){h.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:i})},h.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},h.t=function(e,o){if(o&1&&(e=h(e)),o&8||o&4&&typeof e=="object"&&e&&e.__esModule)return e;var i=Object.create(null);if(h.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),o&2&&typeof e!="string")for(var a in e)h.d(i,a,(function(f){return e[f]}).bind(null,a));return i},h.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return h.d(o,"a",o),o},h.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},h.p="",h(h.s=20)}([function(p,M){var h={};p.exports=h,function(){h._baseDelta=1e3/60,h._nextId=0,h._seed=0,h._nowStartTime=+new Date,h._warnedOnce={},h._decomp=null,h.extend=function(o,i){var a,f;typeof i=="boolean"?(a=2,f=i):(a=1,f=!0);for(var l=a;l<arguments.length;l++){var c=arguments[l];if(c)for(var r in c)f&&c[r]&&c[r].constructor===Object&&(!o[r]||o[r].constructor===Object)?(o[r]=o[r]||{},h.extend(o[r],f,c[r])):o[r]=c[r]}return o},h.clone=function(o,i){return h.extend({},i,o)},h.keys=function(o){if(Object.keys)return Object.keys(o);var i=[];for(var a in o)i.push(a);return i},h.values=function(o){var i=[];if(Object.keys){for(var a=Object.keys(o),f=0;f<a.length;f++)i.push(o[a[f]]);return i}for(var l in o)i.push(o[l]);return i},h.get=function(o,i,a,f){i=i.split(".").slice(a,f);for(var l=0;l<i.length;l+=1)o=o[i[l]];return o},h.set=function(o,i,a,f,l){var c=i.split(".").slice(f,l);return h.get(o,i,0,-1)[c[c.length-1]]=a,a},h.shuffle=function(o){for(var i=o.length-1;i>0;i--){var a=Math.floor(h.random()*(i+1)),f=o[i];o[i]=o[a],o[a]=f}return o},h.choose=function(o){return o[Math.floor(h.random()*o.length)]},h.isElement=function(o){return typeof HTMLElement<"u"?o instanceof HTMLElement:!!(o&&o.nodeType&&o.nodeName)},h.isArray=function(o){return Object.prototype.toString.call(o)==="[object Array]"},h.isFunction=function(o){return typeof o=="function"},h.isPlainObject=function(o){return typeof o=="object"&&o.constructor===Object},h.isString=function(o){return toString.call(o)==="[object String]"},h.clamp=function(o,i,a){return o<i?i:o>a?a:o},h.sign=function(o){return o<0?-1:1},h.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-h._nowStartTime},h.random=function(o,i){return o=typeof o<"u"?o:0,i=typeof i<"u"?i:1,o+e()*(i-o)};var e=function(){return h._seed=(h._seed*9301+49297)%233280,h._seed/233280};h.colorToNumber=function(o){return o=o.replace("#",""),o.length==3&&(o=o.charAt(0)+o.charAt(0)+o.charAt(1)+o.charAt(1)+o.charAt(2)+o.charAt(2)),parseInt(o,16)},h.logLevel=1,h.log=function(){console&&h.logLevel>0&&h.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},h.info=function(){console&&h.logLevel>0&&h.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},h.warn=function(){console&&h.logLevel>0&&h.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},h.warnOnce=function(){var o=Array.prototype.slice.call(arguments).join(" ");h._warnedOnce[o]||(h.warn(o),h._warnedOnce[o]=!0)},h.deprecated=function(o,i,a){o[i]=h.chain(function(){h.warnOnce("ðŸ”… deprecated ðŸ”…",a)},o[i])},h.nextId=function(){return h._nextId++},h.indexOf=function(o,i){if(o.indexOf)return o.indexOf(i);for(var a=0;a<o.length;a++)if(o[a]===i)return a;return-1},h.map=function(o,i){if(o.map)return o.map(i);for(var a=[],f=0;f<o.length;f+=1)a.push(i(o[f]));return a},h.topologicalSort=function(o){var i=[],a=[],f=[];for(var l in o)!a[l]&&!f[l]&&h._topologicalSort(l,a,f,o,i);return i},h._topologicalSort=function(o,i,a,f,l){var c=f[o]||[];a[o]=!0;for(var r=0;r<c.length;r+=1){var t=c[r];a[t]||i[t]||h._topologicalSort(t,i,a,f,l)}a[o]=!1,i[o]=!0,l.push(o)},h.chain=function(){for(var o=[],i=0;i<arguments.length;i+=1){var a=arguments[i];a._chained?o.push.apply(o,a._chained):o.push(a)}var f=function(){for(var l,c=new Array(arguments.length),r=0,t=arguments.length;r<t;r++)c[r]=arguments[r];for(r=0;r<o.length;r+=1){var n=o[r].apply(l,c);typeof n<"u"&&(l=n)}return l};return f._chained=o,f},h.chainPathBefore=function(o,i,a){return h.set(o,i,h.chain(a,h.get(o,i)))},h.chainPathAfter=function(o,i,a){return h.set(o,i,h.chain(h.get(o,i),a))},h.setDecomp=function(o){h._decomp=o},h.getDecomp=function(){var o=h._decomp;try{!o&&typeof window<"u"&&(o=window.decomp),!o&&typeof ne<"u"&&(o=ne.decomp)}catch{o=null}return o}}()},function(p,M){var h={};p.exports=h,function(){h.create=function(e){var o={min:{x:0,y:0},max:{x:0,y:0}};return e&&h.update(o,e),o},h.update=function(e,o,i){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var a=0;a<o.length;a++){var f=o[a];f.x>e.max.x&&(e.max.x=f.x),f.x<e.min.x&&(e.min.x=f.x),f.y>e.max.y&&(e.max.y=f.y),f.y<e.min.y&&(e.min.y=f.y)}i&&(i.x>0?e.max.x+=i.x:e.min.x+=i.x,i.y>0?e.max.y+=i.y:e.min.y+=i.y)},h.contains=function(e,o){return o.x>=e.min.x&&o.x<=e.max.x&&o.y>=e.min.y&&o.y<=e.max.y},h.overlaps=function(e,o){return e.min.x<=o.max.x&&e.max.x>=o.min.x&&e.max.y>=o.min.y&&e.min.y<=o.max.y},h.translate=function(e,o){e.min.x+=o.x,e.max.x+=o.x,e.min.y+=o.y,e.max.y+=o.y},h.shift=function(e,o){var i=e.max.x-e.min.x,a=e.max.y-e.min.y;e.min.x=o.x,e.max.x=o.x+i,e.min.y=o.y,e.max.y=o.y+a}}()},function(p,M){var h={};p.exports=h,function(){h.create=function(e,o){return{x:e||0,y:o||0}},h.clone=function(e){return{x:e.x,y:e.y}},h.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},h.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},h.rotate=function(e,o,i){var a=Math.cos(o),f=Math.sin(o);i||(i={});var l=e.x*a-e.y*f;return i.y=e.x*f+e.y*a,i.x=l,i},h.rotateAbout=function(e,o,i,a){var f=Math.cos(o),l=Math.sin(o);a||(a={});var c=i.x+((e.x-i.x)*f-(e.y-i.y)*l);return a.y=i.y+((e.x-i.x)*l+(e.y-i.y)*f),a.x=c,a},h.normalise=function(e){var o=h.magnitude(e);return o===0?{x:0,y:0}:{x:e.x/o,y:e.y/o}},h.dot=function(e,o){return e.x*o.x+e.y*o.y},h.cross=function(e,o){return e.x*o.y-e.y*o.x},h.cross3=function(e,o,i){return(o.x-e.x)*(i.y-e.y)-(o.y-e.y)*(i.x-e.x)},h.add=function(e,o,i){return i||(i={}),i.x=e.x+o.x,i.y=e.y+o.y,i},h.sub=function(e,o,i){return i||(i={}),i.x=e.x-o.x,i.y=e.y-o.y,i},h.mult=function(e,o){return{x:e.x*o,y:e.y*o}},h.div=function(e,o){return{x:e.x/o,y:e.y/o}},h.perp=function(e,o){return o=o===!0?-1:1,{x:o*-e.y,y:o*e.x}},h.neg=function(e){return{x:-e.x,y:-e.y}},h.angle=function(e,o){return Math.atan2(o.y-e.y,o.x-e.x)},h._temp=[h.create(),h.create(),h.create(),h.create(),h.create(),h.create()]}()},function(p,M,h){var e={};p.exports=e;var o=h(2),i=h(0);(function(){e.create=function(a,f){for(var l=[],c=0;c<a.length;c++){var r=a[c],t={x:r.x,y:r.y,index:c,body:f,isInternal:!1};l.push(t)}return l},e.fromPath=function(a,f){var l=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,c=[];return a.replace(l,function(r,t,n){c.push({x:parseFloat(t),y:parseFloat(n)})}),e.create(c,f)},e.centre=function(a){for(var f=e.area(a,!0),l={x:0,y:0},c,r,t,n=0;n<a.length;n++)t=(n+1)%a.length,c=o.cross(a[n],a[t]),r=o.mult(o.add(a[n],a[t]),c),l=o.add(l,r);return o.div(l,6*f)},e.mean=function(a){for(var f={x:0,y:0},l=0;l<a.length;l++)f.x+=a[l].x,f.y+=a[l].y;return o.div(f,a.length)},e.area=function(a,f){for(var l=0,c=a.length-1,r=0;r<a.length;r++)l+=(a[c].x-a[r].x)*(a[c].y+a[r].y),c=r;return f?l/2:Math.abs(l)/2},e.inertia=function(a,f){for(var l=0,c=0,r=a,t,n,s=0;s<r.length;s++)n=(s+1)%r.length,t=Math.abs(o.cross(r[n],r[s])),l+=t*(o.dot(r[n],r[n])+o.dot(r[n],r[s])+o.dot(r[s],r[s])),c+=t;return f/6*(l/c)},e.translate=function(a,f,l){l=typeof l<"u"?l:1;var c=a.length,r=f.x*l,t=f.y*l,n;for(n=0;n<c;n++)a[n].x+=r,a[n].y+=t;return a},e.rotate=function(a,f,l){if(f!==0){var c=Math.cos(f),r=Math.sin(f),t=l.x,n=l.y,s=a.length,u,v,S,w;for(w=0;w<s;w++)u=a[w],v=u.x-t,S=u.y-n,u.x=t+(v*c-S*r),u.y=n+(v*r+S*c);return a}},e.contains=function(a,f){for(var l=f.x,c=f.y,r=a.length,t=a[r-1],n,s=0;s<r;s++){if(n=a[s],(l-t.x)*(n.y-t.y)+(c-t.y)*(t.x-n.x)>0)return!1;t=n}return!0},e.scale=function(a,f,l,c){if(f===1&&l===1)return a;c=c||e.centre(a);for(var r,t,n=0;n<a.length;n++)r=a[n],t=o.sub(r,c),a[n].x=c.x+t.x*f,a[n].y=c.y+t.y*l;return a},e.chamfer=function(a,f,l,c,r){typeof f=="number"?f=[f]:f=f||[8],l=typeof l<"u"?l:-1,c=c||2,r=r||14;for(var t=[],n=0;n<a.length;n++){var s=a[n-1>=0?n-1:a.length-1],u=a[n],v=a[(n+1)%a.length],S=f[n<f.length?n:f.length-1];if(S===0){t.push(u);continue}var w=o.normalise({x:u.y-s.y,y:s.x-u.x}),P=o.normalise({x:v.y-u.y,y:u.x-v.x}),m=Math.sqrt(2*Math.pow(S,2)),g=o.mult(i.clone(w),S),y=o.normalise(o.mult(o.add(w,P),.5)),x=o.sub(u,o.mult(y,m)),A=l;l===-1&&(A=Math.pow(S,.32)*1.75),A=i.clamp(A,c,r),A%2===1&&(A+=1);for(var C=Math.acos(o.dot(w,P)),V=C/A,T=0;T<A;T++)t.push(o.add(o.rotate(g,V*T),x))}return t},e.clockwiseSort=function(a){var f=e.mean(a);return a.sort(function(l,c){return o.angle(f,l)-o.angle(f,c)}),a},e.isConvex=function(a){var f=0,l=a.length,c,r,t,n;if(l<3)return null;for(c=0;c<l;c++)if(r=(c+1)%l,t=(c+2)%l,n=(a[r].x-a[c].x)*(a[t].y-a[r].y),n-=(a[r].y-a[c].y)*(a[t].x-a[r].x),n<0?f|=1:n>0&&(f|=2),f===3)return!1;return f!==0?!0:null},e.hull=function(a){var f=[],l=[],c,r;for(a=a.slice(0),a.sort(function(t,n){var s=t.x-n.x;return s!==0?s:t.y-n.y}),r=0;r<a.length;r+=1){for(c=a[r];l.length>=2&&o.cross3(l[l.length-2],l[l.length-1],c)<=0;)l.pop();l.push(c)}for(r=a.length-1;r>=0;r-=1){for(c=a[r];f.length>=2&&o.cross3(f[f.length-2],f[f.length-1],c)<=0;)f.pop();f.push(c)}return f.pop(),l.pop(),f.concat(l)}})()},function(p,M,h){var e={};p.exports=e;var o=h(3),i=h(2),a=h(7),f=h(0),l=h(1),c=h(11);(function(){e._timeCorrection=!0,e._inertiaScale=4,e._nextCollidingGroupId=1,e._nextNonCollidingGroupId=-1,e._nextCategory=1,e._baseDelta=1e3/60,e.create=function(t){var n={id:f.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:o.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,deltaTime:16.666666666666668,_original:null},s=f.extend(n,t);return r(s,t),s},e.nextGroup=function(t){return t?e._nextNonCollidingGroupId--:e._nextCollidingGroupId++},e.nextCategory=function(){return e._nextCategory=e._nextCategory<<1,e._nextCategory};var r=function(t,n){n=n||{},e.set(t,{bounds:t.bounds||l.create(t.vertices),positionPrev:t.positionPrev||i.clone(t.position),anglePrev:t.anglePrev||t.angle,vertices:t.vertices,parts:t.parts||[t],isStatic:t.isStatic,isSleeping:t.isSleeping,parent:t.parent||t}),o.rotate(t.vertices,t.angle,t.position),c.rotate(t.axes,t.angle),l.update(t.bounds,t.vertices,t.velocity),e.set(t,{axes:n.axes||t.axes,area:n.area||t.area,mass:n.mass||t.mass,inertia:n.inertia||t.inertia});var s=t.isStatic?"#14151f":f.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),u=t.isStatic?"#555":"#ccc",v=t.isStatic&&t.render.fillStyle===null?1:0;t.render.fillStyle=t.render.fillStyle||s,t.render.strokeStyle=t.render.strokeStyle||u,t.render.lineWidth=t.render.lineWidth||v,t.render.sprite.xOffset+=-(t.bounds.min.x-t.position.x)/(t.bounds.max.x-t.bounds.min.x),t.render.sprite.yOffset+=-(t.bounds.min.y-t.position.y)/(t.bounds.max.y-t.bounds.min.y)};e.set=function(t,n,s){var u;typeof n=="string"&&(u=n,n={},n[u]=s);for(u in n)if(Object.prototype.hasOwnProperty.call(n,u))switch(s=n[u],u){case"isStatic":e.setStatic(t,s);break;case"isSleeping":a.set(t,s);break;case"mass":e.setMass(t,s);break;case"density":e.setDensity(t,s);break;case"inertia":e.setInertia(t,s);break;case"vertices":e.setVertices(t,s);break;case"position":e.setPosition(t,s);break;case"angle":e.setAngle(t,s);break;case"velocity":e.setVelocity(t,s);break;case"angularVelocity":e.setAngularVelocity(t,s);break;case"speed":e.setSpeed(t,s);break;case"angularSpeed":e.setAngularSpeed(t,s);break;case"parts":e.setParts(t,s);break;case"centre":e.setCentre(t,s);break;default:t[u]=s}},e.setStatic=function(t,n){for(var s=0;s<t.parts.length;s++){var u=t.parts[s];u.isStatic=n,n?(u._original={restitution:u.restitution,friction:u.friction,mass:u.mass,inertia:u.inertia,density:u.density,inverseMass:u.inverseMass,inverseInertia:u.inverseInertia},u.restitution=0,u.friction=1,u.mass=u.inertia=u.density=1/0,u.inverseMass=u.inverseInertia=0,u.positionPrev.x=u.position.x,u.positionPrev.y=u.position.y,u.anglePrev=u.angle,u.angularVelocity=0,u.speed=0,u.angularSpeed=0,u.motion=0):u._original&&(u.restitution=u._original.restitution,u.friction=u._original.friction,u.mass=u._original.mass,u.inertia=u._original.inertia,u.density=u._original.density,u.inverseMass=u._original.inverseMass,u.inverseInertia=u._original.inverseInertia,u._original=null)}},e.setMass=function(t,n){var s=t.inertia/(t.mass/6);t.inertia=s*(n/6),t.inverseInertia=1/t.inertia,t.mass=n,t.inverseMass=1/t.mass,t.density=t.mass/t.area},e.setDensity=function(t,n){e.setMass(t,n*t.area),t.density=n},e.setInertia=function(t,n){t.inertia=n,t.inverseInertia=1/t.inertia},e.setVertices=function(t,n){n[0].body===t?t.vertices=n:t.vertices=o.create(n,t),t.axes=c.fromVertices(t.vertices),t.area=o.area(t.vertices),e.setMass(t,t.density*t.area);var s=o.centre(t.vertices);o.translate(t.vertices,s,-1),e.setInertia(t,e._inertiaScale*o.inertia(t.vertices,t.mass)),o.translate(t.vertices,t.position),l.update(t.bounds,t.vertices,t.velocity)},e.setParts=function(t,n,s){var u;for(n=n.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,u=0;u<n.length;u++){var v=n[u];v!==t&&(v.parent=t,t.parts.push(v))}if(t.parts.length!==1){if(s=typeof s<"u"?s:!0,s){var S=[];for(u=0;u<n.length;u++)S=S.concat(n[u].vertices);o.clockwiseSort(S);var w=o.hull(S),P=o.centre(w);e.setVertices(t,w),o.translate(t.vertices,P)}var m=e._totalProperties(t);t.area=m.area,t.parent=t,t.position.x=m.centre.x,t.position.y=m.centre.y,t.positionPrev.x=m.centre.x,t.positionPrev.y=m.centre.y,e.setMass(t,m.mass),e.setInertia(t,m.inertia),e.setPosition(t,m.centre)}},e.setCentre=function(t,n,s){s?(t.positionPrev.x+=n.x,t.positionPrev.y+=n.y,t.position.x+=n.x,t.position.y+=n.y):(t.positionPrev.x=n.x-(t.position.x-t.positionPrev.x),t.positionPrev.y=n.y-(t.position.y-t.positionPrev.y),t.position.x=n.x,t.position.y=n.y)},e.setPosition=function(t,n,s){var u=i.sub(n,t.position);s?(t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.velocity.x=u.x,t.velocity.y=u.y,t.speed=i.magnitude(u)):(t.positionPrev.x+=u.x,t.positionPrev.y+=u.y);for(var v=0;v<t.parts.length;v++){var S=t.parts[v];S.position.x+=u.x,S.position.y+=u.y,o.translate(S.vertices,u),l.update(S.bounds,S.vertices,t.velocity)}},e.setAngle=function(t,n,s){var u=n-t.angle;s?(t.anglePrev=t.angle,t.angularVelocity=u,t.angularSpeed=Math.abs(u)):t.anglePrev+=u;for(var v=0;v<t.parts.length;v++){var S=t.parts[v];S.angle+=u,o.rotate(S.vertices,u,t.position),c.rotate(S.axes,u),l.update(S.bounds,S.vertices,t.velocity),v>0&&i.rotateAbout(S.position,u,t.position,S.position)}},e.setVelocity=function(t,n){var s=t.deltaTime/e._baseDelta;t.positionPrev.x=t.position.x-n.x*s,t.positionPrev.y=t.position.y-n.y*s,t.velocity.x=(t.position.x-t.positionPrev.x)/s,t.velocity.y=(t.position.y-t.positionPrev.y)/s,t.speed=i.magnitude(t.velocity)},e.getVelocity=function(t){var n=e._baseDelta/t.deltaTime;return{x:(t.position.x-t.positionPrev.x)*n,y:(t.position.y-t.positionPrev.y)*n}},e.getSpeed=function(t){return i.magnitude(e.getVelocity(t))},e.setSpeed=function(t,n){e.setVelocity(t,i.mult(i.normalise(e.getVelocity(t)),n))},e.setAngularVelocity=function(t,n){var s=t.deltaTime/e._baseDelta;t.anglePrev=t.angle-n*s,t.angularVelocity=(t.angle-t.anglePrev)/s,t.angularSpeed=Math.abs(t.angularVelocity)},e.getAngularVelocity=function(t){return(t.angle-t.anglePrev)*e._baseDelta/t.deltaTime},e.getAngularSpeed=function(t){return Math.abs(e.getAngularVelocity(t))},e.setAngularSpeed=function(t,n){e.setAngularVelocity(t,f.sign(e.getAngularVelocity(t))*n)},e.translate=function(t,n,s){e.setPosition(t,i.add(t.position,n),s)},e.rotate=function(t,n,s,u){if(!s)e.setAngle(t,t.angle+n,u);else{var v=Math.cos(n),S=Math.sin(n),w=t.position.x-s.x,P=t.position.y-s.y;e.setPosition(t,{x:s.x+(w*v-P*S),y:s.y+(w*S+P*v)},u),e.setAngle(t,t.angle+n,u)}},e.scale=function(t,n,s,u){var v=0,S=0;u=u||t.position;for(var w=0;w<t.parts.length;w++){var P=t.parts[w];o.scale(P.vertices,n,s,u),P.axes=c.fromVertices(P.vertices),P.area=o.area(P.vertices),e.setMass(P,t.density*P.area),o.translate(P.vertices,{x:-P.position.x,y:-P.position.y}),e.setInertia(P,e._inertiaScale*o.inertia(P.vertices,P.mass)),o.translate(P.vertices,{x:P.position.x,y:P.position.y}),w>0&&(v+=P.area,S+=P.inertia),P.position.x=u.x+(P.position.x-u.x)*n,P.position.y=u.y+(P.position.y-u.y)*s,l.update(P.bounds,P.vertices,t.velocity)}t.parts.length>1&&(t.area=v,t.isStatic||(e.setMass(t,t.density*v),e.setInertia(t,S))),t.circleRadius&&(n===s?t.circleRadius*=n:t.circleRadius=null)},e.update=function(t,n){n=(typeof n<"u"?n:1e3/60)*t.timeScale;var s=n*n,u=e._timeCorrection?n/(t.deltaTime||n):1,v=1-t.frictionAir*(n/f._baseDelta),S=(t.position.x-t.positionPrev.x)*u,w=(t.position.y-t.positionPrev.y)*u;t.velocity.x=S*v+t.force.x/t.mass*s,t.velocity.y=w*v+t.force.y/t.mass*s,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.deltaTime=n,t.angularVelocity=(t.angle-t.anglePrev)*v*u+t.torque/t.inertia*s,t.anglePrev=t.angle,t.angle+=t.angularVelocity;for(var P=0;P<t.parts.length;P++){var m=t.parts[P];o.translate(m.vertices,t.velocity),P>0&&(m.position.x+=t.velocity.x,m.position.y+=t.velocity.y),t.angularVelocity!==0&&(o.rotate(m.vertices,t.angularVelocity,t.position),c.rotate(m.axes,t.angularVelocity),P>0&&i.rotateAbout(m.position,t.angularVelocity,t.position,m.position)),l.update(m.bounds,m.vertices,t.velocity)}},e.updateVelocities=function(t){var n=e._baseDelta/t.deltaTime,s=t.velocity;s.x=(t.position.x-t.positionPrev.x)*n,s.y=(t.position.y-t.positionPrev.y)*n,t.speed=Math.sqrt(s.x*s.x+s.y*s.y),t.angularVelocity=(t.angle-t.anglePrev)*n,t.angularSpeed=Math.abs(t.angularVelocity)},e.applyForce=function(t,n,s){var u={x:n.x-t.position.x,y:n.y-t.position.y};t.force.x+=s.x,t.force.y+=s.y,t.torque+=u.x*s.y-u.y*s.x},e._totalProperties=function(t){for(var n={mass:0,area:0,inertia:0,centre:{x:0,y:0}},s=t.parts.length===1?0:1;s<t.parts.length;s++){var u=t.parts[s],v=u.mass!==1/0?u.mass:1;n.mass+=v,n.area+=u.area,n.inertia+=u.inertia,n.centre=i.add(n.centre,i.mult(u.position,v))}return n.centre=i.div(n.centre,n.mass),n}})()},function(p,M,h){var e={};p.exports=e;var o=h(0);(function(){e.on=function(i,a,f){for(var l=a.split(" "),c,r=0;r<l.length;r++)c=l[r],i.events=i.events||{},i.events[c]=i.events[c]||[],i.events[c].push(f);return f},e.off=function(i,a,f){if(!a){i.events={};return}typeof a=="function"&&(f=a,a=o.keys(i.events).join(" "));for(var l=a.split(" "),c=0;c<l.length;c++){var r=i.events[l[c]],t=[];if(f&&r)for(var n=0;n<r.length;n++)r[n]!==f&&t.push(r[n]);i.events[l[c]]=t}},e.trigger=function(i,a,f){var l,c,r,t,n=i.events;if(n&&o.keys(n).length>0){f||(f={}),l=a.split(" ");for(var s=0;s<l.length;s++)if(c=l[s],r=n[c],r){t=o.clone(f,!1),t.name=c,t.source=i;for(var u=0;u<r.length;u++)r[u].apply(i,[t])}}}})()},function(p,M,h){var e={};p.exports=e;var o=h(5),i=h(0),a=h(1),f=h(4);(function(){e.create=function(l){return i.extend({id:i.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},l)},e.setModified=function(l,c,r,t){if(l.isModified=c,c&&l.cache&&(l.cache.allBodies=null,l.cache.allConstraints=null,l.cache.allComposites=null),r&&l.parent&&e.setModified(l.parent,c,r,t),t)for(var n=0;n<l.composites.length;n++){var s=l.composites[n];e.setModified(s,c,r,t)}},e.add=function(l,c){var r=[].concat(c);o.trigger(l,"beforeAdd",{object:c});for(var t=0;t<r.length;t++){var n=r[t];switch(n.type){case"body":if(n.parent!==n){i.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}e.addBody(l,n);break;case"constraint":e.addConstraint(l,n);break;case"composite":e.addComposite(l,n);break;case"mouseConstraint":e.addConstraint(l,n.constraint);break}}return o.trigger(l,"afterAdd",{object:c}),l},e.remove=function(l,c,r){var t=[].concat(c);o.trigger(l,"beforeRemove",{object:c});for(var n=0;n<t.length;n++){var s=t[n];switch(s.type){case"body":e.removeBody(l,s,r);break;case"constraint":e.removeConstraint(l,s,r);break;case"composite":e.removeComposite(l,s,r);break;case"mouseConstraint":e.removeConstraint(l,s.constraint);break}}return o.trigger(l,"afterRemove",{object:c}),l},e.addComposite=function(l,c){return l.composites.push(c),c.parent=l,e.setModified(l,!0,!0,!1),l},e.removeComposite=function(l,c,r){var t=i.indexOf(l.composites,c);if(t!==-1&&e.removeCompositeAt(l,t),r)for(var n=0;n<l.composites.length;n++)e.removeComposite(l.composites[n],c,!0);return l},e.removeCompositeAt=function(l,c){return l.composites.splice(c,1),e.setModified(l,!0,!0,!1),l},e.addBody=function(l,c){return l.bodies.push(c),e.setModified(l,!0,!0,!1),l},e.removeBody=function(l,c,r){var t=i.indexOf(l.bodies,c);if(t!==-1&&e.removeBodyAt(l,t),r)for(var n=0;n<l.composites.length;n++)e.removeBody(l.composites[n],c,!0);return l},e.removeBodyAt=function(l,c){return l.bodies.splice(c,1),e.setModified(l,!0,!0,!1),l},e.addConstraint=function(l,c){return l.constraints.push(c),e.setModified(l,!0,!0,!1),l},e.removeConstraint=function(l,c,r){var t=i.indexOf(l.constraints,c);if(t!==-1&&e.removeConstraintAt(l,t),r)for(var n=0;n<l.composites.length;n++)e.removeConstraint(l.composites[n],c,!0);return l},e.removeConstraintAt=function(l,c){return l.constraints.splice(c,1),e.setModified(l,!0,!0,!1),l},e.clear=function(l,c,r){if(r)for(var t=0;t<l.composites.length;t++)e.clear(l.composites[t],c,!0);return c?l.bodies=l.bodies.filter(function(n){return n.isStatic}):l.bodies.length=0,l.constraints.length=0,l.composites.length=0,e.setModified(l,!0,!0,!1),l},e.allBodies=function(l){if(l.cache&&l.cache.allBodies)return l.cache.allBodies;for(var c=[].concat(l.bodies),r=0;r<l.composites.length;r++)c=c.concat(e.allBodies(l.composites[r]));return l.cache&&(l.cache.allBodies=c),c},e.allConstraints=function(l){if(l.cache&&l.cache.allConstraints)return l.cache.allConstraints;for(var c=[].concat(l.constraints),r=0;r<l.composites.length;r++)c=c.concat(e.allConstraints(l.composites[r]));return l.cache&&(l.cache.allConstraints=c),c},e.allComposites=function(l){if(l.cache&&l.cache.allComposites)return l.cache.allComposites;for(var c=[].concat(l.composites),r=0;r<l.composites.length;r++)c=c.concat(e.allComposites(l.composites[r]));return l.cache&&(l.cache.allComposites=c),c},e.get=function(l,c,r){var t,n;switch(r){case"body":t=e.allBodies(l);break;case"constraint":t=e.allConstraints(l);break;case"composite":t=e.allComposites(l).concat(l);break}return t?(n=t.filter(function(s){return s.id.toString()===c.toString()}),n.length===0?null:n[0]):null},e.move=function(l,c,r){return e.remove(l,c),e.add(r,c),l},e.rebase=function(l){for(var c=e.allBodies(l).concat(e.allConstraints(l)).concat(e.allComposites(l)),r=0;r<c.length;r++)c[r].id=i.nextId();return l},e.translate=function(l,c,r){for(var t=r?e.allBodies(l):l.bodies,n=0;n<t.length;n++)f.translate(t[n],c);return l},e.rotate=function(l,c,r,t){for(var n=Math.cos(c),s=Math.sin(c),u=t?e.allBodies(l):l.bodies,v=0;v<u.length;v++){var S=u[v],w=S.position.x-r.x,P=S.position.y-r.y;f.setPosition(S,{x:r.x+(w*n-P*s),y:r.y+(w*s+P*n)}),f.rotate(S,c)}return l},e.scale=function(l,c,r,t,n){for(var s=n?e.allBodies(l):l.bodies,u=0;u<s.length;u++){var v=s[u],S=v.position.x-t.x,w=v.position.y-t.y;f.setPosition(v,{x:t.x+S*c,y:t.y+w*r}),f.scale(v,c,r)}return l},e.bounds=function(l){for(var c=e.allBodies(l),r=[],t=0;t<c.length;t+=1){var n=c[t];r.push(n.bounds.min,n.bounds.max)}return a.create(r)}})()},function(p,M,h){var e={};p.exports=e;var o=h(4),i=h(5),a=h(0);(function(){e._motionWakeThreshold=.18,e._motionSleepThreshold=.08,e._minBias=.9,e.update=function(f,l){for(var c=l/a._baseDelta,r=e._motionSleepThreshold,t=0;t<f.length;t++){var n=f[t],s=o.getSpeed(n),u=o.getAngularSpeed(n),v=s*s+u*u;if(n.force.x!==0||n.force.y!==0){e.set(n,!1);continue}var S=Math.min(n.motion,v),w=Math.max(n.motion,v);n.motion=e._minBias*S+(1-e._minBias)*w,n.sleepThreshold>0&&n.motion<r?(n.sleepCounter+=1,n.sleepCounter>=n.sleepThreshold/c&&e.set(n,!0)):n.sleepCounter>0&&(n.sleepCounter-=1)}},e.afterCollisions=function(f){for(var l=e._motionSleepThreshold,c=0;c<f.length;c++){var r=f[c];if(r.isActive){var t=r.collision,n=t.bodyA.parent,s=t.bodyB.parent;if(!(n.isSleeping&&s.isSleeping||n.isStatic||s.isStatic)&&(n.isSleeping||s.isSleeping)){var u=n.isSleeping&&!n.isStatic?n:s,v=u===n?s:n;!u.isStatic&&v.motion>l&&e.set(u,!1)}}}},e.set=function(f,l){var c=f.isSleeping;l?(f.isSleeping=!0,f.sleepCounter=f.sleepThreshold,f.positionImpulse.x=0,f.positionImpulse.y=0,f.positionPrev.x=f.position.x,f.positionPrev.y=f.position.y,f.anglePrev=f.angle,f.speed=0,f.angularSpeed=0,f.motion=0,c||i.trigger(f,"sleepStart")):(f.isSleeping=!1,f.sleepCounter=0,c&&i.trigger(f,"sleepEnd"))}})()},function(p,M,h){var e={};p.exports=e;var o=h(3),i=h(9);(function(){var a=[],f={overlap:0,axis:null},l={overlap:0,axis:null};e.create=function(c,r){return{pair:null,collided:!1,bodyA:c,bodyB:r,parentA:c.parent,parentB:r.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},e.collides=function(c,r,t){if(e._overlapAxes(f,c.vertices,r.vertices,c.axes),f.overlap<=0||(e._overlapAxes(l,r.vertices,c.vertices,r.axes),l.overlap<=0))return null;var n=t&&t.table[i.id(c,r)],s;n?s=n.collision:(s=e.create(c,r),s.collided=!0,s.bodyA=c.id<r.id?c:r,s.bodyB=c.id<r.id?r:c,s.parentA=s.bodyA.parent,s.parentB=s.bodyB.parent),c=s.bodyA,r=s.bodyB;var u;f.overlap<l.overlap?u=f:u=l;var v=s.normal,S=s.supports,w=u.axis,P=w.x,m=w.y;P*(r.position.x-c.position.x)+m*(r.position.y-c.position.y)<0?(v.x=P,v.y=m):(v.x=-P,v.y=-m),s.tangent.x=-v.y,s.tangent.y=v.x,s.depth=u.overlap,s.penetration.x=v.x*s.depth,s.penetration.y=v.y*s.depth;var g=e._findSupports(c,r,v,1),y=0;if(o.contains(c.vertices,g[0])&&(S[y++]=g[0]),o.contains(c.vertices,g[1])&&(S[y++]=g[1]),y<2){var x=e._findSupports(r,c,v,-1);o.contains(r.vertices,x[0])&&(S[y++]=x[0]),y<2&&o.contains(r.vertices,x[1])&&(S[y++]=x[1])}return y===0&&(S[y++]=g[0]),S.length=y,s},e._overlapAxes=function(c,r,t,n){var s=r.length,u=t.length,v=r[0].x,S=r[0].y,w=t[0].x,P=t[0].y,m=n.length,g=Number.MAX_VALUE,y=0,x,A,C,V,T,I;for(T=0;T<m;T++){var F=n[T],R=F.x,B=F.y,H=v*R+S*B,L=w*R+P*B,O=H,W=L;for(I=1;I<s;I+=1)V=r[I].x*R+r[I].y*B,V>O?O=V:V<H&&(H=V);for(I=1;I<u;I+=1)V=t[I].x*R+t[I].y*B,V>W?W=V:V<L&&(L=V);if(A=O-L,C=W-H,x=A<C?A:C,x<g&&(g=x,y=T,x<=0))break}c.axis=n[y],c.overlap=g},e._projectToAxis=function(c,r,t){for(var n=r[0].x*t.x+r[0].y*t.y,s=n,u=1;u<r.length;u+=1){var v=r[u].x*t.x+r[u].y*t.y;v>s?s=v:v<n&&(n=v)}c.min=n,c.max=s},e._findSupports=function(c,r,t,n){var s=r.vertices,u=s.length,v=c.position.x,S=c.position.y,w=t.x*n,P=t.y*n,m=Number.MAX_VALUE,g,y,x,A,C;for(C=0;C<u;C+=1)y=s[C],A=w*(v-y.x)+P*(S-y.y),A<m&&(m=A,g=y);return x=s[(u+g.index-1)%u],m=w*(v-x.x)+P*(S-x.y),y=s[(g.index+1)%u],w*(v-y.x)+P*(S-y.y)<m?(a[0]=g,a[1]=y,a):(a[0]=g,a[1]=x,a)}})()},function(p,M,h){var e={};p.exports=e;var o=h(16);(function(){e.create=function(i,a){var f=i.bodyA,l=i.bodyB,c={id:e.id(f,l),bodyA:f,bodyB:l,collision:i,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:f.isSensor||l.isSensor,timeCreated:a,timeUpdated:a,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return e.update(c,i,a),c},e.update=function(i,a,f){var l=i.contacts,c=a.supports,r=i.activeContacts,t=a.parentA,n=a.parentB,s=t.vertices.length;i.isActive=!0,i.timeUpdated=f,i.collision=a,i.separation=a.depth,i.inverseMass=t.inverseMass+n.inverseMass,i.friction=t.friction<n.friction?t.friction:n.friction,i.frictionStatic=t.frictionStatic>n.frictionStatic?t.frictionStatic:n.frictionStatic,i.restitution=t.restitution>n.restitution?t.restitution:n.restitution,i.slop=t.slop>n.slop?t.slop:n.slop,a.pair=i,r.length=0;for(var u=0;u<c.length;u++){var v=c[u],S=v.body===t?v.index:s+v.index,w=l[S];w?r.push(w):r.push(l[S]=o.create(v))}},e.setActive=function(i,a,f){a?(i.isActive=!0,i.timeUpdated=f):(i.isActive=!1,i.activeContacts.length=0)},e.id=function(i,a){return i.id<a.id?"A"+i.id+"B"+a.id:"A"+a.id+"B"+i.id}})()},function(p,M,h){var e={};p.exports=e;var o=h(3),i=h(2),a=h(7),f=h(1),l=h(11),c=h(0);(function(){e._warming=.4,e._torqueDampen=1,e._minLength=1e-6,e.create=function(r){var t=r;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var n=t.bodyA?i.add(t.bodyA.position,t.pointA):t.pointA,s=t.bodyB?i.add(t.bodyB.position,t.pointB):t.pointB,u=i.magnitude(i.sub(n,s));t.length=typeof t.length<"u"?t.length:u,t.id=t.id||c.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(t.length>0?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var v={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return t.length===0&&t.stiffness>.1?(v.type="pin",v.anchors=!1):t.stiffness<.9&&(v.type="spring"),t.render=c.extend(v,t.render),t},e.preSolveAll=function(r){for(var t=0;t<r.length;t+=1){var n=r[t],s=n.constraintImpulse;n.isStatic||s.x===0&&s.y===0&&s.angle===0||(n.position.x+=s.x,n.position.y+=s.y,n.angle+=s.angle)}},e.solveAll=function(r,t){for(var n=c.clamp(t/c._baseDelta,0,1),s=0;s<r.length;s+=1){var u=r[s],v=!u.bodyA||u.bodyA&&u.bodyA.isStatic,S=!u.bodyB||u.bodyB&&u.bodyB.isStatic;(v||S)&&e.solve(r[s],n)}for(s=0;s<r.length;s+=1)u=r[s],v=!u.bodyA||u.bodyA&&u.bodyA.isStatic,S=!u.bodyB||u.bodyB&&u.bodyB.isStatic,!v&&!S&&e.solve(r[s],n)},e.solve=function(r,t){var n=r.bodyA,s=r.bodyB,u=r.pointA,v=r.pointB;if(!(!n&&!s)){n&&!n.isStatic&&(i.rotate(u,n.angle-r.angleA,u),r.angleA=n.angle),s&&!s.isStatic&&(i.rotate(v,s.angle-r.angleB,v),r.angleB=s.angle);var S=u,w=v;if(n&&(S=i.add(n.position,u)),s&&(w=i.add(s.position,v)),!(!S||!w)){var P=i.sub(S,w),m=i.magnitude(P);m<e._minLength&&(m=e._minLength);var g=(m-r.length)/m,y=r.stiffness>=1||r.length===0,x=y?r.stiffness*t:r.stiffness*t*t,A=r.damping*t,C=i.mult(P,g*x),V=(n?n.inverseMass:0)+(s?s.inverseMass:0),T=(n?n.inverseInertia:0)+(s?s.inverseInertia:0),I=V+T,F,R,B,H,L;if(A>0){var O=i.create();B=i.div(P,m),L=i.sub(s&&i.sub(s.position,s.positionPrev)||O,n&&i.sub(n.position,n.positionPrev)||O),H=i.dot(B,L)}n&&!n.isStatic&&(R=n.inverseMass/V,n.constraintImpulse.x-=C.x*R,n.constraintImpulse.y-=C.y*R,n.position.x-=C.x*R,n.position.y-=C.y*R,A>0&&(n.positionPrev.x-=A*B.x*H*R,n.positionPrev.y-=A*B.y*H*R),F=i.cross(u,C)/I*e._torqueDampen*n.inverseInertia*(1-r.angularStiffness),n.constraintImpulse.angle-=F,n.angle-=F),s&&!s.isStatic&&(R=s.inverseMass/V,s.constraintImpulse.x+=C.x*R,s.constraintImpulse.y+=C.y*R,s.position.x+=C.x*R,s.position.y+=C.y*R,A>0&&(s.positionPrev.x+=A*B.x*H*R,s.positionPrev.y+=A*B.y*H*R),F=i.cross(v,C)/I*e._torqueDampen*s.inverseInertia*(1-r.angularStiffness),s.constraintImpulse.angle+=F,s.angle+=F)}}},e.postSolveAll=function(r){for(var t=0;t<r.length;t++){var n=r[t],s=n.constraintImpulse;if(!(n.isStatic||s.x===0&&s.y===0&&s.angle===0)){a.set(n,!1);for(var u=0;u<n.parts.length;u++){var v=n.parts[u];o.translate(v.vertices,s),u>0&&(v.position.x+=s.x,v.position.y+=s.y),s.angle!==0&&(o.rotate(v.vertices,s.angle,n.position),l.rotate(v.axes,s.angle),u>0&&i.rotateAbout(v.position,s.angle,n.position,v.position)),f.update(v.bounds,v.vertices,n.velocity)}s.angle*=e._warming,s.x*=e._warming,s.y*=e._warming}}},e.pointAWorld=function(r){return{x:(r.bodyA?r.bodyA.position.x:0)+(r.pointA?r.pointA.x:0),y:(r.bodyA?r.bodyA.position.y:0)+(r.pointA?r.pointA.y:0)}},e.pointBWorld=function(r){return{x:(r.bodyB?r.bodyB.position.x:0)+(r.pointB?r.pointB.x:0),y:(r.bodyB?r.bodyB.position.y:0)+(r.pointB?r.pointB.y:0)}}})()},function(p,M,h){var e={};p.exports=e;var o=h(2),i=h(0);(function(){e.fromVertices=function(a){for(var f={},l=0;l<a.length;l++){var c=(l+1)%a.length,r=o.normalise({x:a[c].y-a[l].y,y:a[l].x-a[c].x}),t=r.y===0?1/0:r.x/r.y;t=t.toFixed(3).toString(),f[t]=r}return i.values(f)},e.rotate=function(a,f){if(f!==0)for(var l=Math.cos(f),c=Math.sin(f),r=0;r<a.length;r++){var t=a[r],n;n=t.x*l-t.y*c,t.y=t.x*c+t.y*l,t.x=n}}})()},function(p,M,h){var e={};p.exports=e;var o=h(3),i=h(0),a=h(4),f=h(1),l=h(2);(function(){e.rectangle=function(c,r,t,n,s){s=s||{};var u={label:"Rectangle Body",position:{x:c,y:r},vertices:o.fromPath("L 0 0 L "+t+" 0 L "+t+" "+n+" L 0 "+n)};if(s.chamfer){var v=s.chamfer;u.vertices=o.chamfer(u.vertices,v.radius,v.quality,v.qualityMin,v.qualityMax),delete s.chamfer}return a.create(i.extend({},u,s))},e.trapezoid=function(c,r,t,n,s,u){u=u||{},s*=.5;var v=(1-s*2)*t,S=t*s,w=S+v,P=w+S,m;s<.5?m="L 0 0 L "+S+" "+-n+" L "+w+" "+-n+" L "+P+" 0":m="L 0 0 L "+w+" "+-n+" L "+P+" 0";var g={label:"Trapezoid Body",position:{x:c,y:r},vertices:o.fromPath(m)};if(u.chamfer){var y=u.chamfer;g.vertices=o.chamfer(g.vertices,y.radius,y.quality,y.qualityMin,y.qualityMax),delete u.chamfer}return a.create(i.extend({},g,u))},e.circle=function(c,r,t,n,s){n=n||{};var u={label:"Circle Body",circleRadius:t};s=s||25;var v=Math.ceil(Math.max(10,Math.min(s,t)));return v%2===1&&(v+=1),e.polygon(c,r,v,t,i.extend({},u,n))},e.polygon=function(c,r,t,n,s){if(s=s||{},t<3)return e.circle(c,r,n,s);for(var u=2*Math.PI/t,v="",S=u*.5,w=0;w<t;w+=1){var P=S+w*u,m=Math.cos(P)*n,g=Math.sin(P)*n;v+="L "+m.toFixed(3)+" "+g.toFixed(3)+" "}var y={label:"Polygon Body",position:{x:c,y:r},vertices:o.fromPath(v)};if(s.chamfer){var x=s.chamfer;y.vertices=o.chamfer(y.vertices,x.radius,x.quality,x.qualityMin,x.qualityMax),delete s.chamfer}return a.create(i.extend({},y,s))},e.fromVertices=function(c,r,t,n,s,u,v,S){var w=i.getDecomp(),P,m,g,y,x,A,C,V,T,I,F;for(P=!!(w&&w.quickDecomp),n=n||{},g=[],s=typeof s<"u"?s:!1,u=typeof u<"u"?u:.01,v=typeof v<"u"?v:10,S=typeof S<"u"?S:.01,i.isArray(t[0])||(t=[t]),I=0;I<t.length;I+=1)if(A=t[I],y=o.isConvex(A),x=!y,x&&!P&&i.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),y||!P)y?A=o.clockwiseSort(A):A=o.hull(A),g.push({position:{x:c,y:r},vertices:A});else{var R=A.map(function(z){return[z.x,z.y]});w.makeCCW(R),u!==!1&&w.removeCollinearPoints(R,u),S!==!1&&w.removeDuplicatePoints&&w.removeDuplicatePoints(R,S);var B=w.quickDecomp(R);for(C=0;C<B.length;C++){var H=B[C],L=H.map(function(z){return{x:z[0],y:z[1]}});v>0&&o.area(L)<v||g.push({position:o.centre(L),vertices:L})}}for(C=0;C<g.length;C++)g[C]=a.create(i.extend(g[C],n));if(s){var O=5;for(C=0;C<g.length;C++){var W=g[C];for(V=C+1;V<g.length;V++){var N=g[V];if(f.overlaps(W.bounds,N.bounds)){var D=W.vertices,G=N.vertices;for(T=0;T<W.vertices.length;T++)for(F=0;F<N.vertices.length;F++){var b=l.magnitudeSquared(l.sub(D[(T+1)%D.length],G[F])),$=l.magnitudeSquared(l.sub(D[T],G[(F+1)%G.length]));b<O&&$<O&&(D[T].isInternal=!0,G[F].isInternal=!0)}}}}}return g.length>1?(m=a.create(i.extend({parts:g.slice(0)},n)),a.setPosition(m,{x:c,y:r}),m):g[0]}})()},function(p,M,h){var e={};p.exports=e;var o=h(0),i=h(8);(function(){e.create=function(a){var f={bodies:[],pairs:null};return o.extend(f,a)},e.setBodies=function(a,f){a.bodies=f.slice(0)},e.clear=function(a){a.bodies=[]},e.collisions=function(a){var f=[],l=a.pairs,c=a.bodies,r=c.length,t=e.canCollide,n=i.collides,s,u;for(c.sort(e._compareBoundsX),s=0;s<r;s++){var v=c[s],S=v.bounds,w=v.bounds.max.x,P=v.bounds.max.y,m=v.bounds.min.y,g=v.isStatic||v.isSleeping,y=v.parts.length,x=y===1;for(u=s+1;u<r;u++){var A=c[u],C=A.bounds;if(C.min.x>w)break;if(!(P<C.min.y||m>C.max.y)&&!(g&&(A.isStatic||A.isSleeping))&&t(v.collisionFilter,A.collisionFilter)){var V=A.parts.length;if(x&&V===1){var T=n(v,A,l);T&&f.push(T)}else for(var I=y>1?1:0,F=V>1?1:0,R=I;R<y;R++)for(var B=v.parts[R],S=B.bounds,H=F;H<V;H++){var L=A.parts[H],C=L.bounds;if(!(S.min.x>C.max.x||S.max.x<C.min.x||S.max.y<C.min.y||S.min.y>C.max.y)){var T=n(B,L,l);T&&f.push(T)}}}}}return f},e.canCollide=function(a,f){return a.group===f.group&&a.group!==0?a.group>0:(a.mask&f.category)!==0&&(f.mask&a.category)!==0},e._compareBoundsX=function(a,f){return a.bounds.min.x-f.bounds.min.x}})()},function(p,M,h){var e={};p.exports=e;var o=h(0);(function(){e.create=function(i){var a={};return i||o.log("Mouse.create: element was undefined, defaulting to document.body","warn"),a.element=i||document.body,a.absolute={x:0,y:0},a.position={x:0,y:0},a.mousedownPosition={x:0,y:0},a.mouseupPosition={x:0,y:0},a.offset={x:0,y:0},a.scale={x:1,y:1},a.wheelDelta=0,a.button=-1,a.pixelRatio=parseInt(a.element.getAttribute("data-pixel-ratio"),10)||1,a.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},a.mousemove=function(f){var l=e._getRelativeMousePosition(f,a.element,a.pixelRatio),c=f.changedTouches;c&&(a.button=0,f.preventDefault()),a.absolute.x=l.x,a.absolute.y=l.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.sourceEvents.mousemove=f},a.mousedown=function(f){var l=e._getRelativeMousePosition(f,a.element,a.pixelRatio),c=f.changedTouches;c?(a.button=0,f.preventDefault()):a.button=f.button,a.absolute.x=l.x,a.absolute.y=l.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mousedownPosition.x=a.position.x,a.mousedownPosition.y=a.position.y,a.sourceEvents.mousedown=f},a.mouseup=function(f){var l=e._getRelativeMousePosition(f,a.element,a.pixelRatio),c=f.changedTouches;c&&f.preventDefault(),a.button=-1,a.absolute.x=l.x,a.absolute.y=l.y,a.position.x=a.absolute.x*a.scale.x+a.offset.x,a.position.y=a.absolute.y*a.scale.y+a.offset.y,a.mouseupPosition.x=a.position.x,a.mouseupPosition.y=a.position.y,a.sourceEvents.mouseup=f},a.mousewheel=function(f){a.wheelDelta=Math.max(-1,Math.min(1,f.wheelDelta||-f.detail)),f.preventDefault()},e.setElement(a,a.element),a},e.setElement=function(i,a){i.element=a,a.addEventListener("mousemove",i.mousemove),a.addEventListener("mousedown",i.mousedown),a.addEventListener("mouseup",i.mouseup),a.addEventListener("mousewheel",i.mousewheel),a.addEventListener("DOMMouseScroll",i.mousewheel),a.addEventListener("touchmove",i.mousemove),a.addEventListener("touchstart",i.mousedown),a.addEventListener("touchend",i.mouseup)},e.clearSourceEvents=function(i){i.sourceEvents.mousemove=null,i.sourceEvents.mousedown=null,i.sourceEvents.mouseup=null,i.sourceEvents.mousewheel=null,i.wheelDelta=0},e.setOffset=function(i,a){i.offset.x=a.x,i.offset.y=a.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y},e.setScale=function(i,a){i.scale.x=a.x,i.scale.y=a.y,i.position.x=i.absolute.x*i.scale.x+i.offset.x,i.position.y=i.absolute.y*i.scale.y+i.offset.y},e._getRelativeMousePosition=function(i,a,f){var l=a.getBoundingClientRect(),c=document.documentElement||document.body.parentNode||document.body,r=window.pageXOffset!==void 0?window.pageXOffset:c.scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:c.scrollTop,n=i.changedTouches,s,u;return n?(s=n[0].pageX-l.left-r,u=n[0].pageY-l.top-t):(s=i.pageX-l.left-r,u=i.pageY-l.top-t),{x:s/(a.clientWidth/(a.width||a.clientWidth)*f),y:u/(a.clientHeight/(a.height||a.clientHeight)*f)}}})()},function(p,M,h){var e={};p.exports=e;var o=h(0);(function(){e._registry={},e.register=function(i){if(e.isPlugin(i)||o.warn("Plugin.register:",e.toString(i),"does not implement all required fields."),i.name in e._registry){var a=e._registry[i.name],f=e.versionParse(i.version).number,l=e.versionParse(a.version).number;f>l?(o.warn("Plugin.register:",e.toString(a),"was upgraded to",e.toString(i)),e._registry[i.name]=i):f<l?o.warn("Plugin.register:",e.toString(a),"can not be downgraded to",e.toString(i)):i!==a&&o.warn("Plugin.register:",e.toString(i),"is already registered to different plugin object")}else e._registry[i.name]=i;return i},e.resolve=function(i){return e._registry[e.dependencyParse(i).name]},e.toString=function(i){return typeof i=="string"?i:(i.name||"anonymous")+"@"+(i.version||i.range||"0.0.0")},e.isPlugin=function(i){return i&&i.name&&i.version&&i.install},e.isUsed=function(i,a){return i.used.indexOf(a)>-1},e.isFor=function(i,a){var f=i.for&&e.dependencyParse(i.for);return!i.for||a.name===f.name&&e.versionSatisfies(a.version,f.range)},e.use=function(i,a){if(i.uses=(i.uses||[]).concat(a||[]),i.uses.length===0){o.warn("Plugin.use:",e.toString(i),"does not specify any dependencies to install.");return}for(var f=e.dependencies(i),l=o.topologicalSort(f),c=[],r=0;r<l.length;r+=1)if(l[r]!==i.name){var t=e.resolve(l[r]);if(!t){c.push("âŒ "+l[r]);continue}e.isUsed(i,t.name)||(e.isFor(t,i)||(o.warn("Plugin.use:",e.toString(t),"is for",t.for,"but installed on",e.toString(i)+"."),t._warned=!0),t.install?t.install(i):(o.warn("Plugin.use:",e.toString(t),"does not specify an install function."),t._warned=!0),t._warned?(c.push("ðŸ”¶ "+e.toString(t)),delete t._warned):c.push("âœ… "+e.toString(t)),i.used.push(t.name))}c.length>0&&o.info(c.join("  "))},e.dependencies=function(i,a){var f=e.dependencyParse(i),l=f.name;if(a=a||{},!(l in a)){i=e.resolve(i)||i,a[l]=o.map(i.uses||[],function(r){e.isPlugin(r)&&e.register(r);var t=e.dependencyParse(r),n=e.resolve(r);return n&&!e.versionSatisfies(n.version,t.range)?(o.warn("Plugin.dependencies:",e.toString(n),"does not satisfy",e.toString(t),"used by",e.toString(f)+"."),n._warned=!0,i._warned=!0):n||(o.warn("Plugin.dependencies:",e.toString(r),"used by",e.toString(f),"could not be resolved."),i._warned=!0),t.name});for(var c=0;c<a[l].length;c+=1)e.dependencies(a[l][c],a);return a}},e.dependencyParse=function(i){if(o.isString(i)){var a=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return a.test(i)||o.warn("Plugin.dependencyParse:",i,"is not a valid dependency string."),{name:i.split("@")[0],range:i.split("@")[1]||"*"}}return{name:i.name,range:i.range||i.version}},e.versionParse=function(i){var a=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;a.test(i)||o.warn("Plugin.versionParse:",i,"is not a valid version or range.");var f=a.exec(i),l=Number(f[4]),c=Number(f[5]),r=Number(f[6]);return{isRange:!!(f[1]||f[2]),version:f[3],range:i,operator:f[1]||f[2]||"",major:l,minor:c,patch:r,parts:[l,c,r],prerelease:f[7],number:l*1e8+c*1e4+r}},e.versionSatisfies=function(i,a){a=a||"*";var f=e.versionParse(a),l=e.versionParse(i);if(f.isRange){if(f.operator==="*"||i==="*")return!0;if(f.operator===">")return l.number>f.number;if(f.operator===">=")return l.number>=f.number;if(f.operator==="~")return l.major===f.major&&l.minor===f.minor&&l.patch>=f.patch;if(f.operator==="^")return f.major>0?l.major===f.major&&l.number>=f.number:f.minor>0?l.minor===f.minor&&l.patch>=f.patch:l.patch===f.patch}return i===a||i==="*"}})()},function(p,M){var h={};p.exports=h,function(){h.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}}()},function(p,M,h){var e={};p.exports=e;var o=h(7),i=h(18),a=h(13),f=h(19),l=h(5),c=h(6),r=h(10),t=h(0),n=h(4);(function(){e.create=function(s){s=s||{};var u={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},v=t.extend(u,s);return v.world=s.world||c.create({label:"World"}),v.pairs=s.pairs||f.create(),v.detector=s.detector||a.create(),v.grid={buckets:[]},v.world.gravity=v.gravity,v.broadphase=v.grid,v.metrics={},v},e.update=function(s,u){var v=t.now(),S=s.world,w=s.detector,P=s.pairs,m=s.timing,g=m.timestamp,y;u=typeof u<"u"?u:t._baseDelta,u*=m.timeScale,m.timestamp+=u,m.lastDelta=u;var x={timestamp:m.timestamp,delta:u};l.trigger(s,"beforeUpdate",x);var A=c.allBodies(S),C=c.allConstraints(S);for(S.isModified&&(a.setBodies(w,A),c.setModified(S,!1,!1,!0)),s.enableSleeping&&o.update(A,u),e._bodiesApplyGravity(A,s.gravity),u>0&&e._bodiesUpdate(A,u),r.preSolveAll(A),y=0;y<s.constraintIterations;y++)r.solveAll(C,u);r.postSolveAll(A),w.pairs=s.pairs;var V=a.collisions(w);f.update(P,V,g),s.enableSleeping&&o.afterCollisions(P.list),P.collisionStart.length>0&&l.trigger(s,"collisionStart",{pairs:P.collisionStart});var T=t.clamp(20/s.positionIterations,0,1);for(i.preSolvePosition(P.list),y=0;y<s.positionIterations;y++)i.solvePosition(P.list,u,T);for(i.postSolvePosition(A),r.preSolveAll(A),y=0;y<s.constraintIterations;y++)r.solveAll(C,u);for(r.postSolveAll(A),i.preSolveVelocity(P.list),y=0;y<s.velocityIterations;y++)i.solveVelocity(P.list,u);return e._bodiesUpdateVelocities(A),P.collisionActive.length>0&&l.trigger(s,"collisionActive",{pairs:P.collisionActive}),P.collisionEnd.length>0&&l.trigger(s,"collisionEnd",{pairs:P.collisionEnd}),e._bodiesClearForces(A),l.trigger(s,"afterUpdate",x),s.timing.lastElapsed=t.now()-v,s},e.merge=function(s,u){if(t.extend(s,u),u.world){s.world=u.world,e.clear(s);for(var v=c.allBodies(s.world),S=0;S<v.length;S++){var w=v[S];o.set(w,!1),w.id=t.nextId()}}},e.clear=function(s){f.clear(s.pairs),a.clear(s.detector)},e._bodiesClearForces=function(s){for(var u=s.length,v=0;v<u;v++){var S=s[v];S.force.x=0,S.force.y=0,S.torque=0}},e._bodiesApplyGravity=function(s,u){var v=typeof u.scale<"u"?u.scale:.001,S=s.length;if(!(u.x===0&&u.y===0||v===0))for(var w=0;w<S;w++){var P=s[w];P.isStatic||P.isSleeping||(P.force.y+=P.mass*u.y*v,P.force.x+=P.mass*u.x*v)}},e._bodiesUpdate=function(s,u){for(var v=s.length,S=0;S<v;S++){var w=s[S];w.isStatic||w.isSleeping||n.update(w,u)}},e._bodiesUpdateVelocities=function(s){for(var u=s.length,v=0;v<u;v++)n.updateVelocities(s[v])}})()},function(p,M,h){var e={};p.exports=e;var o=h(3),i=h(0),a=h(1);(function(){e._restingThresh=2,e._restingThreshTangent=Math.sqrt(6),e._positionDampen=.9,e._positionWarming=.8,e._frictionNormalMultiplier=5,e._frictionMaxStatic=Number.MAX_VALUE,e.preSolvePosition=function(f){var l,c,r,t=f.length;for(l=0;l<t;l++)c=f[l],c.isActive&&(r=c.activeContacts.length,c.collision.parentA.totalContacts+=r,c.collision.parentB.totalContacts+=r)},e.solvePosition=function(f,l,c){var r,t,n,s,u,v,S,w,P=e._positionDampen*(c||1),m=i.clamp(l/i._baseDelta,0,1),g=f.length;for(r=0;r<g;r++)t=f[r],!(!t.isActive||t.isSensor)&&(n=t.collision,s=n.parentA,u=n.parentB,v=n.normal,t.separation=v.x*(u.positionImpulse.x+n.penetration.x-s.positionImpulse.x)+v.y*(u.positionImpulse.y+n.penetration.y-s.positionImpulse.y));for(r=0;r<g;r++)t=f[r],!(!t.isActive||t.isSensor)&&(n=t.collision,s=n.parentA,u=n.parentB,v=n.normal,w=t.separation-t.slop*m,(s.isStatic||u.isStatic)&&(w*=2),s.isStatic||s.isSleeping||(S=P/s.totalContacts,s.positionImpulse.x+=v.x*w*S,s.positionImpulse.y+=v.y*w*S),u.isStatic||u.isSleeping||(S=P/u.totalContacts,u.positionImpulse.x-=v.x*w*S,u.positionImpulse.y-=v.y*w*S))},e.postSolvePosition=function(f){for(var l=e._positionWarming,c=f.length,r=o.translate,t=a.update,n=0;n<c;n++){var s=f[n],u=s.positionImpulse,v=u.x,S=u.y,w=s.velocity;if(s.totalContacts=0,v!==0||S!==0){for(var P=0;P<s.parts.length;P++){var m=s.parts[P];r(m.vertices,u),t(m.bounds,m.vertices,w),m.position.x+=v,m.position.y+=S}s.positionPrev.x+=v,s.positionPrev.y+=S,v*w.x+S*w.y<0?(u.x=0,u.y=0):(u.x*=l,u.y*=l)}}},e.preSolveVelocity=function(f){var l=f.length,c,r;for(c=0;c<l;c++){var t=f[c];if(!(!t.isActive||t.isSensor)){var n=t.activeContacts,s=n.length,u=t.collision,v=u.parentA,S=u.parentB,w=u.normal,P=u.tangent;for(r=0;r<s;r++){var m=n[r],g=m.vertex,y=m.normalImpulse,x=m.tangentImpulse;if(y!==0||x!==0){var A=w.x*y+P.x*x,C=w.y*y+P.y*x;v.isStatic||v.isSleeping||(v.positionPrev.x+=A*v.inverseMass,v.positionPrev.y+=C*v.inverseMass,v.anglePrev+=v.inverseInertia*((g.x-v.position.x)*C-(g.y-v.position.y)*A)),S.isStatic||S.isSleeping||(S.positionPrev.x-=A*S.inverseMass,S.positionPrev.y-=C*S.inverseMass,S.anglePrev-=S.inverseInertia*((g.x-S.position.x)*C-(g.y-S.position.y)*A))}}}}},e.solveVelocity=function(f,l){var c=l/i._baseDelta,r=c*c,t=r*c,n=-e._restingThresh*c,s=e._restingThreshTangent,u=e._frictionNormalMultiplier*c,v=e._frictionMaxStatic,S=f.length,w,P,m,g;for(m=0;m<S;m++){var y=f[m];if(!(!y.isActive||y.isSensor)){var x=y.collision,A=x.parentA,C=x.parentB,V=A.velocity,T=C.velocity,I=x.normal.x,F=x.normal.y,R=x.tangent.x,B=x.tangent.y,H=y.activeContacts,L=H.length,O=1/L,W=A.inverseMass+C.inverseMass,N=y.friction*y.frictionStatic*u;for(V.x=A.position.x-A.positionPrev.x,V.y=A.position.y-A.positionPrev.y,T.x=C.position.x-C.positionPrev.x,T.y=C.position.y-C.positionPrev.y,A.angularVelocity=A.angle-A.anglePrev,C.angularVelocity=C.angle-C.anglePrev,g=0;g<L;g++){var D=H[g],G=D.vertex,b=G.x-A.position.x,$=G.y-A.position.y,z=G.x-C.position.x,j=G.y-C.position.y,U=V.x-$*A.angularVelocity,J=V.y+b*A.angularVelocity,X=T.x-j*C.angularVelocity,ee=T.y+z*C.angularVelocity,Y=U-X,se=J-ee,_=I*Y+F*se,Z=R*Y+B*se,Ae=y.separation+_,de=Math.min(Ae,1);de=Ae<0?0:de;var Me=de*N;Z<-Me||Z>Me?(P=Z>0?Z:-Z,w=y.friction*(Z>0?1:-1)*t,w<-P?w=-P:w>P&&(w=P)):(w=Z,P=v);var Te=b*F-$*I,Ve=z*F-j*I,Ee=O/(W+A.inverseInertia*Te*Te+C.inverseInertia*Ve*Ve),ae=(1+y.restitution)*_*Ee;if(w*=Ee,_<n)D.normalImpulse=0;else{var Ge=D.normalImpulse;D.normalImpulse+=ae,D.normalImpulse>0&&(D.normalImpulse=0),ae=D.normalImpulse-Ge}if(Z<-s||Z>s)D.tangentImpulse=0;else{var Ue=D.tangentImpulse;D.tangentImpulse+=w,D.tangentImpulse<-P&&(D.tangentImpulse=-P),D.tangentImpulse>P&&(D.tangentImpulse=P),w=D.tangentImpulse-Ue}var oe=I*ae+R*w,le=F*ae+B*w;A.isStatic||A.isSleeping||(A.positionPrev.x+=oe*A.inverseMass,A.positionPrev.y+=le*A.inverseMass,A.anglePrev+=(b*le-$*oe)*A.inverseInertia),C.isStatic||C.isSleeping||(C.positionPrev.x-=oe*C.inverseMass,C.positionPrev.y-=le*C.inverseMass,C.anglePrev-=(z*le-j*oe)*C.inverseInertia)}}}}})()},function(p,M,h){var e={};p.exports=e;var o=h(9),i=h(0);(function(){e.create=function(a){return i.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},a)},e.update=function(a,f,l){var c=a.list,r=c.length,t=a.table,n=f.length,s=a.collisionStart,u=a.collisionEnd,v=a.collisionActive,S,w,P,m;for(s.length=0,u.length=0,v.length=0,m=0;m<r;m++)c[m].confirmedActive=!1;for(m=0;m<n;m++)S=f[m],P=S.pair,P?(P.isActive?v.push(P):s.push(P),o.update(P,S,l),P.confirmedActive=!0):(P=o.create(S,l),t[P.id]=P,s.push(P),c.push(P));var g=[];for(r=c.length,m=0;m<r;m++)P=c[m],P.confirmedActive||(o.setActive(P,!1,l),u.push(P),!P.collision.bodyA.isSleeping&&!P.collision.bodyB.isSleeping&&g.push(m));for(m=0;m<g.length;m++)w=g[m]-m,P=c[w],c.splice(w,1),delete t[P.id]},e.clear=function(a){return a.table={},a.list.length=0,a.collisionStart.length=0,a.collisionActive.length=0,a.collisionEnd.length=0,a}})()},function(p,M,h){var e=p.exports=h(21);e.Axes=h(11),e.Bodies=h(12),e.Body=h(4),e.Bounds=h(1),e.Collision=h(8),e.Common=h(0),e.Composite=h(6),e.Composites=h(22),e.Constraint=h(10),e.Contact=h(16),e.Detector=h(13),e.Engine=h(17),e.Events=h(5),e.Grid=h(23),e.Mouse=h(14),e.MouseConstraint=h(24),e.Pair=h(9),e.Pairs=h(19),e.Plugin=h(15),e.Query=h(25),e.Render=h(26),e.Resolver=h(18),e.Runner=h(27),e.SAT=h(28),e.Sleeping=h(7),e.Svg=h(29),e.Vector=h(2),e.Vertices=h(3),e.World=h(30),e.Engine.run=e.Runner.run,e.Common.deprecated(e.Engine,"run","Engine.run âž¤ use Matter.Runner.run(engine) instead")},function(p,M,h){var e={};p.exports=e;var o=h(15),i=h(0);(function(){e.name="matter-js",e.version="0.19.0",e.uses=[],e.used=[],e.use=function(){o.use(e,Array.prototype.slice.call(arguments))},e.before=function(a,f){return a=a.replace(/^Matter./,""),i.chainPathBefore(e,a,f)},e.after=function(a,f){return a=a.replace(/^Matter./,""),i.chainPathAfter(e,a,f)}})()},function(p,M,h){var e={};p.exports=e;var o=h(6),i=h(10),a=h(0),f=h(4),l=h(12),c=a.deprecated;(function(){e.stack=function(r,t,n,s,u,v,S){for(var w=o.create({label:"Stack"}),P=r,m=t,g,y=0,x=0;x<s;x++){for(var A=0,C=0;C<n;C++){var V=S(P,m,C,x,g,y);if(V){var T=V.bounds.max.y-V.bounds.min.y,I=V.bounds.max.x-V.bounds.min.x;T>A&&(A=T),f.translate(V,{x:I*.5,y:T*.5}),P=V.bounds.max.x+u,o.addBody(w,V),g=V,y+=1}else P+=u}m+=A+v,P=r}return w},e.chain=function(r,t,n,s,u,v){for(var S=r.bodies,w=1;w<S.length;w++){var P=S[w-1],m=S[w],g=P.bounds.max.y-P.bounds.min.y,y=P.bounds.max.x-P.bounds.min.x,x=m.bounds.max.y-m.bounds.min.y,A=m.bounds.max.x-m.bounds.min.x,C={bodyA:P,pointA:{x:y*t,y:g*n},bodyB:m,pointB:{x:A*s,y:x*u}},V=a.extend(C,v);o.addConstraint(r,i.create(V))}return r.label+=" Chain",r},e.mesh=function(r,t,n,s,u){var v=r.bodies,S,w,P,m,g;for(S=0;S<n;S++){for(w=1;w<t;w++)P=v[w-1+S*t],m=v[w+S*t],o.addConstraint(r,i.create(a.extend({bodyA:P,bodyB:m},u)));if(S>0)for(w=0;w<t;w++)P=v[w+(S-1)*t],m=v[w+S*t],o.addConstraint(r,i.create(a.extend({bodyA:P,bodyB:m},u))),s&&w>0&&(g=v[w-1+(S-1)*t],o.addConstraint(r,i.create(a.extend({bodyA:g,bodyB:m},u)))),s&&w<t-1&&(g=v[w+1+(S-1)*t],o.addConstraint(r,i.create(a.extend({bodyA:g,bodyB:m},u))))}return r.label+=" Mesh",r},e.pyramid=function(r,t,n,s,u,v,S){return e.stack(r,t,n,s,u,v,function(w,P,m,g,y,x){var A=Math.min(s,Math.ceil(n/2)),C=y?y.bounds.max.x-y.bounds.min.x:0;if(!(g>A)){g=A-g;var V=g,T=n-1-g;if(!(m<V||m>T)){x===1&&f.translate(y,{x:(m+(n%2===1?1:-1))*C,y:0});var I=y?m*C:0;return S(r+I+m*u,P,m,g,y,x)}}})},e.newtonsCradle=function(r,t,n,s,u){for(var v=o.create({label:"Newtons Cradle"}),S=0;S<n;S++){var w=1.9,P=l.circle(r+S*(s*w),t+u,s,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),m=i.create({pointA:{x:r+S*(s*w),y:t},bodyB:P});o.addBody(v,P),o.addConstraint(v,m)}return v},c(e,"newtonsCradle","Composites.newtonsCradle âž¤ moved to newtonsCradle example"),e.car=function(r,t,n,s,u){var v=f.nextGroup(!0),S=20,w=-n*.5+S,P=n*.5-S,m=0,g=o.create({label:"Car"}),y=l.rectangle(r,t,n,s,{collisionFilter:{group:v},chamfer:{radius:s*.5},density:2e-4}),x=l.circle(r+w,t+m,u,{collisionFilter:{group:v},friction:.8}),A=l.circle(r+P,t+m,u,{collisionFilter:{group:v},friction:.8}),C=i.create({bodyB:y,pointB:{x:w,y:m},bodyA:x,stiffness:1,length:0}),V=i.create({bodyB:y,pointB:{x:P,y:m},bodyA:A,stiffness:1,length:0});return o.addBody(g,y),o.addBody(g,x),o.addBody(g,A),o.addConstraint(g,C),o.addConstraint(g,V),g},c(e,"car","Composites.car âž¤ moved to car example"),e.softBody=function(r,t,n,s,u,v,S,w,P,m){P=a.extend({inertia:1/0},P),m=a.extend({stiffness:.2,render:{type:"line",anchors:!1}},m);var g=e.stack(r,t,n,s,u,v,function(y,x){return l.circle(y,x,w,P)});return e.mesh(g,n,s,S,m),g.label="Soft Body",g},c(e,"softBody","Composites.softBody âž¤ moved to softBody and cloth examples")})()},function(p,M,h){var e={};p.exports=e;var o=h(9),i=h(0),a=i.deprecated;(function(){e.create=function(f){var l={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return i.extend(l,f)},e.update=function(f,l,c,r){var t,n,s,u=c.world,v=f.buckets,S,w,P=!1;for(t=0;t<l.length;t++){var m=l[t];if(!(m.isSleeping&&!r)&&!(u.bounds&&(m.bounds.max.x<u.bounds.min.x||m.bounds.min.x>u.bounds.max.x||m.bounds.max.y<u.bounds.min.y||m.bounds.min.y>u.bounds.max.y))){var g=e._getRegion(f,m);if(!m.region||g.id!==m.region.id||r){(!m.region||r)&&(m.region=g);var y=e._regionUnion(g,m.region);for(n=y.startCol;n<=y.endCol;n++)for(s=y.startRow;s<=y.endRow;s++){w=e._getBucketId(n,s),S=v[w];var x=n>=g.startCol&&n<=g.endCol&&s>=g.startRow&&s<=g.endRow,A=n>=m.region.startCol&&n<=m.region.endCol&&s>=m.region.startRow&&s<=m.region.endRow;!x&&A&&A&&S&&e._bucketRemoveBody(f,S,m),(m.region===g||x&&!A||r)&&(S||(S=e._createBucket(v,w)),e._bucketAddBody(f,S,m))}m.region=g,P=!0}}}P&&(f.pairsList=e._createActivePairsList(f))},a(e,"update","Grid.update âž¤ replaced by Matter.Detector"),e.clear=function(f){f.buckets={},f.pairs={},f.pairsList=[]},a(e,"clear","Grid.clear âž¤ replaced by Matter.Detector"),e._regionUnion=function(f,l){var c=Math.min(f.startCol,l.startCol),r=Math.max(f.endCol,l.endCol),t=Math.min(f.startRow,l.startRow),n=Math.max(f.endRow,l.endRow);return e._createRegion(c,r,t,n)},e._getRegion=function(f,l){var c=l.bounds,r=Math.floor(c.min.x/f.bucketWidth),t=Math.floor(c.max.x/f.bucketWidth),n=Math.floor(c.min.y/f.bucketHeight),s=Math.floor(c.max.y/f.bucketHeight);return e._createRegion(r,t,n,s)},e._createRegion=function(f,l,c,r){return{id:f+","+l+","+c+","+r,startCol:f,endCol:l,startRow:c,endRow:r}},e._getBucketId=function(f,l){return"C"+f+"R"+l},e._createBucket=function(f,l){var c=f[l]=[];return c},e._bucketAddBody=function(f,l,c){var r=f.pairs,t=o.id,n=l.length,s;for(s=0;s<n;s++){var u=l[s];if(!(c.id===u.id||c.isStatic&&u.isStatic)){var v=t(c,u),S=r[v];S?S[2]+=1:r[v]=[c,u,1]}}l.push(c)},e._bucketRemoveBody=function(f,l,c){var r=f.pairs,t=o.id,n;l.splice(i.indexOf(l,c),1);var s=l.length;for(n=0;n<s;n++){var u=r[t(c,l[n])];u&&(u[2]-=1)}},e._createActivePairsList=function(f){var l,c=f.pairs,r=i.keys(c),t=r.length,n=[],s;for(s=0;s<t;s++)l=c[r[s]],l[2]>0?n.push(l):delete c[r[s]];return n}})()},function(p,M,h){var e={};p.exports=e;var o=h(3),i=h(7),a=h(14),f=h(5),l=h(13),c=h(10),r=h(6),t=h(0),n=h(1);(function(){e.create=function(s,u){var v=(s?s.mouse:null)||(u?u.mouse:null);v||(s&&s.render&&s.render.canvas?v=a.create(s.render.canvas):u&&u.element?v=a.create(u.element):(v=a.create(),t.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var S=c.create({label:"Mouse Constraint",pointA:v.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),w={type:"mouseConstraint",mouse:v,element:null,body:null,constraint:S,collisionFilter:{category:1,mask:4294967295,group:0}},P=t.extend(w,u);return f.on(s,"beforeUpdate",function(){var m=r.allBodies(s.world);e.update(P,m),e._triggerEvents(P)}),P},e.update=function(s,u){var v=s.mouse,S=s.constraint,w=s.body;if(v.button===0){if(S.bodyB)i.set(S.bodyB,!1),S.pointA=v.position;else for(var P=0;P<u.length;P++)if(w=u[P],n.contains(w.bounds,v.position)&&l.canCollide(w.collisionFilter,s.collisionFilter))for(var m=w.parts.length>1?1:0;m<w.parts.length;m++){var g=w.parts[m];if(o.contains(g.vertices,v.position)){S.pointA=v.position,S.bodyB=s.body=w,S.pointB={x:v.position.x-w.position.x,y:v.position.y-w.position.y},S.angleB=w.angle,i.set(w,!1),f.trigger(s,"startdrag",{mouse:v,body:w});break}}}else S.bodyB=s.body=null,S.pointB=null,w&&f.trigger(s,"enddrag",{mouse:v,body:w})},e._triggerEvents=function(s){var u=s.mouse,v=u.sourceEvents;v.mousemove&&f.trigger(s,"mousemove",{mouse:u}),v.mousedown&&f.trigger(s,"mousedown",{mouse:u}),v.mouseup&&f.trigger(s,"mouseup",{mouse:u}),a.clearSourceEvents(u)}})()},function(p,M,h){var e={};p.exports=e;var o=h(2),i=h(8),a=h(1),f=h(12),l=h(3);(function(){e.collides=function(c,r){for(var t=[],n=r.length,s=c.bounds,u=i.collides,v=a.overlaps,S=0;S<n;S++){var w=r[S],P=w.parts.length,m=P===1?0:1;if(v(w.bounds,s))for(var g=m;g<P;g++){var y=w.parts[g];if(v(y.bounds,s)){var x=u(y,c);if(x){t.push(x);break}}}}return t},e.ray=function(c,r,t,n){n=n||1e-100;for(var s=o.angle(r,t),u=o.magnitude(o.sub(r,t)),v=(t.x+r.x)*.5,S=(t.y+r.y)*.5,w=f.rectangle(v,S,u,n,{angle:s}),P=e.collides(w,c),m=0;m<P.length;m+=1){var g=P[m];g.body=g.bodyB=g.bodyA}return P},e.region=function(c,r,t){for(var n=[],s=0;s<c.length;s++){var u=c[s],v=a.overlaps(u.bounds,r);(v&&!t||!v&&t)&&n.push(u)}return n},e.point=function(c,r){for(var t=[],n=0;n<c.length;n++){var s=c[n];if(a.contains(s.bounds,r))for(var u=s.parts.length===1?0:1;u<s.parts.length;u++){var v=s.parts[u];if(a.contains(v.bounds,r)&&l.contains(v.vertices,r)){t.push(s);break}}}return t}})()},function(p,M,h){var e={};p.exports=e;var o=h(4),i=h(0),a=h(6),f=h(1),l=h(5),c=h(2),r=h(14);(function(){var t,n;typeof window<"u"&&(t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(m){window.setTimeout(function(){m(i.now())},1e3/60)},n=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),e._goodFps=30,e._goodDelta=1e3/60,e.create=function(m){var g={engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!m.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},y=i.extend(g,m);return y.canvas&&(y.canvas.width=y.options.width||y.canvas.width,y.canvas.height=y.options.height||y.canvas.height),y.mouse=m.mouse,y.engine=m.engine,y.canvas=y.canvas||v(y.options.width,y.options.height),y.context=y.canvas.getContext("2d"),y.textures={},y.bounds=y.bounds||{min:{x:0,y:0},max:{x:y.canvas.width,y:y.canvas.height}},y.controller=e,y.options.showBroadphase=!1,y.options.pixelRatio!==1&&e.setPixelRatio(y,y.options.pixelRatio),i.isElement(y.element)&&y.element.appendChild(y.canvas),y},e.run=function(m){(function g(y){m.frameRequestId=t(g),s(m,y),e.world(m,y),(m.options.showStats||m.options.showDebug)&&e.stats(m,m.context,y),(m.options.showPerformance||m.options.showDebug)&&e.performance(m,m.context,y)})()},e.stop=function(m){n(m.frameRequestId)},e.setPixelRatio=function(m,g){var y=m.options,x=m.canvas;g==="auto"&&(g=S(x)),y.pixelRatio=g,x.setAttribute("data-pixel-ratio",g),x.width=y.width*g,x.height=y.height*g,x.style.width=y.width+"px",x.style.height=y.height+"px"},e.lookAt=function(m,g,y,x){x=typeof x<"u"?x:!0,g=i.isArray(g)?g:[g],y=y||{x:0,y:0};for(var A={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},C=0;C<g.length;C+=1){var V=g[C],T=V.bounds?V.bounds.min:V.min||V.position||V,I=V.bounds?V.bounds.max:V.max||V.position||V;T&&I&&(T.x<A.min.x&&(A.min.x=T.x),I.x>A.max.x&&(A.max.x=I.x),T.y<A.min.y&&(A.min.y=T.y),I.y>A.max.y&&(A.max.y=I.y))}var F=A.max.x-A.min.x+2*y.x,R=A.max.y-A.min.y+2*y.y,B=m.canvas.height,H=m.canvas.width,L=H/B,O=F/R,W=1,N=1;O>L?N=O/L:W=L/O,m.options.hasBounds=!0,m.bounds.min.x=A.min.x,m.bounds.max.x=A.min.x+F*W,m.bounds.min.y=A.min.y,m.bounds.max.y=A.min.y+R*N,x&&(m.bounds.min.x+=F*.5-F*W*.5,m.bounds.max.x+=F*.5-F*W*.5,m.bounds.min.y+=R*.5-R*N*.5,m.bounds.max.y+=R*.5-R*N*.5),m.bounds.min.x-=y.x,m.bounds.max.x-=y.x,m.bounds.min.y-=y.y,m.bounds.max.y-=y.y,m.mouse&&(r.setScale(m.mouse,{x:(m.bounds.max.x-m.bounds.min.x)/m.canvas.width,y:(m.bounds.max.y-m.bounds.min.y)/m.canvas.height}),r.setOffset(m.mouse,m.bounds.min))},e.startViewTransform=function(m){var g=m.bounds.max.x-m.bounds.min.x,y=m.bounds.max.y-m.bounds.min.y,x=g/m.options.width,A=y/m.options.height;m.context.setTransform(m.options.pixelRatio/x,0,0,m.options.pixelRatio/A,0,0),m.context.translate(-m.bounds.min.x,-m.bounds.min.y)},e.endViewTransform=function(m){m.context.setTransform(m.options.pixelRatio,0,0,m.options.pixelRatio,0,0)},e.world=function(m,g){var y=i.now(),x=m.engine,A=x.world,C=m.canvas,V=m.context,T=m.options,I=m.timing,F=a.allBodies(A),R=a.allConstraints(A),B=T.wireframes?T.wireframeBackground:T.background,H=[],L=[],O,W={timestamp:x.timing.timestamp};if(l.trigger(m,"beforeRender",W),m.currentBackground!==B&&P(m,B),V.globalCompositeOperation="source-in",V.fillStyle="transparent",V.fillRect(0,0,C.width,C.height),V.globalCompositeOperation="source-over",T.hasBounds){for(O=0;O<F.length;O++){var N=F[O];f.overlaps(N.bounds,m.bounds)&&H.push(N)}for(O=0;O<R.length;O++){var D=R[O],G=D.bodyA,b=D.bodyB,$=D.pointA,z=D.pointB;G&&($=c.add(G.position,D.pointA)),b&&(z=c.add(b.position,D.pointB)),!(!$||!z)&&(f.contains(m.bounds,$)||f.contains(m.bounds,z))&&L.push(D)}e.startViewTransform(m),m.mouse&&(r.setScale(m.mouse,{x:(m.bounds.max.x-m.bounds.min.x)/m.options.width,y:(m.bounds.max.y-m.bounds.min.y)/m.options.height}),r.setOffset(m.mouse,m.bounds.min))}else L=R,H=F,m.options.pixelRatio!==1&&m.context.setTransform(m.options.pixelRatio,0,0,m.options.pixelRatio,0,0);!T.wireframes||x.enableSleeping&&T.showSleeping?e.bodies(m,H,V):(T.showConvexHulls&&e.bodyConvexHulls(m,H,V),e.bodyWireframes(m,H,V)),T.showBounds&&e.bodyBounds(m,H,V),(T.showAxes||T.showAngleIndicator)&&e.bodyAxes(m,H,V),T.showPositions&&e.bodyPositions(m,H,V),T.showVelocity&&e.bodyVelocity(m,H,V),T.showIds&&e.bodyIds(m,H,V),T.showSeparations&&e.separations(m,x.pairs.list,V),T.showCollisions&&e.collisions(m,x.pairs.list,V),T.showVertexNumbers&&e.vertexNumbers(m,H,V),T.showMousePosition&&e.mousePosition(m,m.mouse,V),e.constraints(L,V),T.hasBounds&&e.endViewTransform(m),l.trigger(m,"afterRender",W),I.lastElapsed=i.now()-y},e.stats=function(m,g,y){for(var x=m.engine,A=x.world,C=a.allBodies(A),V=0,T=55,I=44,F=0,R=0,B=0;B<C.length;B+=1)V+=C[B].parts.length;var H={Part:V,Body:C.length,Cons:a.allConstraints(A).length,Comp:a.allComposites(A).length,Pair:x.pairs.list.length};g.fillStyle="#0e0f19",g.fillRect(F,R,T*5.5,I),g.font="12px Arial",g.textBaseline="top",g.textAlign="right";for(var L in H){var O=H[L];g.fillStyle="#aaa",g.fillText(L,F+T,R+8),g.fillStyle="#eee",g.fillText(O,F+T,R+26),F+=T}},e.performance=function(m,g){var y=m.engine,x=m.timing,A=x.deltaHistory,C=x.elapsedHistory,V=x.timestampElapsedHistory,T=x.engineDeltaHistory,I=x.engineElapsedHistory,F=y.timing.lastDelta,R=u(A),B=u(C),H=u(T),L=u(I),O=u(V),W=O/R||0,N=1e3/R||0,D=4,G=12,b=60,$=34,z=10,j=69;g.fillStyle="#0e0f19",g.fillRect(0,50,G*4+b*5+22,$),e.status(g,z,j,b,D,A.length,Math.round(N)+" fps",N/e._goodFps,function(U){return A[U]/R-1}),e.status(g,z+G+b,j,b,D,T.length,F.toFixed(2)+" dt",e._goodDelta/F,function(U){return T[U]/H-1}),e.status(g,z+(G+b)*2,j,b,D,I.length,L.toFixed(2)+" ut",1-L/e._goodFps,function(U){return I[U]/L-1}),e.status(g,z+(G+b)*3,j,b,D,C.length,B.toFixed(2)+" rt",1-B/e._goodFps,function(U){return C[U]/B-1}),e.status(g,z+(G+b)*4,j,b,D,V.length,W.toFixed(2)+" x",W*W*W,function(U){return(V[U]/A[U]/W||0)-1})},e.status=function(m,g,y,x,A,C,V,T,I){m.strokeStyle="#888",m.fillStyle="#444",m.lineWidth=1,m.fillRect(g,y+7,x,1),m.beginPath(),m.moveTo(g,y+7-A*i.clamp(.4*I(0),-2,2));for(var F=0;F<x;F+=1)m.lineTo(g+F,y+7-(F<C?A*i.clamp(.4*I(F),-2,2):0));m.stroke(),m.fillStyle="hsl("+i.clamp(25+95*T,0,120)+",100%,60%)",m.fillRect(g,y-7,4,4),m.font="12px Arial",m.textBaseline="middle",m.textAlign="right",m.fillStyle="#eee",m.fillText(V,g+x,y-5)},e.constraints=function(m,g){for(var y=g,x=0;x<m.length;x++){var A=m[x];if(!(!A.render.visible||!A.pointA||!A.pointB)){var C=A.bodyA,V=A.bodyB,T,I;if(C?T=c.add(C.position,A.pointA):T=A.pointA,A.render.type==="pin")y.beginPath(),y.arc(T.x,T.y,3,0,2*Math.PI),y.closePath();else{if(V?I=c.add(V.position,A.pointB):I=A.pointB,y.beginPath(),y.moveTo(T.x,T.y),A.render.type==="spring")for(var F=c.sub(I,T),R=c.perp(c.normalise(F)),B=Math.ceil(i.clamp(A.length/5,12,20)),H,L=1;L<B;L+=1)H=L%2===0?1:-1,y.lineTo(T.x+F.x*(L/B)+R.x*H*4,T.y+F.y*(L/B)+R.y*H*4);y.lineTo(I.x,I.y)}A.render.lineWidth&&(y.lineWidth=A.render.lineWidth,y.strokeStyle=A.render.strokeStyle,y.stroke()),A.render.anchors&&(y.fillStyle=A.render.strokeStyle,y.beginPath(),y.arc(T.x,T.y,3,0,2*Math.PI),y.arc(I.x,I.y,3,0,2*Math.PI),y.closePath(),y.fill())}}},e.bodies=function(m,g,y){var x=y;m.engine;var A=m.options,C=A.showInternalEdges||!A.wireframes,V,T,I,F;for(I=0;I<g.length;I++)if(V=g[I],!!V.render.visible){for(F=V.parts.length>1?1:0;F<V.parts.length;F++)if(T=V.parts[F],!!T.render.visible){if(A.showSleeping&&V.isSleeping?x.globalAlpha=.5*T.render.opacity:T.render.opacity!==1&&(x.globalAlpha=T.render.opacity),T.render.sprite&&T.render.sprite.texture&&!A.wireframes){var R=T.render.sprite,B=w(m,R.texture);x.translate(T.position.x,T.position.y),x.rotate(T.angle),x.drawImage(B,B.width*-R.xOffset*R.xScale,B.height*-R.yOffset*R.yScale,B.width*R.xScale,B.height*R.yScale),x.rotate(-T.angle),x.translate(-T.position.x,-T.position.y)}else{if(T.circleRadius)x.beginPath(),x.arc(T.position.x,T.position.y,T.circleRadius,0,2*Math.PI);else{x.beginPath(),x.moveTo(T.vertices[0].x,T.vertices[0].y);for(var H=1;H<T.vertices.length;H++)!T.vertices[H-1].isInternal||C?x.lineTo(T.vertices[H].x,T.vertices[H].y):x.moveTo(T.vertices[H].x,T.vertices[H].y),T.vertices[H].isInternal&&!C&&x.moveTo(T.vertices[(H+1)%T.vertices.length].x,T.vertices[(H+1)%T.vertices.length].y);x.lineTo(T.vertices[0].x,T.vertices[0].y),x.closePath()}A.wireframes?(x.lineWidth=1,x.strokeStyle="#bbb",x.stroke()):(x.fillStyle=T.render.fillStyle,T.render.lineWidth&&(x.lineWidth=T.render.lineWidth,x.strokeStyle=T.render.strokeStyle,x.stroke()),x.fill())}x.globalAlpha=1}}},e.bodyWireframes=function(m,g,y){var x=y,A=m.options.showInternalEdges,C,V,T,I,F;for(x.beginPath(),T=0;T<g.length;T++)if(C=g[T],!!C.render.visible)for(F=C.parts.length>1?1:0;F<C.parts.length;F++){for(V=C.parts[F],x.moveTo(V.vertices[0].x,V.vertices[0].y),I=1;I<V.vertices.length;I++)!V.vertices[I-1].isInternal||A?x.lineTo(V.vertices[I].x,V.vertices[I].y):x.moveTo(V.vertices[I].x,V.vertices[I].y),V.vertices[I].isInternal&&!A&&x.moveTo(V.vertices[(I+1)%V.vertices.length].x,V.vertices[(I+1)%V.vertices.length].y);x.lineTo(V.vertices[0].x,V.vertices[0].y)}x.lineWidth=1,x.strokeStyle="#bbb",x.stroke()},e.bodyConvexHulls=function(m,g,y){var x=y,A,C,V;for(x.beginPath(),C=0;C<g.length;C++)if(A=g[C],!(!A.render.visible||A.parts.length===1)){for(x.moveTo(A.vertices[0].x,A.vertices[0].y),V=1;V<A.vertices.length;V++)x.lineTo(A.vertices[V].x,A.vertices[V].y);x.lineTo(A.vertices[0].x,A.vertices[0].y)}x.lineWidth=1,x.strokeStyle="rgba(255,255,255,0.2)",x.stroke()},e.vertexNumbers=function(m,g,y){var x=y,A,C,V;for(A=0;A<g.length;A++){var T=g[A].parts;for(V=T.length>1?1:0;V<T.length;V++){var I=T[V];for(C=0;C<I.vertices.length;C++)x.fillStyle="rgba(255,255,255,0.2)",x.fillText(A+"_"+C,I.position.x+(I.vertices[C].x-I.position.x)*.8,I.position.y+(I.vertices[C].y-I.position.y)*.8)}}},e.mousePosition=function(m,g,y){var x=y;x.fillStyle="rgba(255,255,255,0.8)",x.fillText(g.position.x+"  "+g.position.y,g.position.x+5,g.position.y-5)},e.bodyBounds=function(m,g,y){var x=y;m.engine;var A=m.options;x.beginPath();for(var C=0;C<g.length;C++){var V=g[C];if(V.render.visible)for(var T=g[C].parts,I=T.length>1?1:0;I<T.length;I++){var F=T[I];x.rect(F.bounds.min.x,F.bounds.min.y,F.bounds.max.x-F.bounds.min.x,F.bounds.max.y-F.bounds.min.y)}}A.wireframes?x.strokeStyle="rgba(255,255,255,0.08)":x.strokeStyle="rgba(0,0,0,0.1)",x.lineWidth=1,x.stroke()},e.bodyAxes=function(m,g,y){var x=y;m.engine;var A=m.options,C,V,T,I;for(x.beginPath(),V=0;V<g.length;V++){var F=g[V],R=F.parts;if(F.render.visible)if(A.showAxes)for(T=R.length>1?1:0;T<R.length;T++)for(C=R[T],I=0;I<C.axes.length;I++){var B=C.axes[I];x.moveTo(C.position.x,C.position.y),x.lineTo(C.position.x+B.x*20,C.position.y+B.y*20)}else for(T=R.length>1?1:0;T<R.length;T++)for(C=R[T],I=0;I<C.axes.length;I++)x.moveTo(C.position.x,C.position.y),x.lineTo((C.vertices[0].x+C.vertices[C.vertices.length-1].x)/2,(C.vertices[0].y+C.vertices[C.vertices.length-1].y)/2)}A.wireframes?(x.strokeStyle="indianred",x.lineWidth=1):(x.strokeStyle="rgba(255, 255, 255, 0.4)",x.globalCompositeOperation="overlay",x.lineWidth=2),x.stroke(),x.globalCompositeOperation="source-over"},e.bodyPositions=function(m,g,y){var x=y;m.engine;var A=m.options,C,V,T,I;for(x.beginPath(),T=0;T<g.length;T++)if(C=g[T],!!C.render.visible)for(I=0;I<C.parts.length;I++)V=C.parts[I],x.arc(V.position.x,V.position.y,3,0,2*Math.PI,!1),x.closePath();for(A.wireframes?x.fillStyle="indianred":x.fillStyle="rgba(0,0,0,0.5)",x.fill(),x.beginPath(),T=0;T<g.length;T++)C=g[T],C.render.visible&&(x.arc(C.positionPrev.x,C.positionPrev.y,2,0,2*Math.PI,!1),x.closePath());x.fillStyle="rgba(255,165,0,0.8)",x.fill()},e.bodyVelocity=function(m,g,y){var x=y;x.beginPath();for(var A=0;A<g.length;A++){var C=g[A];if(C.render.visible){var V=o.getVelocity(C);x.moveTo(C.position.x,C.position.y),x.lineTo(C.position.x+V.x,C.position.y+V.y)}}x.lineWidth=3,x.strokeStyle="cornflowerblue",x.stroke()},e.bodyIds=function(m,g,y){var x=y,A,C;for(A=0;A<g.length;A++)if(g[A].render.visible){var V=g[A].parts;for(C=V.length>1?1:0;C<V.length;C++){var T=V[C];x.font="12px Arial",x.fillStyle="rgba(255,255,255,0.5)",x.fillText(T.id,T.position.x+10,T.position.y-10)}}},e.collisions=function(m,g,y){var x=y,A=m.options,C,V,T,I;for(x.beginPath(),T=0;T<g.length;T++)if(C=g[T],!!C.isActive)for(V=C.collision,I=0;I<C.activeContacts.length;I++){var F=C.activeContacts[I],R=F.vertex;x.rect(R.x-1.5,R.y-1.5,3.5,3.5)}for(A.wireframes?x.fillStyle="rgba(255,255,255,0.7)":x.fillStyle="orange",x.fill(),x.beginPath(),T=0;T<g.length;T++)if(C=g[T],!!C.isActive&&(V=C.collision,C.activeContacts.length>0)){var B=C.activeContacts[0].vertex.x,H=C.activeContacts[0].vertex.y;C.activeContacts.length===2&&(B=(C.activeContacts[0].vertex.x+C.activeContacts[1].vertex.x)/2,H=(C.activeContacts[0].vertex.y+C.activeContacts[1].vertex.y)/2),V.bodyB===V.supports[0].body||V.bodyA.isStatic===!0?x.moveTo(B-V.normal.x*8,H-V.normal.y*8):x.moveTo(B+V.normal.x*8,H+V.normal.y*8),x.lineTo(B,H)}A.wireframes?x.strokeStyle="rgba(255,165,0,0.7)":x.strokeStyle="orange",x.lineWidth=1,x.stroke()},e.separations=function(m,g,y){var x=y,A=m.options,C,V,T,I,F;for(x.beginPath(),F=0;F<g.length;F++)if(C=g[F],!!C.isActive){V=C.collision,T=V.bodyA,I=V.bodyB;var R=1;!I.isStatic&&!T.isStatic&&(R=.5),I.isStatic&&(R=0),x.moveTo(I.position.x,I.position.y),x.lineTo(I.position.x-V.penetration.x*R,I.position.y-V.penetration.y*R),R=1,!I.isStatic&&!T.isStatic&&(R=.5),T.isStatic&&(R=0),x.moveTo(T.position.x,T.position.y),x.lineTo(T.position.x+V.penetration.x*R,T.position.y+V.penetration.y*R)}A.wireframes?x.strokeStyle="rgba(255,165,0,0.5)":x.strokeStyle="orange",x.stroke()},e.inspector=function(m,g){m.engine;var y=m.selected,x=m.render,A=x.options,C;if(A.hasBounds){var V=x.bounds.max.x-x.bounds.min.x,T=x.bounds.max.y-x.bounds.min.y,I=V/x.options.width,F=T/x.options.height;g.scale(1/I,1/F),g.translate(-x.bounds.min.x,-x.bounds.min.y)}for(var R=0;R<y.length;R++){var B=y[R].data;switch(g.translate(.5,.5),g.lineWidth=1,g.strokeStyle="rgba(255,165,0,0.9)",g.setLineDash([1,2]),B.type){case"body":C=B.bounds,g.beginPath(),g.rect(Math.floor(C.min.x-3),Math.floor(C.min.y-3),Math.floor(C.max.x-C.min.x+6),Math.floor(C.max.y-C.min.y+6)),g.closePath(),g.stroke();break;case"constraint":var H=B.pointA;B.bodyA&&(H=B.pointB),g.beginPath(),g.arc(H.x,H.y,10,0,2*Math.PI),g.closePath(),g.stroke();break}g.setLineDash([]),g.translate(-.5,-.5)}m.selectStart!==null&&(g.translate(.5,.5),g.lineWidth=1,g.strokeStyle="rgba(255,165,0,0.6)",g.fillStyle="rgba(255,165,0,0.1)",C=m.selectBounds,g.beginPath(),g.rect(Math.floor(C.min.x),Math.floor(C.min.y),Math.floor(C.max.x-C.min.x),Math.floor(C.max.y-C.min.y)),g.closePath(),g.stroke(),g.fill(),g.translate(-.5,-.5)),A.hasBounds&&g.setTransform(1,0,0,1,0,0)};var s=function(m,g){var y=m.engine,x=m.timing,A=x.historySize,C=y.timing.timestamp;x.delta=g-x.lastTime||e._goodDelta,x.lastTime=g,x.timestampElapsed=C-x.lastTimestamp||0,x.lastTimestamp=C,x.deltaHistory.unshift(x.delta),x.deltaHistory.length=Math.min(x.deltaHistory.length,A),x.engineDeltaHistory.unshift(y.timing.lastDelta),x.engineDeltaHistory.length=Math.min(x.engineDeltaHistory.length,A),x.timestampElapsedHistory.unshift(x.timestampElapsed),x.timestampElapsedHistory.length=Math.min(x.timestampElapsedHistory.length,A),x.engineElapsedHistory.unshift(y.timing.lastElapsed),x.engineElapsedHistory.length=Math.min(x.engineElapsedHistory.length,A),x.elapsedHistory.unshift(x.lastElapsed),x.elapsedHistory.length=Math.min(x.elapsedHistory.length,A)},u=function(m){for(var g=0,y=0;y<m.length;y+=1)g+=m[y];return g/m.length||0},v=function(m,g){var y=document.createElement("canvas");return y.width=m,y.height=g,y.oncontextmenu=function(){return!1},y.onselectstart=function(){return!1},y},S=function(m){var g=m.getContext("2d"),y=window.devicePixelRatio||1,x=g.webkitBackingStorePixelRatio||g.mozBackingStorePixelRatio||g.msBackingStorePixelRatio||g.oBackingStorePixelRatio||g.backingStorePixelRatio||1;return y/x},w=function(m,g){var y=m.textures[g];return y||(y=m.textures[g]=new Image,y.src=g,y)},P=function(m,g){var y=g;/(jpg|gif|png)$/.test(g)&&(y="url("+g+")"),m.canvas.style.background=y,m.canvas.style.backgroundSize="contain",m.currentBackground=g}})()},function(p,M,h){var e={};p.exports=e;var o=h(5),i=h(17),a=h(0);(function(){var f,l;if(typeof window<"u"&&(f=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,l=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!f){var c;f=function(r){c=setTimeout(function(){r(a.now())},1e3/60)},l=function(){clearTimeout(c)}}e.create=function(r){var t={fps:60,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,frameRequestId:null,isFixed:!1,enabled:!0},n=a.extend(t,r);return n.delta=n.delta||1e3/n.fps,n.deltaMin=n.deltaMin||1e3/n.fps,n.deltaMax=n.deltaMax||1e3/(n.fps*.5),n.fps=1e3/n.delta,n},e.run=function(r,t){return typeof r.positionIterations<"u"&&(t=r,r=e.create()),function n(s){r.frameRequestId=f(n),s&&r.enabled&&e.tick(r,t,s)}(),r},e.tick=function(r,t,n){var s=t.timing,u;r.isFixed?u=r.delta:(u=n-r.timePrev||r.delta,r.timePrev=n,r.deltaHistory.push(u),r.deltaHistory=r.deltaHistory.slice(-r.deltaSampleSize),u=Math.min.apply(null,r.deltaHistory),u=u<r.deltaMin?r.deltaMin:u,u=u>r.deltaMax?r.deltaMax:u,r.delta=u);var v={timestamp:s.timestamp};o.trigger(r,"beforeTick",v),r.frameCounter+=1,n-r.counterTimestamp>=1e3&&(r.fps=r.frameCounter*((n-r.counterTimestamp)/1e3),r.counterTimestamp=n,r.frameCounter=0),o.trigger(r,"tick",v),o.trigger(r,"beforeUpdate",v),i.update(t,u),o.trigger(r,"afterUpdate",v),o.trigger(r,"afterTick",v)},e.stop=function(r){l(r.frameRequestId)},e.start=function(r,t){e.run(r,t)}})()},function(p,M,h){var e={};p.exports=e;var o=h(8),i=h(0),a=i.deprecated;(function(){e.collides=function(f,l){return o.collides(f,l)},a(e,"collides","SAT.collides âž¤ replaced by Collision.collides")})()},function(p,M,h){var e={};p.exports=e,h(1);var o=h(0);(function(){e.pathToVertices=function(i,a){typeof window<"u"&&!("SVGPathSeg"in window)&&o.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var f,l,c,r,t,n,s,u,v,S,w=[],P,m,g=0,y=0,x=0;a=a||15;var A=function(V,T,I){var F=I%2===1&&I>1;if(!v||V!=v.x||T!=v.y){v&&F?(P=v.x,m=v.y):(P=0,m=0);var R={x:P+V,y:m+T};(F||!v)&&(v=R),w.push(R),y=P+V,x=m+T}},C=function(V){var T=V.pathSegTypeAsLetter.toUpperCase();if(T!=="Z"){switch(T){case"M":case"L":case"T":case"C":case"S":case"Q":y=V.x,x=V.y;break;case"H":y=V.x;break;case"V":x=V.y;break}A(y,x,V.pathSegType)}};for(e._svgPathToAbsolute(i),c=i.getTotalLength(),n=[],f=0;f<i.pathSegList.numberOfItems;f+=1)n.push(i.pathSegList.getItem(f));for(s=n.concat();g<c;){if(S=i.getPathSegAtLength(g),t=n[S],t!=u){for(;s.length&&s[0]!=t;)C(s.shift());u=t}switch(t.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":r=i.getPointAtLength(g),A(r.x,r.y,0);break}g+=a}for(f=0,l=s.length;f<l;++f)C(s[f]);return w},e._svgPathToAbsolute=function(i){for(var a,f,l,c,r,t,n=i.pathSegList,s=0,u=0,v=n.numberOfItems,S=0;S<v;++S){var w=n.getItem(S),P=w.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(P))"x"in w&&(s=w.x),"y"in w&&(u=w.y);else switch("x1"in w&&(l=s+w.x1),"x2"in w&&(r=s+w.x2),"y1"in w&&(c=u+w.y1),"y2"in w&&(t=u+w.y2),"x"in w&&(s+=w.x),"y"in w&&(u+=w.y),P){case"m":n.replaceItem(i.createSVGPathSegMovetoAbs(s,u),S);break;case"l":n.replaceItem(i.createSVGPathSegLinetoAbs(s,u),S);break;case"h":n.replaceItem(i.createSVGPathSegLinetoHorizontalAbs(s),S);break;case"v":n.replaceItem(i.createSVGPathSegLinetoVerticalAbs(u),S);break;case"c":n.replaceItem(i.createSVGPathSegCurvetoCubicAbs(s,u,l,c,r,t),S);break;case"s":n.replaceItem(i.createSVGPathSegCurvetoCubicSmoothAbs(s,u,r,t),S);break;case"q":n.replaceItem(i.createSVGPathSegCurvetoQuadraticAbs(s,u,l,c),S);break;case"t":n.replaceItem(i.createSVGPathSegCurvetoQuadraticSmoothAbs(s,u),S);break;case"a":n.replaceItem(i.createSVGPathSegArcAbs(s,u,w.r1,w.r2,w.angle,w.largeArcFlag,w.sweepFlag),S);break;case"z":case"Z":s=a,u=f;break}(P=="M"||P=="m")&&(a=s,f=u)}}})()},function(p,M,h){var e={};p.exports=e;var o=h(6);h(0),function(){e.create=o.create,e.add=o.add,e.remove=o.remove,e.clear=o.clear,e.addComposite=o.addComposite,e.addBody=o.addBody,e.addConstraint=o.addConstraint}()}])})})(ht);export{ft as A,K as C,Xe as E,St as a,lt as b,dt as c,xt as d,gt as e,pt as f,yt as i,te as l};
