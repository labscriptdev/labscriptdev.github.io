import{V as z,a as $,a5 as H,O as j,Z as G,ap as V,M as B,aG as F,J as X,d as q,P as U,S as Q,W as T,ay as J,aC as K,m as ee}from"./three.module.6da1ccc8.js";import{l as M,n as Y,o as R,e as P,y as Z,V as te,f as ne,E as se,a as g,g as re,b as w,w as S,t as oe,x as ie,F as le,q as x}from"./entry.43339234.js";const A=new z,ae=new H,I=new z;class de extends j{constructor(l=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=l,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",function(){this.traverse(function(o){o.element instanceof Element&&o.element.parentNode!==null&&o.element.parentNode.removeChild(o.element)})})}copy(l,o){return super.copy(l,o),this.element=l.element.cloneNode(!0),this}}const y=new $,ce=new $;class he{constructor(l={}){const o=this;let n,h,a,c;const m={camera:{style:""},objects:new WeakMap},d=l.element!==void 0?l.element:document.createElement("div");d.style.overflow="hidden",this.domElement=d;const r=document.createElement("div");r.style.transformOrigin="0 0",r.style.pointerEvents="none",d.appendChild(r);const i=document.createElement("div");i.style.transformStyle="preserve-3d",r.appendChild(i),this.getSize=function(){return{width:n,height:h}},this.render=function(s,e){const p=e.projectionMatrix.elements[5]*c;e.view&&e.view.enabled?(r.style.transform=`translate( ${-e.view.offsetX*(n/e.view.width)}px, ${-e.view.offsetY*(h/e.view.height)}px )`,r.style.transform+=`scale( ${e.view.fullWidth/e.view.width}, ${e.view.fullHeight/e.view.height} )`):r.style.transform="",s.matrixWorldAutoUpdate===!0&&s.updateMatrixWorld(),e.parent===null&&e.matrixWorldAutoUpdate===!0&&e.updateMatrixWorld();let L,v;e.isOrthographicCamera&&(L=-(e.right+e.left)/2,v=(e.top+e.bottom)/2);const f=e.view&&e.view.enabled?e.view.height/e.view.fullHeight:1,b=e.isOrthographicCamera?`scale( ${f} )scale(`+p+")translate("+t(L)+"px,"+t(v)+"px)"+C(e.matrixWorldInverse):`scale( ${f} )translateZ(`+p+"px)"+C(e.matrixWorldInverse),E=(e.isPerspectiveCamera?"perspective("+p+"px) ":"")+b+"translate("+a+"px,"+c+"px)";m.camera.style!==E&&(i.style.transform=E,m.camera.style=E),W(s,s,e)},this.setSize=function(s,e){n=s,h=e,a=n/2,c=h/2,d.style.width=s+"px",d.style.height=e+"px",r.style.width=s+"px",r.style.height=e+"px",i.style.width=s+"px",i.style.height=e+"px"};function t(s){return Math.abs(s)<1e-10?0:s}function C(s){const e=s.elements;return"matrix3d("+t(e[0])+","+t(-e[1])+","+t(e[2])+","+t(e[3])+","+t(e[4])+","+t(-e[5])+","+t(e[6])+","+t(e[7])+","+t(e[8])+","+t(-e[9])+","+t(e[10])+","+t(e[11])+","+t(e[12])+","+t(-e[13])+","+t(e[14])+","+t(e[15])+")"}function O(s){const e=s.elements;return"translate(-50%,-50%)"+("matrix3d("+t(e[0])+","+t(e[1])+","+t(e[2])+","+t(e[3])+","+t(-e[4])+","+t(-e[5])+","+t(-e[6])+","+t(-e[7])+","+t(e[8])+","+t(e[9])+","+t(e[10])+","+t(e[11])+","+t(e[12])+","+t(e[13])+","+t(e[14])+","+t(e[15])+")")}function W(s,e,p,L){if(s.isCSS3DObject){const v=s.visible===!0&&s.layers.test(p.layers)===!0;if(s.element.style.display=v===!0?"":"none",v===!0){s.onBeforeRender(o,e,p);let f;s.isCSS3DSprite?(y.copy(p.matrixWorldInverse),y.transpose(),s.rotation2D!==0&&y.multiply(ce.makeRotationZ(s.rotation2D)),s.matrixWorld.decompose(A,ae,I),y.setPosition(A),y.scale(I),y.elements[3]=0,y.elements[7]=0,y.elements[11]=0,y.elements[15]=1,f=O(y)):f=O(s.matrixWorld);const b=s.element,D=m.objects.get(s);if(D===void 0||D.style!==f){b.style.transform=f;const E={style:f};m.objects.set(s,E)}b.parentNode!==i&&i.appendChild(b),s.onAfterRender(o,e,p)}}for(let v=0,f=s.children.length;v<f;v++)W(s.children[v],e,p)}}}const me={__name:"el",props:{x:{type:Number,default:0},y:{type:Number,default:0},z:{type:Number,default:0},rx:{type:Number,default:0},ry:{type:Number,default:0},rz:{type:Number,default:0}},emits:["update:modelValue"],setup(u,{emit:l}){const o=te(),n=u,h=M(null);let a,c;const m=()=>{a=o.ctx.$parent.app,c=new de(h.value),c.position.set(n.x,n.y,n.z),c.rotateX(n.rx),c.rotateY(n.ry),c.rotateZ(n.rz);const d=new G;d.add(c);const r=new V(100,100,100),i=new B;i.color.set("black"),i.opacity=0,i.blending=F,i.side=X,d.add(new q(r,i)),a.scene.add(d)};return Y(()=>{setTimeout(()=>{m()},100)}),(d,r)=>(R(),P("div",{ref_key:"elementRef",ref:h},[Z(d.$slots,"default")],512))}},ue={key:0},pe={__name:"index",emits:["create","update"],setup(u,{expose:l,emit:o}){const n=o,h=M(null),a=M(null),c=M(null),m={keydown(r){d.key[r.key]=!0,Object.entries(d.input).map(([i,t])=>{d.key[i]=t.includes(r.key)})},keyup(r){d.key[r.key]=!1,Object.entries(d.input).map(([i,t])=>{d.key[i]=!1})}},d={reactive:ne({ready:!1}),width:0,height:0,camera:!1,scene:!1,wrapperEl:!1,input:{},key:{},create(){this.destroy(),console.log("init"),this.wrapperEl=h.value,this.reactive.ready=!0,this.width=a.value.offsetWidth,this.height=a.value.offsetHeight,this.camera=new U(50,this.width/this.height,1,5e3),this.scene=new Q,this.css3dRenderer=new he,this.css3dRenderer.setSize(this.width,this.height),a.value.textContent="",a.value.appendChild(this.css3dRenderer.domElement),this.webglRenderer=new T({alpha:!0,antialias:!0}),this.webglRenderer.setSize(this.width,this.height),this.webglRenderer.setClearColor(0,0),this.css3dRenderer.domElement.appendChild(this.webglRenderer.domElement);const r=()=>{this.reactive.ready&&(requestAnimationFrame(r),this.css3dRenderer.render(this.scene,this.camera),this.webglRenderer.render(this.scene,this.camera),n("update",this),this.trigger("update"))};document.addEventListener("keydown",m.keydown),document.addEventListener("keyup",m.keyup),r(),n("create",this),this.trigger("create")},destroy(){console.log("stop"),this.reactive.ready=!1,this.camera=!1,this.scene=!1,delete this.css3dRenderer,delete this.webglRenderer,document.removeEventListener("keydown",m.keydown),document.removeEventListener("keyup",m.keyup)},events:[],on(r,i){if(typeof r=="object"){Object.entries(r).map(([t,C])=>{this.events.push({name:t,callback:C})});return}this.events.push({name:r,callback:i})},trigger(r,i={}){this.events.map(t=>{r==t.name&&t.callback({app:this,...i})})}};return Y(()=>{d.create()}),se(()=>{d.destroy()}),l({app:d}),(r,i)=>(R(),P("div",{ref_key:"wrapperRef",ref:h,onClick:i[0]||(i[0]=t=>d.trigger("click",{event:t})),style:{position:"relative",width:"100%",height:"400px",overflow:"hidden",border:"solid 1px green"}},[g("div",{ref_key:"css3dRendererRef",ref:a,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",border:"solid 1px blue"}},null,512),g("div",{ref_key:"webglRendererRef",ref:c,style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",border:"solid 1px blue"}},null,512),d.reactive.ready?(R(),P("div",ue,[Z(r.$slots,"default")])):re("",!0)],512))}},k=new K(0,0,0,"YXZ"),_=new z,fe={type:"change"},ye={type:"lock"},ve={type:"unlock"},N=Math.PI/2;class we extends J{constructor(l,o){super(),this.camera=l,this.domElement=o,this.isLocked=!1,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.pointerSpeed=1,this._onMouseMove=ge.bind(this),this._onPointerlockChange=xe.bind(this),this._onPointerlockError=ke.bind(this),this.connect()}connect(){this.domElement.ownerDocument.addEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.addEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.addEventListener("pointerlockerror",this._onPointerlockError)}disconnect(){this.domElement.ownerDocument.removeEventListener("mousemove",this._onMouseMove),this.domElement.ownerDocument.removeEventListener("pointerlockchange",this._onPointerlockChange),this.domElement.ownerDocument.removeEventListener("pointerlockerror",this._onPointerlockError)}dispose(){this.disconnect()}getObject(){return this.camera}getDirection(l){return l.set(0,0,-1).applyQuaternion(this.camera.quaternion)}moveForward(l){const o=this.camera;_.setFromMatrixColumn(o.matrix,0),_.crossVectors(o.up,_),o.position.addScaledVector(_,l)}moveRight(l){const o=this.camera;_.setFromMatrixColumn(o.matrix,0),o.position.addScaledVector(_,l)}lock(){this.domElement.requestPointerLock()}unlock(){this.domElement.ownerDocument.exitPointerLock()}}function ge(u){if(this.isLocked===!1)return;const l=u.movementX||u.mozMovementX||u.webkitMovementX||0,o=u.movementY||u.mozMovementY||u.webkitMovementY||0,n=this.camera;k.setFromQuaternion(n.quaternion),k.y-=l*.002*this.pointerSpeed,k.x-=o*.002*this.pointerSpeed,k.x=Math.max(N-this.maxPolarAngle,Math.min(N-this.minPolarAngle,k.x)),n.quaternion.setFromEuler(k),this.dispatchEvent(fe)}function xe(){this.domElement.ownerDocument.pointerLockElement===this.domElement?(this.dispatchEvent(ye),this.isLocked=!0):(this.dispatchEvent(ve),this.isLocked=!1)}function ke(){console.error("THREE.PointerLockControls: Unable to use Pointer Lock API")}const _e=g("iframe",{src:"https://www.youtube.com/embed/AlUlF52QBBs?si=btThvtG1tt6g1gRS",style:{width:"100%",height:"100%"},allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowfullscreen:""},null,-1),be=g("div",null,"Lado 2",-1),Ee=g("div",null,"Lado 3",-1),Se=g("div",null,"Lado 4",-1),Ce={meta:{icon:"mdi-numeric-1",name:"Three.js CSS3D"}},Pe=Object.assign(Ce,{__name:"index",setup(u){let l;const o=n=>{l=n,n.input.front=["w","W"],n.input.back=["s","S"],n.input.left=["a","A"],n.input.right=["d","D"],n.camera.position.set(0,170,0);const h=new V(100,100,100),a=new B({color:new ee(65280)});a.opacity=0,a.blending=F,a.side=X;const c=new q(h,a);c.position.set(100,100,100),n.scene.add(c),console.log(c,n.scene.children),n.on({create(){n.pointerLockControl=new we(n.camera,n.wrapperEl)},click(){n.pointerLockControl.lock()},update(){n.key.front&&n.camera.translateZ(-5),n.key.back&&n.camera.translateZ(5),n.key.left&&n.camera.translateX(-5),n.key.right&&n.camera.translateX(5)}})};return(n,h)=>{const a=me,c=pe;return R(),P(le,null,[w(c,{onCreate:h[0]||(h[0]=m=>o(m))},{default:S(()=>[w(a,x({x:0,y:0,z:0,rx:Math.PI/2,ry:0,rz:0},{style:{width:"1000px",height:"1000px",background:"red"}}),null,16),w(a,x({x:0,y:300,z:0,rx:Math.PI/2,ry:0,rz:0},{style:{width:"1000px",height:"1000px",background:"red"}}),null,16),w(a,x({x:0,y:150,z:500,rx:0,ry:Math.PI,rz:0},{style:{width:"1000px",height:"300px",background:"red"}}),{default:S(()=>[_e]),_:1},16),w(a,x({x:500,y:150,z:0,rx:0,ry:Math.PI/2,rz:0},{style:{width:"1000px",height:"300px",background:"green"}}),{default:S(()=>[be]),_:1},16),w(a,x({x:0,y:150,z:-500,rx:0,ry:0,rz:0},{style:{width:"1000px",height:"300px",background:"blue"}}),{default:S(()=>[Ee]),_:1},16),w(a,x({x:-500,y:150,z:0,rx:0,ry:-Math.PI/2,rz:0},{style:{width:"1000px",height:"300px",background:"yellow"}}),{default:S(()=>[Se]),_:1},16)]),_:1}),g("pre",null,"theApp: "+oe(ie(l)),1)],64)}}});export{Pe as default};
