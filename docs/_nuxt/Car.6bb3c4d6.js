import{V as H,O as ke,S as $e,M as je,a as pe,D as Qe,b as Xe,c as Ke,H as Je,A as Ye,P as qe,d as _e,R as et,e as tt,L as nt,G as Vt,f as q,g as it,B as st,h as ze,i as me,T as rt,j as at,F as Ve,k as ot,l as Ce,m as Lt,n as Ft,o as Bt,p as bt}from"./three.module.ecaea3a5.js";import{p as ie}from"./entry.ae2d44a1.js";class ne{constructor(m=0,p=0,w=0){this.x=m,this.y=p,this.z=w}copy(m){return this.x=m.x,this.y=m.y,this.z=m.z,this}clone(){return new ne(this.x,this.y,this.z)}negate(){return this.x*=-1,this.y*=-1,this.z*=-1,this}add(m){return this.x+=m.x,this.y+=m.y,this.z+=m.z,this}sub(m){return this.x-=m.x,this.y-=m.y,this.z-=m.z,this}times(m){return this.x*=m,this.y*=m,this.z*=m,this}dividedBy(m){return this.x/=m,this.y/=m,this.z/=m,this}lerp(m,p){return this.add(new ne().copy(m).sub(this).times(p))}unit(){return this.dividedBy(this.length())}length(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))}normalize(){return this.unit()}cross(m){const p=this.clone(),w=p.x,c=p.y,e=p.z,o=m.x,n=m.y,r=m.z;return this.x=c*r-e*n,this.y=e*o-w*r,this.z=w*n-c*o,this}dot(m){return this.x*m.x+this.y*m.y+this.z*m.z}toVector3(){return new H(this.x,this.y,this.z)}}class ee{constructor(m,p){this.normal=m,this.w=p,this.normal=m,this.w=p}clone(){return new ee(this.normal.clone(),this.w)}flip(){this.normal.negate(),this.w=-this.w}splitPolygon(m,p,w,c,e){let l=0;const f=[];for(let s=0;s<m.vertices.length;s++){const t=this.normal.dot(m.vertices[s].pos)-this.w,i=t<-ee.EPSILON?2:t>ee.EPSILON?1:0;l|=i,f.push(i)}switch(l){case 0:(this.normal.dot(m.plane.normal)>0?p:w).push(m);break;case 1:c.push(m);break;case 2:e.push(m);break;case 3:{const s=[],t=[];for(let i=0;i<m.vertices.length;i++){const a=(i+1)%m.vertices.length,d=f[i],g=f[a],P=m.vertices[i],S=m.vertices[a];if(d!=2&&s.push(P),d!=1&&t.push(d!=2?P.clone():P),(d|g)==3){const h=(this.w-this.normal.dot(P.pos))/this.normal.dot(new ne().copy(S.pos).sub(P.pos)),v=P.interpolate(S,h);s.push(v),t.push(v.clone())}}s.length>=3&&c.push(new ve(s,m.shared)),t.length>=3&&e.push(new ve(t,m.shared));break}}}static fromPoints(m,p,w){const c=new ne().copy(p).sub(m).cross(new ne().copy(w).sub(m)).normalize();return new ee(c.clone(),c.dot(m))}}ee.EPSILON=1e-5;class ve{constructor(m,p){this.vertices=m,this.shared=p,this.plane=ee.fromPoints(m[0].pos,m[1].pos,m[2].pos)}clone(){return new ve(this.vertices.map(m=>m.clone()),this.shared)}flip(){this.vertices.reverse().map(m=>m.flip()),this.plane.flip()}}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */class lt extends ke{constructor(m,p,w,c){super(),this.scene=m,this.light=p,this.size=w,this.color=c,this.geo=new $e(w||.2,16,8),this.mat=new je({color:c||p.color}),this.mesh=new pe(this.geo,this.mat),this.add(this.mesh),p.add(this)}dispose(){this.mesh.geometry.dispose(),Array.isArray(this.mesh.material)?this.mesh.material.forEach(m=>m.dispose()):this.mesh.material.dispose(),this.remove(this.mesh)}update(){}}class Ot{constructor(m){this.scene=m}get helper(){return{directionalLightHelper:(m,p,w)=>{const c=new Qe(m,p,w);return this.scene.add(c),c},spotLightHelper:(m,p)=>{const w=new Xe(m,p);return this.scene.add(w),w},pointLightHelper:(m,p,w)=>new lt(this.scene,m,p,w)}}directionalLight(m={}){const{color:p=16777215,intensity:w=1}=m,c=new Ke(p,w);return c.castShadow=!0,this.scene.add(c),c}hemisphereLight(m={}){const{skyColor:p=16777215,groundColor:w=16777215,intensity:c=1}=m,e=new Je(p,w,c);return this.scene.add(e),e}ambientLight(m={}){const{color:p=16777215,intensity:w=1}=m,c=new Ye(p,w);return this.scene.add(c),c}pointLight(m={}){const{color:p=16777215,intensity:w=1,distance:c=0,decay:e=1}=m,o=new qe(p,w,c,e);return o.castShadow=!0,this.scene.add(o),o}spotLight(m={}){const{color:p=16777215,intensity:w=1,distance:c=0,angle:e=Math.PI/8,penumbra:o=0,decay:n=1}=m,r=new _e(p,w,c,e,o,n);return r.castShadow=!0,this.scene.add(r),r}rectAreaLight(m={}){const{color:p=16777215,intensity:w=1,width:c=10,height:e=10}=m,o=new et(p,w,c,e);return this.scene.add(o),o}}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */class Dt extends pe{constructor(m,p){super(m,p),this.isExtendedMesh=!0,this.isGroup=!1,this.vector3=new H,this.hasBody=!1,this.fragmentDepth=0,this.breakable=!1,this.fractureImpulse=1,this.name=`object-${this.id}`}get world(){return{theta:this.worldTheta,phi:this.worldPhi}}get worldTheta(){return this.getWorldDirection(this.vector3),Math.atan2(this.vector3.x,this.vector3.z)}get worldPhi(){return this.getWorldDirection(this.vector3),Math.acos(this.vector3.y)}}const fe=new Map,ct=5,Y=(I,m=!1)=>{if(!fe.has(I))fe.set(I,1);else{const p=fe.get(I);if(typeof p>"u"||p>=ct)return;fe.set(I,p+1)}m?console.error(`%c [enable3d] ${I} `,"background: #222; color: #bada55"):console.warn(`%c [enable3d] ${I} `,"background: #222; color: #bada55")};var Ae={},ge={};Object.defineProperty(ge,"__esModule",{value:!0});ge.VERSION=void 0;ge.VERSION="0.0.5";/**
 * @package      npmjs.com/package/@yandeu/events (events.min.js)
 *
 * @author       Arnout Kazemier (https://github.com/3rd-Eden)
 * @copyright    Copyright (c) 2014 Arnout Kazemier
 * @license      {@link https://github.com/primus/eventemitter3/blob/master/LICENSE|MIT}
 *
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/yandeu/events
 * @license      {@link https://github.com/yandeu/events/blob/master/LICENSE|MIT}
 */var Le=ie&&ie.__spreadArray||function(I,m){for(var p=0,w=m.length,c=I.length;p<w;p++,c++)I[c]=m[p];return I};Object.defineProperty(Ae,"__esModule",{value:!0});var ft=Ae.Events=void 0,ut=ge,ht=function(){function I(m,p,w){w===void 0&&(w=!1),this.fn=m,this.context=p,this.once=w}return I}(),Fe=function(I,m,p,w,c){if(typeof p!="function")throw new TypeError("The listener must be a function");var e=new ht(p,w||I,c);return I._events.has(m)?I._events.get(m).fn?I._events.set(m,[I._events.get(m),e]):I._events.get(m).push(e):(I._events.set(m,e),I._eventsCount++),I},ue=function(I,m){--I._eventsCount===0?I._events=new Map:I._events.delete(m)},mt=function(){function I(){this._events=new Map,this._eventsCount=0}return Object.defineProperty(I,"VERSION",{get:function(){return ut.VERSION},enumerable:!1,configurable:!0}),I.prototype.eventNames=function(){return Array.from(this._events.keys())},I.prototype.listeners=function(m){var p=this._events.get(m);if(!p)return[];if(p.fn)return[p.fn];for(var w=0,c=p.length,e=new Array(c);w<c;w++)e[w]=p[w].fn;return e},I.prototype.listenerCount=function(m){var p=this._events.get(m);return p?p.fn?1:p.length:0},I.prototype.emit=function(m){for(var p,w,c=[],e=1;e<arguments.length;e++)c[e-1]=arguments[e];if(!this._events.has(m))return!1;var o=this._events.get(m),n;if(o.fn)return o.once&&this.removeListener(m,o.fn,void 0,!0),(p=o.fn).call.apply(p,Le([o.context],c)),!0;var r=o.length;for(n=0;n<r;n++)o[n].once&&this.removeListener(m,o[n].fn,void 0,!0),(w=o[n].fn).call.apply(w,Le([o[n].context],c));return!0},I.prototype.on=function(m,p,w){return Fe(this,m,p,w,!1)},I.prototype.once=function(m,p,w){return Fe(this,m,p,w,!0)},I.prototype.removeListener=function(m,p,w,c){if(!this._events.has(m))return this;if(!p)return ue(this,m),this;var e=this._events.get(m);if(e.fn)e.fn===p&&(!c||e.once)&&(!w||e.context===w)&&ue(this,m);else{for(var o=0,n=[],r=e.length;o<r;o++)(e[o].fn!==p||c&&!e[o].once||w&&e[o].context!==w)&&n.push(e[o]);n.length?this._events.set(m,n.length===1?n[0]:n):ue(this,m)}return this},I.prototype.removeAllListeners=function(m){return m?this._events.delete(m)&&ue(this,m):(this._events=new Map,this._eventsCount=0),this},Object.defineProperty(I.prototype,"off",{get:function(){return this.removeListener},enumerable:!1,configurable:!0}),Object.defineProperty(I.prototype,"addListener",{get:function(){return this.on},enumerable:!1,configurable:!0}),I}();ft=Ae.Events=mt;/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */class dt extends ke{constructor(){super(),this.isExtendedObject3D=!0,this.isGroup=!1,this.vector3=new H,this.hasBody=!1,this.fragmentDepth=0,this.breakable=!1,this.fractureImpulse=1,this._currentAnimation="",this._animationActions=new Map,this.name=`object-${this.id}`}get world(){return{theta:this.worldTheta,phi:this.worldPhi}}get worldTheta(){return this.getWorldDirection(this.vector3),Math.atan2(this.vector3.x,this.vector3.z)}get worldPhi(){return this.getWorldDirection(this.vector3),Math.acos(this.vector3.y)}set animationMixer(m){this._animationMixer=m}get animationMixer(){return this._animationMixer||(this._animationMixer=new tt(this)),this._animationMixer}get anims(){return{current:this._currentAnimation,add:(m,p)=>this._animsAdd(m,p),get:m=>this._animsGet(m),play:(m,p=500,w=!0)=>this._animsPlay(m,p,w),mixer:this.animationMixer}}get animation(){return Y('Please use "anims" instead of "animation"'),this.anims}_animsAdd(m,p){this._animationActions.set(m,this.animationMixer.clipAction(p))}_animsGet(m){const p=this._animationActions.get(m);return p||Y(`Animation(${m}) not found!`),p}_animsPlay(m,p=500,w=!0){const c=this._animationActions.get(m),e=this._animationActions.get(this._currentAnimation);c&&(c.reset(),e&&(c.crossFadeFrom(e,p/1e3,!0),c.clampWhenFinished=!0),w||c.setLoop(nt,0),c.play()),this._currentAnimation=m}setAction(m){Y(`setAction(${m}) is deprecated. Use animation.play(${m}) instead!`)}traverse(m){super.traverse(m)}traverseVisible(m){super.traverseVisible(m)}traverseAncestors(m){super.traverseAncestors(m)}}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */const se={BOX:"box",CYLINDER:"cylinder",SPHERE:"sphere",CAPSULE:"capsule",CONE:"cone",HULL:"hull",HACD:"hacd",VHACD:"vhacd",MESH:"mesh",HEIGHTFIELD:"heightfield"},re={ALL:"all",MANUAL:"manual"},kt=function(){const I=new H,m=new H,p=new q;return function(w,c,e,o={}){if(o.type=se.HULL,xe(o),o.fit===re.MANUAL)return console.warn("cannot use fit: manual with type: hull"),null;const n=Me(w,c),r=new Ammo.btVector3,u=new Ammo.btConvexHullShape;u.setMargin(o.margin),m.addVectors(n.max,n.min).multiplyScalar(.5);let l=0;for(let i=0;i<w.length;i++)l+=w[i].length/3;const f=o.hullMaxVertices||1e5;l>f&&console.warn(`too many vertices for hull shape; sampling ~${f} from ~${l} vertices`);const s=Math.min(1,f/l);for(let i=0;i<w.length;i++){const a=w[i];p.fromArray(c[i]);for(let d=0;d<a.length;d+=3){const g=i===w.length-1&&d===a.length-3;(Math.random()<=s||g)&&(I.set(a[d],a[d+1],a[d+2]).applyMatrix4(p).sub(m),r.setValue(I.x,I.y,I.z),u.addPoint(r,g))}}let t=u;if(u.getNumVertices()>=100){const i=new Ammo.btShapeHull(u);i.buildHull(o.margin),Ammo.destroy(u),t=new Ammo.btConvexHullShape(Ammo.getPointer(i.getVertexPointer()),i.numVertices()),Ammo.destroy(i)}return Ammo.destroy(r),ye(t,o,we(e,o)),t}}(),zt=function(){const I=new H,m=new H,p=new q;return function(w,c,e,o,n={}){if(n.type=se.HACD,xe(n),n.fit===re.MANUAL)return console.warn("cannot use fit: manual with type: hacd"),[];if(!Ammo.hasOwnProperty("HACD"))return console.warn("HACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const r=Me(w,c);we(o,n);let u=0,l=0;m.addVectors(r.max,r.min).multiplyScalar(.5);for(let P=0;P<w.length;P++)u+=w[P].length/3,e&&e[P]?l+=e[P].length/3:l+=w[P].length/9;const f=new Ammo.HACD;n.hasOwnProperty("compacityWeight")&&f.SetCompacityWeight(n.compacityWeight),n.hasOwnProperty("volumeWeight")&&f.SetVolumeWeight(n.volumeWeight),n.hasOwnProperty("nClusters")&&f.SetNClusters(n.nClusters),n.hasOwnProperty("nVerticesPerCH")&&f.SetNVerticesPerCH(n.nVerticesPerCH),n.hasOwnProperty("concavity")&&f.SetConcavity(n.concavity);const s=Ammo._malloc(u*3*8),t=Ammo._malloc(l*3*4);f.SetPoints(s),f.SetTriangles(t),f.SetNPoints(u),f.SetNTriangles(l);let i=s/8,a=t/4;for(let P=0;P<w.length;P++){const S=w[P];p.fromArray(c[P]);for(let h=0;h<S.length;h+=3)I.set(S[h+0],S[h+1],S[h+2]).applyMatrix4(p).sub(m),Ammo.HEAPF64[i+0]=I.x,Ammo.HEAPF64[i+1]=I.y,Ammo.HEAPF64[i+2]=I.z,i+=3;if(e[P]){const h=e[P];for(let v=0;v<h.length;v++)Ammo.HEAP32[a]=h[v],a++}else for(let h=0;h<S.length/3;h++)Ammo.HEAP32[a]=h,a++}f.Compute(),Ammo._free(s),Ammo._free(t);const d=f.GetNClusters(),g=[];for(let P=0;P<d;P++){const S=new Ammo.btConvexHullShape;S.setMargin(n.margin);const h=f.GetNPointsCH(P),v=f.GetNTrianglesCH(P),y=Ammo._malloc(h*3*8),x=Ammo._malloc(v*3*4);f.GetCH(P,y,x);const A=y/8;for(let M=0;M<h;M++){const T=new Ammo.btVector3,C=Ammo.HEAPF64[A+M*3+0],R=Ammo.HEAPF64[A+M*3+1],E=Ammo.HEAPF64[A+M*3+2];T.setValue(C,R,E),S.addPoint(T,M===h-1),Ammo.destroy(T)}ye(),g.push(S)}return g}}(),Wt=function(){const I=new H,m=new H,p=new q;return function(w,c,e,o,n={}){if(n.type=se.VHACD,xe(n),n.fit===re.MANUAL)return console.warn("cannot use fit: manual with type: vhacd"),[];if(!Ammo.hasOwnProperty("VHACD"))return console.warn("VHACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const r=Me(w,c);we(o,n);let u=0,l=0;m.addVectors(r.max,r.min).multiplyScalar(.5);for(let h=0;h<w.length;h++)u+=w[h].length/3,e&&e[h]?l+=e[h].length/3:l+=w[h].length/9;const f=new Ammo.VHACD,s=new Ammo.Parameters;n.hasOwnProperty("resolution")&&s.set_m_resolution(n.resolution),n.hasOwnProperty("depth")&&s.set_m_depth(n.depth),n.hasOwnProperty("concavity")&&s.set_m_concavity(n.concavity),n.hasOwnProperty("planeDownsampling")&&s.set_m_planeDownsampling(n.planeDownsampling),n.hasOwnProperty("convexhullDownsampling")&&s.set_m_convexhullDownsampling(n.convexhullDownsampling),n.hasOwnProperty("alpha")&&s.set_m_alpha(n.alpha),n.hasOwnProperty("beta")&&s.set_m_beta(n.beta),n.hasOwnProperty("gamma")&&s.set_m_gamma(n.gamma),n.hasOwnProperty("pca")&&s.set_m_pca(n.pca),n.hasOwnProperty("mode")&&s.set_m_mode(n.mode),n.hasOwnProperty("maxNumVerticesPerCH")&&s.set_m_maxNumVerticesPerCH(n.maxNumVerticesPerCH),n.hasOwnProperty("minVolumePerCH")&&s.set_m_minVolumePerCH(n.minVolumePerCH),n.hasOwnProperty("convexhullApproximation")&&s.set_m_convexhullApproximation(n.convexhullApproximation),n.hasOwnProperty("oclAcceleration")&&s.set_m_oclAcceleration(n.oclAcceleration);const t=Ammo._malloc(u*3*8+3),i=Ammo._malloc(l*3*4);let a=t/8,d=i/4;for(let h=0;h<w.length;h++){const v=w[h];p.fromArray(c[h]);for(let y=0;y<v.length;y+=3)I.set(v[y+0],v[y+1],v[y+2]).applyMatrix4(p).sub(m),Ammo.HEAPF64[a+0]=I.x,Ammo.HEAPF64[a+1]=I.y,Ammo.HEAPF64[a+2]=I.z,a+=3;if(e[h]){const y=e[h];for(let x=0;x<y.length;x++)Ammo.HEAP32[d]=y[x],d++}else for(let y=0;y<v.length/3;y++)Ammo.HEAP32[d]=y,d++}f.Compute(t,3,u,i,3,l,s),Ammo._free(t),Ammo._free(i);const g=f.GetNConvexHulls(),P=[],S=new Ammo.ConvexHull;for(let h=0;h<g;h++){f.GetConvexHull(h,S);const v=S.get_m_nPoints();S.get_m_points();const y=new Ammo.btConvexHullShape;y.setMargin(n.margin);for(let x=0;x<v;x++){const A=new Ammo.btVector3,M=S.get_m_points(x*3+0),T=S.get_m_points(x*3+1),C=S.get_m_points(x*3+2);A.setValue(M,T,C),y.addPoint(A,x===v-1),Ammo.destroy(A)}ye(),P.push(y)}return Ammo.destroy(S),Ammo.destroy(f),P}}(),Nt=function(){const I=new H,m=new H,p=new H,w=new q;return function(c,e,o,n,r={}){if(r.type=se.MESH,xe(r),r.fit===re.MANUAL)return console.warn("cannot use fit: manual with type: mesh"),null;const u=we(n,r),l=new Ammo.btVector3,f=new Ammo.btVector3,s=new Ammo.btVector3,t=new Ammo.btTriangleMesh(!0,!1);for(let d=0;d<c.length;d++){const g=c[d],P=o[d]?o[d]:null;if(w.fromArray(e[d]),P)for(let S=0;S<P.length;S+=3){const h=P[S]*3,v=P[S+1]*3,y=P[S+2]*3;I.set(g[h],g[h+1],g[h+2]).applyMatrix4(w),m.set(g[v],g[v+1],g[v+2]).applyMatrix4(w),p.set(g[y],g[y+1],g[y+2]).applyMatrix4(w),l.setValue(I.x,I.y,I.z),f.setValue(m.x,m.y,m.z),s.setValue(p.x,p.y,p.z),t.addTriangle(l,f,s,!1)}else for(let S=0;S<g.length;S+=9)I.set(g[S+0],g[S+1],g[S+2]).applyMatrix4(w),m.set(g[S+3],g[S+4],g[S+5]).applyMatrix4(w),p.set(g[S+6],g[S+7],g[S+8]).applyMatrix4(w),l.setValue(I.x,I.y,I.z),f.setValue(m.x,m.y,m.z),s.setValue(p.x,p.y,p.z),t.addTriangle(l,f,s,!1)}const i=new Ammo.btVector3(u.x,u.y,u.z);t.setScaling(i),Ammo.destroy(i);let a;return r.concave?a=new Ammo.btBvhTriangleMeshShape(t,!0,!0):a=new Ammo.btConvexTriangleMeshShape(t,!0),a.resources=[t],Ammo.destroy(l),Ammo.destroy(f),Ammo.destroy(s),ye(),a}}();function xe(I){I.type=I.type||se.HULL,I.margin=I.hasOwnProperty("margin")?I.margin:.01}const ye=function(I,m,p){},Gt=function(){const I=new q;return function(m,p,w){parseInt(it)>=123?I.copy(m.matrixWorld).invert():I.getInverse(m.matrixWorld),new H().setFromMatrixScale(m.matrixWorld),m.traverse(e=>{const o=new q;e.isMesh&&(p.includeInvisible||e.el&&e.el.object3D.visible||e.visible)&&(e===m?o.identity():(e.updateWorldMatrix(!0),o.multiplyMatrices(I,e.matrixWorld)),w(e.geometry.isBufferGeometry?e.geometry.attributes.position.array:e.geometry.vertices,o.elements,e.geometry.index?e.geometry.index.array:null))})}}(),we=function(){const I=new q;return function(m,p={}){const w=new H(1,1,1);return p.fit===re.ALL&&(I.fromArray(m),w.setFromMatrixScale(I)),w}}();(function(){const I=new H;return function(m,p,w){let c=0,{x:e,y:o,z:n}=w.getCenter(I);return We(m,p,r=>{const u=e-r.x,l=o-r.y,f=n-r.z;c=Math.max(c,u*u+l*l+f*f)}),Math.sqrt(c)}})();const Me=function(I,m){const p=new st;let w=1/0,c=1/0,e=1/0,o=-1/0,n=-1/0,r=-1/0;return p.min.set(0,0,0),p.max.set(0,0,0),We(I,m,u=>{u.x<w&&(w=u.x),u.y<c&&(c=u.y),u.z<e&&(e=u.z),u.x>o&&(o=u.x),u.y>n&&(n=u.y),u.z>r&&(r=u.z)}),p.min.set(w,c,e),p.max.set(o,n,r),p},We=function(){const I=new H,m=new q;return function(p,w,c){for(let e=0;e<p.length;e++){m.fromArray(w[e]);for(let o=0;o<p[e].length;o+=3)I.set(p[e][o],p[e][o+1],p[e][o+2]).applyMatrix4(m),c(I)}}}(),de=0,pt=1,vt=new H,Be=new ze,Se=new me,be=new H,he=new rt;class gt{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new He,this.unassigned=new He,this.vertices=[]}setFromPoints(m){if(m.length>=4){this.makeEmpty();for(let p=0,w=m.length;p<w;p++)this.vertices.push(new xt(m[p]));this.compute()}return this}setFromObject(m){const p=[];return m.updateMatrixWorld(!0),m.traverse(function(w){const c=w.geometry;if(c!==void 0){const e=c.attributes.position;if(e!==void 0)for(let o=0,n=e.count;o<n;o++){const r=new H;r.fromBufferAttribute(e,o).applyMatrix4(w.matrixWorld),p.push(r)}}}),this.setFromPoints(p)}containsPoint(m){const p=this.faces;for(let w=0,c=p.length;w<c;w++)if(p[w].distanceToPoint(m)>this.tolerance)return!1;return!0}intersectRay(m,p){const w=this.faces;let c=-1/0,e=1/0;for(let o=0,n=w.length;o<n;o++){const r=w[o],u=r.distanceToPoint(m.origin),l=r.normal.dot(m.direction);if(u>0&&l>=0)return null;const f=l!==0?-u/l:0;if(!(f<=0)&&(l>0?e=Math.min(f,e):c=Math.max(f,c),c>e))return null}return c!==-1/0?m.at(c,p):m.at(e,p),p}intersectsRay(m){return this.intersectRay(m,vt)!==null}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(m,p){return m.face=p,p.outside===null?this.assigned.append(m):this.assigned.insertBefore(p.outside,m),p.outside=m,this}removeVertexFromFace(m,p){return m===p.outside&&(m.next!==null&&m.next.face===p?p.outside=m.next:p.outside=null),this.assigned.remove(m),this}removeAllVerticesFromFace(m){if(m.outside!==null){const p=m.outside;let w=m.outside;for(;w.next!==null&&w.next.face===m;)w=w.next;return this.assigned.removeSubList(p,w),p.prev=w.next=null,m.outside=null,p}}deleteFaceVertices(m,p){const w=this.removeAllVerticesFromFace(m);if(w!==void 0)if(p===void 0)this.unassigned.appendChain(w);else{let c=w;do{const e=c.next;p.distanceToPoint(c.point)>this.tolerance?this.addVertexToFace(c,p):this.unassigned.append(c),c=e}while(c!==null)}return this}resolveUnassignedPoints(m){if(this.unassigned.isEmpty()===!1){let p=this.unassigned.first();do{const w=p.next;let c=this.tolerance,e=null;for(let o=0;o<m.length;o++){const n=m[o];if(n.mark===de){const r=n.distanceToPoint(p.point);if(r>c&&(c=r,e=n),c>1e3*this.tolerance)break}}e!==null&&this.addVertexToFace(p,e),p=w}while(p!==null)}return this}computeExtremes(){const m=new H,p=new H,w=[],c=[];for(let e=0;e<3;e++)w[e]=c[e]=this.vertices[0];m.copy(this.vertices[0].point),p.copy(this.vertices[0].point);for(let e=0,o=this.vertices.length;e<o;e++){const n=this.vertices[e],r=n.point;for(let u=0;u<3;u++)r.getComponent(u)<m.getComponent(u)&&(m.setComponent(u,r.getComponent(u)),w[u]=n);for(let u=0;u<3;u++)r.getComponent(u)>p.getComponent(u)&&(p.setComponent(u,r.getComponent(u)),c[u]=n)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(m.x),Math.abs(p.x))+Math.max(Math.abs(m.y),Math.abs(p.y))+Math.max(Math.abs(m.z),Math.abs(p.z))),{min:w,max:c}}computeInitialHull(){const m=this.vertices,p=this.computeExtremes(),w=p.min,c=p.max;let e=0,o=0;for(let s=0;s<3;s++){const t=c[s].point.getComponent(s)-w[s].point.getComponent(s);t>e&&(e=t,o=s)}const n=w[o],r=c[o];let u,l;e=0,Be.set(n.point,r.point);for(let s=0,t=this.vertices.length;s<t;s++){const i=m[s];if(i!==n&&i!==r){Be.closestPointToPoint(i.point,!0,be);const a=be.distanceToSquared(i.point);a>e&&(e=a,u=i)}}e=-1,Se.setFromCoplanarPoints(n.point,r.point,u.point);for(let s=0,t=this.vertices.length;s<t;s++){const i=m[s];if(i!==n&&i!==r&&i!==u){const a=Math.abs(Se.distanceToPoint(i.point));a>e&&(e=a,l=i)}}const f=[];if(Se.distanceToPoint(l.point)<0){f.push(j.create(n,r,u),j.create(l,r,n),j.create(l,u,r),j.create(l,n,u));for(let s=0;s<3;s++){const t=(s+1)%3;f[s+1].getEdge(2).setTwin(f[0].getEdge(t)),f[s+1].getEdge(1).setTwin(f[t+1].getEdge(0))}}else{f.push(j.create(n,u,r),j.create(l,n,r),j.create(l,r,u),j.create(l,u,n));for(let s=0;s<3;s++){const t=(s+1)%3;f[s+1].getEdge(2).setTwin(f[0].getEdge((3-s)%3)),f[s+1].getEdge(0).setTwin(f[t+1].getEdge(1))}}for(let s=0;s<4;s++)this.faces.push(f[s]);for(let s=0,t=m.length;s<t;s++){const i=m[s];if(i!==n&&i!==r&&i!==u&&i!==l){e=this.tolerance;let a=null;for(let d=0;d<4;d++){const g=this.faces[d].distanceToPoint(i.point);g>e&&(e=g,a=this.faces[d])}a!==null&&this.addVertexToFace(i,a)}}return this}reindexFaces(){const m=[];for(let p=0;p<this.faces.length;p++){const w=this.faces[p];w.mark===de&&m.push(w)}return this.faces=m,this}nextVertexToAdd(){if(this.assigned.isEmpty()===!1){let m,p=0;const w=this.assigned.first().face;let c=w.outside;do{const e=w.distanceToPoint(c.point);e>p&&(p=e,m=c),c=c.next}while(c!==null&&c.face===w);return m}}computeHorizon(m,p,w,c){this.deleteFaceVertices(w),w.mark=pt;let e;p===null?e=p=w.getEdge(0):e=p.next;do{const o=e.twin,n=o.face;n.mark===de&&(n.distanceToPoint(m)>this.tolerance?this.computeHorizon(m,o,n,c):c.push(e)),e=e.next}while(e!==p);return this}addAdjoiningFace(m,p){const w=j.create(m,p.tail(),p.head());return this.faces.push(w),w.getEdge(-1).setTwin(p.twin),w.getEdge(0)}addNewFaces(m,p){this.newFaces=[];let w=null,c=null;for(let e=0;e<p.length;e++){const o=p[e],n=this.addAdjoiningFace(m,o);w===null?w=n:n.next.setTwin(c),this.newFaces.push(n.face),c=n}return w.next.setTwin(c),this}addVertexToHull(m){const p=[];return this.unassigned.clear(),this.removeVertexFromFace(m,m.face),this.computeHorizon(m.point,null,m.face,p),this.addNewFaces(m,p),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let m;for(this.computeInitialHull();(m=this.nextVertexToAdd())!==void 0;)this.addVertexToHull(m);return this.reindexFaces(),this.cleanup(),this}}class j{constructor(){this.normal=new H,this.midpoint=new H,this.area=0,this.constant=0,this.outside=null,this.mark=de,this.edge=null}static create(m,p,w){const c=new j,e=new Pe(m,c),o=new Pe(p,c),n=new Pe(w,c);return e.next=n.prev=o,o.next=e.prev=n,n.next=o.prev=e,c.edge=e,c.compute()}getEdge(m){let p=this.edge;for(;m>0;)p=p.next,m--;for(;m<0;)p=p.prev,m++;return p}compute(){const m=this.edge.tail(),p=this.edge.head(),w=this.edge.next.head();return he.set(m.point,p.point,w.point),he.getNormal(this.normal),he.getMidpoint(this.midpoint),this.area=he.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(m){return this.normal.dot(m)-this.constant}}class Pe{constructor(m,p){this.vertex=m,this.prev=null,this.next=null,this.twin=null,this.face=p}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const m=this.head(),p=this.tail();return p!==null?p.point.distanceTo(m.point):-1}lengthSquared(){const m=this.head(),p=this.tail();return p!==null?p.point.distanceToSquared(m.point):-1}setTwin(m){return this.twin=m,m.twin=this,this}}class xt{constructor(m){this.point=m,this.prev=null,this.next=null,this.face=null}}class He{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(m,p){return p.prev=m.prev,p.next=m,p.prev===null?this.head=p:p.prev.next=p,m.prev=p,this}insertAfter(m,p){return p.prev=m,p.next=m.next,p.next===null?this.tail=p:p.next.prev=p,m.next=p,this}append(m){return this.head===null?this.head=m:this.tail.next=m,m.prev=this.tail,m.next=null,this.tail=m,this}appendChain(m){for(this.head===null?this.head=m:this.tail.next=m,m.prev=this.tail;m.next!==null;)m=m.next;return this.tail=m,this}remove(m){return m.prev===null?this.head=m.next:m.prev.next=m.next,m.next===null?this.tail=m.prev:m.next.prev=m.prev,this}removeSubList(m,p){return m.prev===null?this.head=p.next:m.prev.next=p.next,p.next===null?this.tail=m.prev:p.next.prev=m.prev,this}isEmpty(){return this.head===null}}class yt extends at{constructor(m=[]){super();const p=[],w=[],e=new gt().setFromPoints(m).faces;for(let o=0;o<e.length;o++){const n=e[o];let r=n.edge;do{const u=r.head().point;p.push(u.x,u.y,u.z),w.push(n.normal.x,n.normal.y,n.normal.z),r=r.next}while(r!==n.edge)}this.setAttribute("position",new Ve(p,3)),this.setAttribute("normal",new Ve(w,3))}}const Oe=I=>{const m=window.THREE&&window.THREE.ConvexGeometry?window.THREE.ConvexGeometry:yt;return new m(I)},J=function(I,m){this.minSizeForBreak=I||1.4,this.smallDelta=m||1e-4,this.tempLine1=new ze,this.tempPlane1=new me,this.tempPlane2=new me,this.tempPlane_Cut=new me,this.tempCM1=new H,this.tempCM2=new H,this.tempVector3=new H,this.tempVector3_2=new H,this.tempVector3_3=new H,this.tempVector3_P0=new H,this.tempVector3_P1=new H,this.tempVector3_P2=new H,this.tempVector3_N0=new H,this.tempVector3_N1=new H,this.tempVector3_AB=new H,this.tempVector3_CB=new H,this.tempResultObjects={object1:null,object2:null},this.segments=[];for(var p=30*30,w=0;w<p;w++)this.segments[w]=!1};J.prototype={constructor:J,prepareBreakableObject:function(I,m,p,w,c){I.geometry.isBufferGeometry||console.error("THREE.ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry."),I.userData.ammoPhysicsData={};var e=I.userData.ammoPhysicsData;e.mass=m,e.velocity=p.clone(),e.angularVelocity=w.clone(),e.breakable=c},subdivideByImpact:function(I,m,p,w,c){var e=[],o=this.tempPlane1,n=this.tempPlane2;this.tempVector3.addVectors(m,p),o.setFromCoplanarPoints(m,I.position,this.tempVector3);var r=c+w,u=this;function l(f,s,t,i){if(Math.random()<i*.05||i>r){e.push(f);return}var a=Math.PI;i===0?(n.normal.copy(o.normal),n.constant=o.constant):i<=w?(a=(t-s)*(.2+.6*Math.random())+s,u.tempVector3_2.copy(I.position).sub(m).applyAxisAngle(p,a).add(m),n.setFromCoplanarPoints(m,u.tempVector3,u.tempVector3_2)):(a=(.5*(i&1)+.2*(2-Math.random()))*Math.PI,u.tempVector3_2.copy(m).sub(f.position).applyAxisAngle(p,a).add(f.position),u.tempVector3_3.copy(p).add(f.position),n.setFromCoplanarPoints(f.position,u.tempVector3_3,u.tempVector3_2)),u.cutByPlane(f,n,u.tempResultObjects);var d=u.tempResultObjects.object1,g=u.tempResultObjects.object2;d&&l(d,s,a,i+1),g&&l(g,a,t,i+1)}return l(I,0,2*Math.PI,0),e},cutByPlane:function(I,m,p){var w=I.geometry,c=w.attributes.position.array,e=w.attributes.normal.array,o=c.length/3,n=o/3,r=w.getIndex();r&&(r=r.array,n=r.length/3);function u($,ae){var te=$*3+ae;return r?r[te]:te}for(var l=[],f=[],s=this.smallDelta,t=o*o,i=0;i<t;i++)this.segments[i]=!1;for(var a=this.tempVector3_P0,d=this.tempVector3_P1,g=this.tempVector3_N0,P=this.tempVector3_N1,i=0;i<n-1;i++){var S=u(i,0),h=u(i,1),v=u(i,2);g.set(e[S],e[S]+1,e[S]+2);for(var y=i+1;y<n;y++){var x=u(y,0),A=u(y,1),M=u(y,2);P.set(e[x],e[x]+1,e[x]+2);var T=1-g.dot(P)<s;T&&(S===x||S===A||S===M?h===x||h===A||h===M?(this.segments[S*o+h]=!0,this.segments[h*o+S]=!0):(this.segments[v*o+S]=!0,this.segments[S*o+v]=!0):(h===x||h===A||h===M)&&(this.segments[v*o+h]=!0,this.segments[h*o+v]=!0))}}var C=this.tempPlane_Cut;I.updateMatrix(),J.transformPlaneToLocalSpace(m,I.matrix,C);for(var i=0;i<n;i++)for(var R=u(i,0),E=u(i,1),V=u(i,2),L=0;L<3;L++){var F=L===0?R:L===1?E:V,B=L===0?E:L===1?V:R,O=this.segments[F*o+B];if(!O){this.segments[F*o+B]=!0,this.segments[B*o+F]=!0,a.set(c[3*F],c[3*F+1],c[3*F+2]),d.set(c[3*B],c[3*B+1],c[3*B+2]);var b=0,k=C.distanceToPoint(a);k>s?(b=2,f.push(a.clone())):k<-s?(b=1,l.push(a.clone())):(b=3,l.push(a.clone()),f.push(a.clone()));var D=0,k=C.distanceToPoint(d);if(k>s?(D=2,f.push(d.clone())):k<-s?(D=1,l.push(d.clone())):(D=3,l.push(d.clone()),f.push(d.clone())),b===1&&D===2||b===2&&D===1){this.tempLine1.start.copy(a),this.tempLine1.end.copy(d);var W=new H;if(W=C.intersectLine(this.tempLine1,W),W===void 0)return console.error("Internal error: segment does not intersect plane."),p.segmentedObject1=null,p.segmentedObject2=null,0;l.push(W),f.push(W.clone())}}}var z=I.userData.ammoPhysicsData.mass*.5;this.tempCM1.set(0,0,0);var Z=0,G=l.length;if(G>0){for(var i=0;i<G;i++)this.tempCM1.add(l[i]);this.tempCM1.divideScalar(G);for(var i=0;i<G;i++){var N=l[i];N.sub(this.tempCM1),Z=Math.max(Z,N.x,N.y,N.z)}this.tempCM1.add(I.position)}this.tempCM2.set(0,0,0);var U=0,_=f.length;if(_>0){for(var i=0;i<_;i++)this.tempCM2.add(f[i]);this.tempCM2.divideScalar(_);for(var i=0;i<_;i++){var N=f[i];N.sub(this.tempCM2),U=Math.max(U,N.x,N.y,N.z)}this.tempCM2.add(I.position)}var Q=null,X=null,K=0;if(G>4)try{Q=new pe(Oe(l),I.material),Q.position.copy(this.tempCM1),Q.quaternion.copy(I.quaternion),Q.userData=I.userData,this.prepareBreakableObject(Q,z,I.userData.ammoPhysicsData.velocity,I.userData.ammoPhysicsData.angularVelocity,2*Z>this.minSizeForBreak),K++}catch($){Y("Error in ConvexObjectBreaker.ts",!0),Y($,!0)}if(_>4)try{X=new pe(Oe(f),I.material),X.position.copy(this.tempCM2),X.quaternion.copy(I.quaternion),X.userData=I.userData,this.prepareBreakableObject(X,z,I.userData.ammoPhysicsData.velocity,I.userData.ammoPhysicsData.angularVelocity,2*U>this.minSizeForBreak),K++}catch($){Y("Error in ConvexObjectBreaker.ts",!0),Y($,!0)}return p.object1=Q,p.object2=X,K}};J.transformFreeVector=function(I,m){var p=I.x,w=I.y,c=I.z,e=m.elements;return I.x=e[0]*p+e[4]*w+e[8]*c,I.y=e[1]*p+e[5]*w+e[9]*c,I.z=e[2]*p+e[6]*w+e[10]*c,I};J.transformFreeVectorInverse=function(I,m){var p=I.x,w=I.y,c=I.z,e=m.elements;return I.x=e[0]*p+e[1]*w+e[2]*c,I.y=e[4]*p+e[5]*w+e[6]*c,I.z=e[8]*p+e[9]*w+e[10]*c,I};J.transformTiedVectorInverse=function(I,m){var p=I.x,w=I.y,c=I.z,e=m.elements;return I.x=e[0]*p+e[1]*w+e[2]*c-e[12],I.y=e[4]*p+e[5]*w+e[6]*c-e[13],I.z=e[8]*p+e[9]*w+e[10]*c-e[14],I};J.transformPlaneToLocalSpace=function(){var I=new H;return function(p,w,c){c.normal.copy(p.normal),c.constant=p.constant;var e=J.transformTiedVectorInverse(p.coplanarPoint(I),w);J.transformFreeVectorInverse(c.normal,w),c.constant=-e.dot(c.normal)}}();const wt=(()=>{try{if(typeof WebAssembly=="object"&&typeof WebAssembly.instantiate=="function"){const I=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(I instanceof WebAssembly.Module)return new WebAssembly.Instance(I)instanceof WebAssembly.Instance}}catch(I){I instanceof Error&&console.error(I.message)}return!1})(),De=(I,m)=>{var p=document.createElement("script");p.onload=()=>{m()},p.onerror=()=>{throw new Error(`failed to load ${I}`)},p.async=!0,p.src=I,document.head.appendChild(p)},Ut=(I,m)=>{wt?De(`${I}/ammo.wasm.js`,()=>m()):De(`${I}/ammo.js`,()=>m())};function Ne(I,m){m.forEach(p=>{Object.getOwnPropertyNames(p.prototype).forEach(w=>{Object.defineProperty(I.prototype,w,Object.getOwnPropertyDescriptor(p.prototype,w)||Object.create(null))})})}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */class St{constructor(m){this.physics=m}getHitPointWorld(){const m=this._btRayCallback.get_m_hitPointWorld();return{x:m.x(),y:m.y(),z:m.z()}}getHitNormalWorld(){const m=this._btRayCallback.get_m_hitNormalWorld();return{x:m.x(),y:m.y(),z:m.z()}}getCollisionObject(){return Ammo.castObject(this._btRayCallback.get_m_collisionObject(),Ammo.btRigidBody).threeObject}}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */class Pt{constructor(m){this.physics=m}getHitPointsWorld(){const m=this._btRayCallback.get_m_hitPointWorld(),p=[];for(let w=m.size()-1;w>=0;w--){const c=m.at(w);p.push({x:c.x(),y:c.y(),z:c.z()})}return p}getHitPointWorld(){return Y("Use getHitPointsWorld() instead of getHitPointWorld() for the AllHitsRayCaster!"),this.getHitPointsWorld()}getHitNormalsWorld(){const m=this._btRayCallback.get_m_hitNormalWorld(),p=[];for(let w=m.size()-1;w>=0;w--){const c=m.at(w);p.push({x:c.x(),y:c.y(),z:c.z()})}return p}getCollisionObjects(){const m=[],p=this._btRayCallback.get_m_collisionObjects();for(let w=p.size()-1;w>=0;w--){const c=Ammo.castObject(p.at(w),Ammo.btRigidBody);m.push(c.threeObject)}return m}}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */class Ge{constructor(m){this.physics=m}setRayFromWorld(m=0,p=0,w=0){this._btRayFrom.setValue(m,p,w)}setRayToWorld(m=0,p=0,w=0){this._btRayTo.setValue(m,p,w)}hasHit(){return this._btRayCallback.hasHit()}rayTest(){typeof this._btRayCallback<"u"&&Ammo.destroy(this._btRayCallback),this._btRayCallback=this.type==="closest"?new Ammo.ClosestRayResultCallback(this._btRayFrom,this._btRayTo):new Ammo.AllHitsRayResultCallback(this._btRayFrom,this._btRayTo),this.physics.physicsWorld.rayTest(this._btRayFrom,this._btRayTo,this._btRayCallback)}destroy(){typeof this._btRayFrom<"u"&&Ammo.destroy(this._btRayFrom),typeof this._btRayTo<"u"&&Ammo.destroy(this._btRayTo),typeof this._btRayCallback<"u"&&Ammo.destroy(this._btRayCallback)}}class Ct{constructor(m){this.physics=m,this.type="closest",this._btRayFrom=new Ammo.btVector3(0,0,0),this._btRayTo=new Ammo.btVector3(0,0,0)}}class At{constructor(m){this.physics=m,this.type="allHits",this._btRayFrom=new Ammo.btVector3(0,0,0),this._btRayTo=new Ammo.btVector3(0,0,0)}}Ne(Ct,[Ge,St]);Ne(At,[Ge,Pt]);const Mt="0.25.3",Tt=`Powered by enable3d v${Mt}`;console.log(`%c %c %c %c %c ${Tt} %c https://enable3d.io/`,"background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none");/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */const Zt=document.createElement("canvas");new ot;new Ce;new Ce;new Ce;/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 *//**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 *//**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */var It={exports:{}};/*!
 * matter-js 0.18.0 by @liabru
 * http://brm.io/matter-js/
 * License MIT
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) Liam Brummitt and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(I,m){(function(w,c){I.exports=c()})(ie,function(){return function(p){var w={};function c(e){if(w[e])return w[e].exports;var o=w[e]={i:e,l:!1,exports:{}};return p[e].call(o.exports,o,o.exports,c),o.l=!0,o.exports}return c.m=p,c.c=w,c.d=function(e,o,n){c.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},c.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},c.t=function(e,o){if(o&1&&(e=c(e)),o&8||o&4&&typeof e=="object"&&e&&e.__esModule)return e;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),o&2&&typeof e!="string")for(var r in e)c.d(n,r,function(u){return e[u]}.bind(null,r));return n},c.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return c.d(o,"a",o),o},c.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},c.p="",c(c.s=21)}([function(p,w){var c={};p.exports=c,function(){c._nextId=0,c._seed=0,c._nowStartTime=+new Date,c._warnedOnce={},c._decomp=null,c.extend=function(o,n){var r,u;typeof n=="boolean"?(r=2,u=n):(r=1,u=!0);for(var l=r;l<arguments.length;l++){var f=arguments[l];if(f)for(var s in f)u&&f[s]&&f[s].constructor===Object&&(!o[s]||o[s].constructor===Object)?(o[s]=o[s]||{},c.extend(o[s],u,f[s])):o[s]=f[s]}return o},c.clone=function(o,n){return c.extend({},n,o)},c.keys=function(o){if(Object.keys)return Object.keys(o);var n=[];for(var r in o)n.push(r);return n},c.values=function(o){var n=[];if(Object.keys){for(var r=Object.keys(o),u=0;u<r.length;u++)n.push(o[r[u]]);return n}for(var l in o)n.push(o[l]);return n},c.get=function(o,n,r,u){n=n.split(".").slice(r,u);for(var l=0;l<n.length;l+=1)o=o[n[l]];return o},c.set=function(o,n,r,u,l){var f=n.split(".").slice(u,l);return c.get(o,n,0,-1)[f[f.length-1]]=r,r},c.shuffle=function(o){for(var n=o.length-1;n>0;n--){var r=Math.floor(c.random()*(n+1)),u=o[n];o[n]=o[r],o[r]=u}return o},c.choose=function(o){return o[Math.floor(c.random()*o.length)]},c.isElement=function(o){return typeof HTMLElement<"u"?o instanceof HTMLElement:!!(o&&o.nodeType&&o.nodeName)},c.isArray=function(o){return Object.prototype.toString.call(o)==="[object Array]"},c.isFunction=function(o){return typeof o=="function"},c.isPlainObject=function(o){return typeof o=="object"&&o.constructor===Object},c.isString=function(o){return toString.call(o)==="[object String]"},c.clamp=function(o,n,r){return o<n?n:o>r?r:o},c.sign=function(o){return o<0?-1:1},c.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-c._nowStartTime},c.random=function(o,n){return o=typeof o<"u"?o:0,n=typeof n<"u"?n:1,o+e()*(n-o)};var e=function(){return c._seed=(c._seed*9301+49297)%233280,c._seed/233280};c.colorToNumber=function(o){return o=o.replace("#",""),o.length==3&&(o=o.charAt(0)+o.charAt(0)+o.charAt(1)+o.charAt(1)+o.charAt(2)+o.charAt(2)),parseInt(o,16)},c.logLevel=1,c.log=function(){console&&c.logLevel>0&&c.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},c.info=function(){console&&c.logLevel>0&&c.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},c.warn=function(){console&&c.logLevel>0&&c.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},c.warnOnce=function(){var o=Array.prototype.slice.call(arguments).join(" ");c._warnedOnce[o]||(c.warn(o),c._warnedOnce[o]=!0)},c.deprecated=function(o,n,r){o[n]=c.chain(function(){c.warnOnce("\u{1F505} deprecated \u{1F505}",r)},o[n])},c.nextId=function(){return c._nextId++},c.indexOf=function(o,n){if(o.indexOf)return o.indexOf(n);for(var r=0;r<o.length;r++)if(o[r]===n)return r;return-1},c.map=function(o,n){if(o.map)return o.map(n);for(var r=[],u=0;u<o.length;u+=1)r.push(n(o[u]));return r},c.topologicalSort=function(o){var n=[],r=[],u=[];for(var l in o)!r[l]&&!u[l]&&c._topologicalSort(l,r,u,o,n);return n},c._topologicalSort=function(o,n,r,u,l){var f=u[o]||[];r[o]=!0;for(var s=0;s<f.length;s+=1){var t=f[s];r[t]||n[t]||c._topologicalSort(t,n,r,u,l)}r[o]=!1,n[o]=!0,l.push(o)},c.chain=function(){for(var o=[],n=0;n<arguments.length;n+=1){var r=arguments[n];r._chained?o.push.apply(o,r._chained):o.push(r)}var u=function(){for(var l,f=new Array(arguments.length),s=0,t=arguments.length;s<t;s++)f[s]=arguments[s];for(s=0;s<o.length;s+=1){var i=o[s].apply(l,f);typeof i<"u"&&(l=i)}return l};return u._chained=o,u},c.chainPathBefore=function(o,n,r){return c.set(o,n,c.chain(r,c.get(o,n)))},c.chainPathAfter=function(o,n,r){return c.set(o,n,c.chain(c.get(o,n),r))},c.setDecomp=function(o){c._decomp=o},c.getDecomp=function(){var o=c._decomp;try{!o&&typeof window<"u"&&(o=window.decomp),!o&&typeof ie<"u"&&(o=ie.decomp)}catch{o=null}return o}}()},function(p,w){var c={};p.exports=c,function(){c.create=function(e){var o={min:{x:0,y:0},max:{x:0,y:0}};return e&&c.update(o,e),o},c.update=function(e,o,n){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var r=0;r<o.length;r++){var u=o[r];u.x>e.max.x&&(e.max.x=u.x),u.x<e.min.x&&(e.min.x=u.x),u.y>e.max.y&&(e.max.y=u.y),u.y<e.min.y&&(e.min.y=u.y)}n&&(n.x>0?e.max.x+=n.x:e.min.x+=n.x,n.y>0?e.max.y+=n.y:e.min.y+=n.y)},c.contains=function(e,o){return o.x>=e.min.x&&o.x<=e.max.x&&o.y>=e.min.y&&o.y<=e.max.y},c.overlaps=function(e,o){return e.min.x<=o.max.x&&e.max.x>=o.min.x&&e.max.y>=o.min.y&&e.min.y<=o.max.y},c.translate=function(e,o){e.min.x+=o.x,e.max.x+=o.x,e.min.y+=o.y,e.max.y+=o.y},c.shift=function(e,o){var n=e.max.x-e.min.x,r=e.max.y-e.min.y;e.min.x=o.x,e.max.x=o.x+n,e.min.y=o.y,e.max.y=o.y+r}}()},function(p,w){var c={};p.exports=c,function(){c.create=function(e,o){return{x:e||0,y:o||0}},c.clone=function(e){return{x:e.x,y:e.y}},c.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},c.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},c.rotate=function(e,o,n){var r=Math.cos(o),u=Math.sin(o);n||(n={});var l=e.x*r-e.y*u;return n.y=e.x*u+e.y*r,n.x=l,n},c.rotateAbout=function(e,o,n,r){var u=Math.cos(o),l=Math.sin(o);r||(r={});var f=n.x+((e.x-n.x)*u-(e.y-n.y)*l);return r.y=n.y+((e.x-n.x)*l+(e.y-n.y)*u),r.x=f,r},c.normalise=function(e){var o=c.magnitude(e);return o===0?{x:0,y:0}:{x:e.x/o,y:e.y/o}},c.dot=function(e,o){return e.x*o.x+e.y*o.y},c.cross=function(e,o){return e.x*o.y-e.y*o.x},c.cross3=function(e,o,n){return(o.x-e.x)*(n.y-e.y)-(o.y-e.y)*(n.x-e.x)},c.add=function(e,o,n){return n||(n={}),n.x=e.x+o.x,n.y=e.y+o.y,n},c.sub=function(e,o,n){return n||(n={}),n.x=e.x-o.x,n.y=e.y-o.y,n},c.mult=function(e,o){return{x:e.x*o,y:e.y*o}},c.div=function(e,o){return{x:e.x/o,y:e.y/o}},c.perp=function(e,o){return o=o===!0?-1:1,{x:o*-e.y,y:o*e.x}},c.neg=function(e){return{x:-e.x,y:-e.y}},c.angle=function(e,o){return Math.atan2(o.y-e.y,o.x-e.x)},c._temp=[c.create(),c.create(),c.create(),c.create(),c.create(),c.create()]}()},function(p,w,c){var e={};p.exports=e;var o=c(2),n=c(0);(function(){e.create=function(r,u){for(var l=[],f=0;f<r.length;f++){var s=r[f],t={x:s.x,y:s.y,index:f,body:u,isInternal:!1};l.push(t)}return l},e.fromPath=function(r,u){var l=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,f=[];return r.replace(l,function(s,t,i){f.push({x:parseFloat(t),y:parseFloat(i)})}),e.create(f,u)},e.centre=function(r){for(var u=e.area(r,!0),l={x:0,y:0},f,s,t,i=0;i<r.length;i++)t=(i+1)%r.length,f=o.cross(r[i],r[t]),s=o.mult(o.add(r[i],r[t]),f),l=o.add(l,s);return o.div(l,6*u)},e.mean=function(r){for(var u={x:0,y:0},l=0;l<r.length;l++)u.x+=r[l].x,u.y+=r[l].y;return o.div(u,r.length)},e.area=function(r,u){for(var l=0,f=r.length-1,s=0;s<r.length;s++)l+=(r[f].x-r[s].x)*(r[f].y+r[s].y),f=s;return u?l/2:Math.abs(l)/2},e.inertia=function(r,u){for(var l=0,f=0,s=r,t,i,a=0;a<s.length;a++)i=(a+1)%s.length,t=Math.abs(o.cross(s[i],s[a])),l+=t*(o.dot(s[i],s[i])+o.dot(s[i],s[a])+o.dot(s[a],s[a])),f+=t;return u/6*(l/f)},e.translate=function(r,u,l){l=typeof l<"u"?l:1;var f=r.length,s=u.x*l,t=u.y*l,i;for(i=0;i<f;i++)r[i].x+=s,r[i].y+=t;return r},e.rotate=function(r,u,l){if(u!==0){var f=Math.cos(u),s=Math.sin(u),t=l.x,i=l.y,a=r.length,d,g,P,S;for(S=0;S<a;S++)d=r[S],g=d.x-t,P=d.y-i,d.x=t+(g*f-P*s),d.y=i+(g*s+P*f);return r}},e.contains=function(r,u){for(var l=u.x,f=u.y,s=r.length,t=r[s-1],i,a=0;a<s;a++){if(i=r[a],(l-t.x)*(i.y-t.y)+(f-t.y)*(t.x-i.x)>0)return!1;t=i}return!0},e.scale=function(r,u,l,f){if(u===1&&l===1)return r;f=f||e.centre(r);for(var s,t,i=0;i<r.length;i++)s=r[i],t=o.sub(s,f),r[i].x=f.x+t.x*u,r[i].y=f.y+t.y*l;return r},e.chamfer=function(r,u,l,f,s){typeof u=="number"?u=[u]:u=u||[8],l=typeof l<"u"?l:-1,f=f||2,s=s||14;for(var t=[],i=0;i<r.length;i++){var a=r[i-1>=0?i-1:r.length-1],d=r[i],g=r[(i+1)%r.length],P=u[i<u.length?i:u.length-1];if(P===0){t.push(d);continue}var S=o.normalise({x:d.y-a.y,y:a.x-d.x}),h=o.normalise({x:g.y-d.y,y:d.x-g.x}),v=Math.sqrt(2*Math.pow(P,2)),y=o.mult(n.clone(S),P),x=o.normalise(o.mult(o.add(S,h),.5)),A=o.sub(d,o.mult(x,v)),M=l;l===-1&&(M=Math.pow(P,.32)*1.75),M=n.clamp(M,f,s),M%2===1&&(M+=1);for(var T=Math.acos(o.dot(S,h)),C=T/M,R=0;R<M;R++)t.push(o.add(o.rotate(y,C*R),A))}return t},e.clockwiseSort=function(r){var u=e.mean(r);return r.sort(function(l,f){return o.angle(u,l)-o.angle(u,f)}),r},e.isConvex=function(r){var u=0,l=r.length,f,s,t,i;if(l<3)return null;for(f=0;f<l;f++)if(s=(f+1)%l,t=(f+2)%l,i=(r[s].x-r[f].x)*(r[t].y-r[s].y),i-=(r[s].y-r[f].y)*(r[t].x-r[s].x),i<0?u|=1:i>0&&(u|=2),u===3)return!1;return u!==0?!0:null},e.hull=function(r){var u=[],l=[],f,s;for(r=r.slice(0),r.sort(function(t,i){var a=t.x-i.x;return a!==0?a:t.y-i.y}),s=0;s<r.length;s+=1){for(f=r[s];l.length>=2&&o.cross3(l[l.length-2],l[l.length-1],f)<=0;)l.pop();l.push(f)}for(s=r.length-1;s>=0;s-=1){for(f=r[s];u.length>=2&&o.cross3(u[u.length-2],u[u.length-1],f)<=0;)u.pop();u.push(f)}return u.pop(),l.pop(),u.concat(l)}})()},function(p,w,c){var e={};p.exports=e;var o=c(0);(function(){e.on=function(n,r,u){for(var l=r.split(" "),f,s=0;s<l.length;s++)f=l[s],n.events=n.events||{},n.events[f]=n.events[f]||[],n.events[f].push(u);return u},e.off=function(n,r,u){if(!r){n.events={};return}typeof r=="function"&&(u=r,r=o.keys(n.events).join(" "));for(var l=r.split(" "),f=0;f<l.length;f++){var s=n.events[l[f]],t=[];if(u&&s)for(var i=0;i<s.length;i++)s[i]!==u&&t.push(s[i]);n.events[l[f]]=t}},e.trigger=function(n,r,u){var l,f,s,t,i=n.events;if(i&&o.keys(i).length>0){u||(u={}),l=r.split(" ");for(var a=0;a<l.length;a++)if(f=l[a],s=i[f],s){t=o.clone(u,!1),t.name=f,t.source=n;for(var d=0;d<s.length;d++)s[d].apply(n,[t])}}}})()},function(p,w,c){var e={};p.exports=e;var o=c(4),n=c(0),r=c(1),u=c(6);(function(){e.create=function(l){return n.extend({id:n.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},l)},e.setModified=function(l,f,s,t){if(l.isModified=f,f&&l.cache&&(l.cache.allBodies=null,l.cache.allConstraints=null,l.cache.allComposites=null),s&&l.parent&&e.setModified(l.parent,f,s,t),t)for(var i=0;i<l.composites.length;i++){var a=l.composites[i];e.setModified(a,f,s,t)}},e.add=function(l,f){var s=[].concat(f);o.trigger(l,"beforeAdd",{object:f});for(var t=0;t<s.length;t++){var i=s[t];switch(i.type){case"body":if(i.parent!==i){n.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}e.addBody(l,i);break;case"constraint":e.addConstraint(l,i);break;case"composite":e.addComposite(l,i);break;case"mouseConstraint":e.addConstraint(l,i.constraint);break}}return o.trigger(l,"afterAdd",{object:f}),l},e.remove=function(l,f,s){var t=[].concat(f);o.trigger(l,"beforeRemove",{object:f});for(var i=0;i<t.length;i++){var a=t[i];switch(a.type){case"body":e.removeBody(l,a,s);break;case"constraint":e.removeConstraint(l,a,s);break;case"composite":e.removeComposite(l,a,s);break;case"mouseConstraint":e.removeConstraint(l,a.constraint);break}}return o.trigger(l,"afterRemove",{object:f}),l},e.addComposite=function(l,f){return l.composites.push(f),f.parent=l,e.setModified(l,!0,!0,!1),l},e.removeComposite=function(l,f,s){var t=n.indexOf(l.composites,f);if(t!==-1&&e.removeCompositeAt(l,t),s)for(var i=0;i<l.composites.length;i++)e.removeComposite(l.composites[i],f,!0);return l},e.removeCompositeAt=function(l,f){return l.composites.splice(f,1),e.setModified(l,!0,!0,!1),l},e.addBody=function(l,f){return l.bodies.push(f),e.setModified(l,!0,!0,!1),l},e.removeBody=function(l,f,s){var t=n.indexOf(l.bodies,f);if(t!==-1&&e.removeBodyAt(l,t),s)for(var i=0;i<l.composites.length;i++)e.removeBody(l.composites[i],f,!0);return l},e.removeBodyAt=function(l,f){return l.bodies.splice(f,1),e.setModified(l,!0,!0,!1),l},e.addConstraint=function(l,f){return l.constraints.push(f),e.setModified(l,!0,!0,!1),l},e.removeConstraint=function(l,f,s){var t=n.indexOf(l.constraints,f);if(t!==-1&&e.removeConstraintAt(l,t),s)for(var i=0;i<l.composites.length;i++)e.removeConstraint(l.composites[i],f,!0);return l},e.removeConstraintAt=function(l,f){return l.constraints.splice(f,1),e.setModified(l,!0,!0,!1),l},e.clear=function(l,f,s){if(s)for(var t=0;t<l.composites.length;t++)e.clear(l.composites[t],f,!0);return f?l.bodies=l.bodies.filter(function(i){return i.isStatic}):l.bodies.length=0,l.constraints.length=0,l.composites.length=0,e.setModified(l,!0,!0,!1),l},e.allBodies=function(l){if(l.cache&&l.cache.allBodies)return l.cache.allBodies;for(var f=[].concat(l.bodies),s=0;s<l.composites.length;s++)f=f.concat(e.allBodies(l.composites[s]));return l.cache&&(l.cache.allBodies=f),f},e.allConstraints=function(l){if(l.cache&&l.cache.allConstraints)return l.cache.allConstraints;for(var f=[].concat(l.constraints),s=0;s<l.composites.length;s++)f=f.concat(e.allConstraints(l.composites[s]));return l.cache&&(l.cache.allConstraints=f),f},e.allComposites=function(l){if(l.cache&&l.cache.allComposites)return l.cache.allComposites;for(var f=[].concat(l.composites),s=0;s<l.composites.length;s++)f=f.concat(e.allComposites(l.composites[s]));return l.cache&&(l.cache.allComposites=f),f},e.get=function(l,f,s){var t,i;switch(s){case"body":t=e.allBodies(l);break;case"constraint":t=e.allConstraints(l);break;case"composite":t=e.allComposites(l).concat(l);break}return t?(i=t.filter(function(a){return a.id.toString()===f.toString()}),i.length===0?null:i[0]):null},e.move=function(l,f,s){return e.remove(l,f),e.add(s,f),l},e.rebase=function(l){for(var f=e.allBodies(l).concat(e.allConstraints(l)).concat(e.allComposites(l)),s=0;s<f.length;s++)f[s].id=n.nextId();return l},e.translate=function(l,f,s){for(var t=s?e.allBodies(l):l.bodies,i=0;i<t.length;i++)u.translate(t[i],f);return l},e.rotate=function(l,f,s,t){for(var i=Math.cos(f),a=Math.sin(f),d=t?e.allBodies(l):l.bodies,g=0;g<d.length;g++){var P=d[g],S=P.position.x-s.x,h=P.position.y-s.y;u.setPosition(P,{x:s.x+(S*i-h*a),y:s.y+(S*a+h*i)}),u.rotate(P,f)}return l},e.scale=function(l,f,s,t,i){for(var a=i?e.allBodies(l):l.bodies,d=0;d<a.length;d++){var g=a[d],P=g.position.x-t.x,S=g.position.y-t.y;u.setPosition(g,{x:t.x+P*f,y:t.y+S*s}),u.scale(g,f,s)}return l},e.bounds=function(l){for(var f=e.allBodies(l),s=[],t=0;t<f.length;t+=1){var i=f[t];s.push(i.bounds.min,i.bounds.max)}return r.create(s)}})()},function(p,w,c){var e={};p.exports=e;var o=c(3),n=c(2),r=c(7);c(16);var u=c(0),l=c(1),f=c(11);(function(){e._inertiaScale=4,e._nextCollidingGroupId=1,e._nextNonCollidingGroupId=-1,e._nextCategory=1,e.create=function(t){var i={id:u.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:o.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,_original:null},a=u.extend(i,t);return s(a,t),a},e.nextGroup=function(t){return t?e._nextNonCollidingGroupId--:e._nextCollidingGroupId++},e.nextCategory=function(){return e._nextCategory=e._nextCategory<<1,e._nextCategory};var s=function(t,i){i=i||{},e.set(t,{bounds:t.bounds||l.create(t.vertices),positionPrev:t.positionPrev||n.clone(t.position),anglePrev:t.anglePrev||t.angle,vertices:t.vertices,parts:t.parts||[t],isStatic:t.isStatic,isSleeping:t.isSleeping,parent:t.parent||t}),o.rotate(t.vertices,t.angle,t.position),f.rotate(t.axes,t.angle),l.update(t.bounds,t.vertices,t.velocity),e.set(t,{axes:i.axes||t.axes,area:i.area||t.area,mass:i.mass||t.mass,inertia:i.inertia||t.inertia});var a=t.isStatic?"#14151f":u.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),d=t.isStatic?"#555":"#ccc",g=t.isStatic&&t.render.fillStyle===null?1:0;t.render.fillStyle=t.render.fillStyle||a,t.render.strokeStyle=t.render.strokeStyle||d,t.render.lineWidth=t.render.lineWidth||g,t.render.sprite.xOffset+=-(t.bounds.min.x-t.position.x)/(t.bounds.max.x-t.bounds.min.x),t.render.sprite.yOffset+=-(t.bounds.min.y-t.position.y)/(t.bounds.max.y-t.bounds.min.y)};e.set=function(t,i,a){var d;typeof i=="string"&&(d=i,i={},i[d]=a);for(d in i)if(!!Object.prototype.hasOwnProperty.call(i,d))switch(a=i[d],d){case"isStatic":e.setStatic(t,a);break;case"isSleeping":r.set(t,a);break;case"mass":e.setMass(t,a);break;case"density":e.setDensity(t,a);break;case"inertia":e.setInertia(t,a);break;case"vertices":e.setVertices(t,a);break;case"position":e.setPosition(t,a);break;case"angle":e.setAngle(t,a);break;case"velocity":e.setVelocity(t,a);break;case"angularVelocity":e.setAngularVelocity(t,a);break;case"parts":e.setParts(t,a);break;case"centre":e.setCentre(t,a);break;default:t[d]=a}},e.setStatic=function(t,i){for(var a=0;a<t.parts.length;a++){var d=t.parts[a];d.isStatic=i,i?(d._original={restitution:d.restitution,friction:d.friction,mass:d.mass,inertia:d.inertia,density:d.density,inverseMass:d.inverseMass,inverseInertia:d.inverseInertia},d.restitution=0,d.friction=1,d.mass=d.inertia=d.density=1/0,d.inverseMass=d.inverseInertia=0,d.positionPrev.x=d.position.x,d.positionPrev.y=d.position.y,d.anglePrev=d.angle,d.angularVelocity=0,d.speed=0,d.angularSpeed=0,d.motion=0):d._original&&(d.restitution=d._original.restitution,d.friction=d._original.friction,d.mass=d._original.mass,d.inertia=d._original.inertia,d.density=d._original.density,d.inverseMass=d._original.inverseMass,d.inverseInertia=d._original.inverseInertia,d._original=null)}},e.setMass=function(t,i){var a=t.inertia/(t.mass/6);t.inertia=a*(i/6),t.inverseInertia=1/t.inertia,t.mass=i,t.inverseMass=1/t.mass,t.density=t.mass/t.area},e.setDensity=function(t,i){e.setMass(t,i*t.area),t.density=i},e.setInertia=function(t,i){t.inertia=i,t.inverseInertia=1/t.inertia},e.setVertices=function(t,i){i[0].body===t?t.vertices=i:t.vertices=o.create(i,t),t.axes=f.fromVertices(t.vertices),t.area=o.area(t.vertices),e.setMass(t,t.density*t.area);var a=o.centre(t.vertices);o.translate(t.vertices,a,-1),e.setInertia(t,e._inertiaScale*o.inertia(t.vertices,t.mass)),o.translate(t.vertices,t.position),l.update(t.bounds,t.vertices,t.velocity)},e.setParts=function(t,i,a){var d;for(i=i.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,d=0;d<i.length;d++){var g=i[d];g!==t&&(g.parent=t,t.parts.push(g))}if(t.parts.length!==1){if(a=typeof a<"u"?a:!0,a){var P=[];for(d=0;d<i.length;d++)P=P.concat(i[d].vertices);o.clockwiseSort(P);var S=o.hull(P),h=o.centre(S);e.setVertices(t,S),o.translate(t.vertices,h)}var v=e._totalProperties(t);t.area=v.area,t.parent=t,t.position.x=v.centre.x,t.position.y=v.centre.y,t.positionPrev.x=v.centre.x,t.positionPrev.y=v.centre.y,e.setMass(t,v.mass),e.setInertia(t,v.inertia),e.setPosition(t,v.centre)}},e.setCentre=function(t,i,a){a?(t.positionPrev.x+=i.x,t.positionPrev.y+=i.y,t.position.x+=i.x,t.position.y+=i.y):(t.positionPrev.x=i.x-(t.position.x-t.positionPrev.x),t.positionPrev.y=i.y-(t.position.y-t.positionPrev.y),t.position.x=i.x,t.position.y=i.y)},e.setPosition=function(t,i){var a=n.sub(i,t.position);t.positionPrev.x+=a.x,t.positionPrev.y+=a.y;for(var d=0;d<t.parts.length;d++){var g=t.parts[d];g.position.x+=a.x,g.position.y+=a.y,o.translate(g.vertices,a),l.update(g.bounds,g.vertices,t.velocity)}},e.setAngle=function(t,i){var a=i-t.angle;t.anglePrev+=a;for(var d=0;d<t.parts.length;d++){var g=t.parts[d];g.angle+=a,o.rotate(g.vertices,a,t.position),f.rotate(g.axes,a),l.update(g.bounds,g.vertices,t.velocity),d>0&&n.rotateAbout(g.position,a,t.position,g.position)}},e.setVelocity=function(t,i){t.positionPrev.x=t.position.x-i.x,t.positionPrev.y=t.position.y-i.y,t.velocity.x=i.x,t.velocity.y=i.y,t.speed=n.magnitude(t.velocity)},e.setAngularVelocity=function(t,i){t.anglePrev=t.angle-i,t.angularVelocity=i,t.angularSpeed=Math.abs(t.angularVelocity)},e.translate=function(t,i){e.setPosition(t,n.add(t.position,i))},e.rotate=function(t,i,a){if(!a)e.setAngle(t,t.angle+i);else{var d=Math.cos(i),g=Math.sin(i),P=t.position.x-a.x,S=t.position.y-a.y;e.setPosition(t,{x:a.x+(P*d-S*g),y:a.y+(P*g+S*d)}),e.setAngle(t,t.angle+i)}},e.scale=function(t,i,a,d){var g=0,P=0;d=d||t.position;for(var S=0;S<t.parts.length;S++){var h=t.parts[S];o.scale(h.vertices,i,a,d),h.axes=f.fromVertices(h.vertices),h.area=o.area(h.vertices),e.setMass(h,t.density*h.area),o.translate(h.vertices,{x:-h.position.x,y:-h.position.y}),e.setInertia(h,e._inertiaScale*o.inertia(h.vertices,h.mass)),o.translate(h.vertices,{x:h.position.x,y:h.position.y}),S>0&&(g+=h.area,P+=h.inertia),h.position.x=d.x+(h.position.x-d.x)*i,h.position.y=d.y+(h.position.y-d.y)*a,l.update(h.bounds,h.vertices,t.velocity)}t.parts.length>1&&(t.area=g,t.isStatic||(e.setMass(t,t.density*g),e.setInertia(t,P))),t.circleRadius&&(i===a?t.circleRadius*=i:t.circleRadius=null)},e.update=function(t,i,a,d){var g=Math.pow(i*a*t.timeScale,2),P=1-t.frictionAir*a*t.timeScale,S=t.position.x-t.positionPrev.x,h=t.position.y-t.positionPrev.y;t.velocity.x=S*P*d+t.force.x/t.mass*g,t.velocity.y=h*P*d+t.force.y/t.mass*g,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.angularVelocity=(t.angle-t.anglePrev)*P*d+t.torque/t.inertia*g,t.anglePrev=t.angle,t.angle+=t.angularVelocity,t.speed=n.magnitude(t.velocity),t.angularSpeed=Math.abs(t.angularVelocity);for(var v=0;v<t.parts.length;v++){var y=t.parts[v];o.translate(y.vertices,t.velocity),v>0&&(y.position.x+=t.velocity.x,y.position.y+=t.velocity.y),t.angularVelocity!==0&&(o.rotate(y.vertices,t.angularVelocity,t.position),f.rotate(y.axes,t.angularVelocity),v>0&&n.rotateAbout(y.position,t.angularVelocity,t.position,y.position)),l.update(y.bounds,y.vertices,t.velocity)}},e.applyForce=function(t,i,a){t.force.x+=a.x,t.force.y+=a.y;var d={x:i.x-t.position.x,y:i.y-t.position.y};t.torque+=d.x*a.y-d.y*a.x},e._totalProperties=function(t){for(var i={mass:0,area:0,inertia:0,centre:{x:0,y:0}},a=t.parts.length===1?0:1;a<t.parts.length;a++){var d=t.parts[a],g=d.mass!==1/0?d.mass:1;i.mass+=g,i.area+=d.area,i.inertia+=d.inertia,i.centre=n.add(i.centre,n.mult(d.position,g))}return i.centre=n.div(i.centre,i.mass),i}})()},function(p,w,c){var e={};p.exports=e;var o=c(4);(function(){e._motionWakeThreshold=.18,e._motionSleepThreshold=.08,e._minBias=.9,e.update=function(n,r){for(var u=r*r*r,l=0;l<n.length;l++){var f=n[l],s=f.speed*f.speed+f.angularSpeed*f.angularSpeed;if(f.force.x!==0||f.force.y!==0){e.set(f,!1);continue}var t=Math.min(f.motion,s),i=Math.max(f.motion,s);f.motion=e._minBias*t+(1-e._minBias)*i,f.sleepThreshold>0&&f.motion<e._motionSleepThreshold*u?(f.sleepCounter+=1,f.sleepCounter>=f.sleepThreshold&&e.set(f,!0)):f.sleepCounter>0&&(f.sleepCounter-=1)}},e.afterCollisions=function(n,r){for(var u=r*r*r,l=0;l<n.length;l++){var f=n[l];if(!!f.isActive){var s=f.collision,t=s.bodyA.parent,i=s.bodyB.parent;if(!(t.isSleeping&&i.isSleeping||t.isStatic||i.isStatic)&&(t.isSleeping||i.isSleeping)){var a=t.isSleeping&&!t.isStatic?t:i,d=a===t?i:t;!a.isStatic&&d.motion>e._motionWakeThreshold*u&&e.set(a,!1)}}}},e.set=function(n,r){var u=n.isSleeping;r?(n.isSleeping=!0,n.sleepCounter=n.sleepThreshold,n.positionImpulse.x=0,n.positionImpulse.y=0,n.positionPrev.x=n.position.x,n.positionPrev.y=n.position.y,n.anglePrev=n.angle,n.speed=0,n.angularSpeed=0,n.motion=0,u||o.trigger(n,"sleepStart")):(n.isSleeping=!1,n.sleepCounter=0,u&&o.trigger(n,"sleepEnd"))}})()},function(p,w,c){var e={};p.exports=e;var o=c(3),n=c(9);(function(){var r=[],u={overlap:0,axis:null},l={overlap:0,axis:null};e.create=function(f,s){return{pair:null,collided:!1,bodyA:f,bodyB:s,parentA:f.parent,parentB:s.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},e.collides=function(f,s,t){if(e._overlapAxes(u,f.vertices,s.vertices,f.axes),u.overlap<=0||(e._overlapAxes(l,s.vertices,f.vertices,s.axes),l.overlap<=0))return null;var i=t&&t.table[n.id(f,s)],a;i?a=i.collision:(a=e.create(f,s),a.collided=!0,a.bodyA=f.id<s.id?f:s,a.bodyB=f.id<s.id?s:f,a.parentA=a.bodyA.parent,a.parentB=a.bodyB.parent),f=a.bodyA,s=a.bodyB;var d;u.overlap<l.overlap?d=u:d=l;var g=a.normal,P=a.supports,S=d.axis,h=S.x,v=S.y;h*(s.position.x-f.position.x)+v*(s.position.y-f.position.y)<0?(g.x=h,g.y=v):(g.x=-h,g.y=-v),a.tangent.x=-g.y,a.tangent.y=g.x,a.depth=d.overlap,a.penetration.x=g.x*a.depth,a.penetration.y=g.y*a.depth;var y=e._findSupports(f,s,g,1),x=0;if(o.contains(f.vertices,y[0])&&(P[x++]=y[0]),o.contains(f.vertices,y[1])&&(P[x++]=y[1]),x<2){var A=e._findSupports(s,f,g,-1);o.contains(s.vertices,A[0])&&(P[x++]=A[0]),x<2&&o.contains(s.vertices,A[1])&&(P[x++]=A[1])}return x===0&&(P[x++]=y[0]),P.length=x,a},e._overlapAxes=function(f,s,t,i){var a=s.length,d=t.length,g=s[0].x,P=s[0].y,S=t[0].x,h=t[0].y,v=i.length,y=Number.MAX_VALUE,x=0,A,M,T,C,R,E;for(R=0;R<v;R++){var V=i[R],L=V.x,F=V.y,B=g*L+P*F,O=S*L+h*F,b=B,D=O;for(E=1;E<a;E+=1)C=s[E].x*L+s[E].y*F,C>b?b=C:C<B&&(B=C);for(E=1;E<d;E+=1)C=t[E].x*L+t[E].y*F,C>D?D=C:C<O&&(O=C);if(M=b-O,T=D-B,A=M<T?M:T,A<y&&(y=A,x=R,A<=0))break}f.axis=i[x],f.overlap=y},e._projectToAxis=function(f,s,t){for(var i=s[0].x*t.x+s[0].y*t.y,a=i,d=1;d<s.length;d+=1){var g=s[d].x*t.x+s[d].y*t.y;g>a?a=g:g<i&&(i=g)}f.min=i,f.max=a},e._findSupports=function(f,s,t,i){var a=s.vertices,d=a.length,g=f.position.x,P=f.position.y,S=t.x*i,h=t.y*i,v=Number.MAX_VALUE,y,x,A,M,T;for(T=0;T<d;T+=1)x=a[T],M=S*(g-x.x)+h*(P-x.y),M<v&&(v=M,y=x);return A=a[(d+y.index-1)%d],v=S*(g-A.x)+h*(P-A.y),x=a[(y.index+1)%d],S*(g-x.x)+h*(P-x.y)<v?(r[0]=y,r[1]=x,r):(r[0]=y,r[1]=A,r)}})()},function(p,w,c){var e={};p.exports=e;var o=c(17);(function(){e.create=function(n,r){var u=n.bodyA,l=n.bodyB,f={id:e.id(u,l),bodyA:u,bodyB:l,collision:n,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:u.isSensor||l.isSensor,timeCreated:r,timeUpdated:r,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return e.update(f,n,r),f},e.update=function(n,r,u){var l=n.contacts,f=r.supports,s=n.activeContacts,t=r.parentA,i=r.parentB,a=t.vertices.length;n.isActive=!0,n.timeUpdated=u,n.collision=r,n.separation=r.depth,n.inverseMass=t.inverseMass+i.inverseMass,n.friction=t.friction<i.friction?t.friction:i.friction,n.frictionStatic=t.frictionStatic>i.frictionStatic?t.frictionStatic:i.frictionStatic,n.restitution=t.restitution>i.restitution?t.restitution:i.restitution,n.slop=t.slop>i.slop?t.slop:i.slop,r.pair=n,s.length=0;for(var d=0;d<f.length;d++){var g=f[d],P=g.body===t?g.index:a+g.index,S=l[P];S?s.push(S):s.push(l[P]=o.create(g))}},e.setActive=function(n,r,u){r?(n.isActive=!0,n.timeUpdated=u):(n.isActive=!1,n.activeContacts.length=0)},e.id=function(n,r){return n.id<r.id?"A"+n.id+"B"+r.id:"A"+r.id+"B"+n.id}})()},function(p,w,c){var e={};p.exports=e;var o=c(3),n=c(2),r=c(7),u=c(1),l=c(11),f=c(0);(function(){e._warming=.4,e._torqueDampen=1,e._minLength=1e-6,e.create=function(s){var t=s;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var i=t.bodyA?n.add(t.bodyA.position,t.pointA):t.pointA,a=t.bodyB?n.add(t.bodyB.position,t.pointB):t.pointB,d=n.magnitude(n.sub(i,a));t.length=typeof t.length<"u"?t.length:d,t.id=t.id||f.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(t.length>0?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var g={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return t.length===0&&t.stiffness>.1?(g.type="pin",g.anchors=!1):t.stiffness<.9&&(g.type="spring"),t.render=f.extend(g,t.render),t},e.preSolveAll=function(s){for(var t=0;t<s.length;t+=1){var i=s[t],a=i.constraintImpulse;i.isStatic||a.x===0&&a.y===0&&a.angle===0||(i.position.x+=a.x,i.position.y+=a.y,i.angle+=a.angle)}},e.solveAll=function(s,t){for(var i=0;i<s.length;i+=1){var a=s[i],d=!a.bodyA||a.bodyA&&a.bodyA.isStatic,g=!a.bodyB||a.bodyB&&a.bodyB.isStatic;(d||g)&&e.solve(s[i],t)}for(i=0;i<s.length;i+=1)a=s[i],d=!a.bodyA||a.bodyA&&a.bodyA.isStatic,g=!a.bodyB||a.bodyB&&a.bodyB.isStatic,!d&&!g&&e.solve(s[i],t)},e.solve=function(s,t){var i=s.bodyA,a=s.bodyB,d=s.pointA,g=s.pointB;if(!(!i&&!a)){i&&!i.isStatic&&(n.rotate(d,i.angle-s.angleA,d),s.angleA=i.angle),a&&!a.isStatic&&(n.rotate(g,a.angle-s.angleB,g),s.angleB=a.angle);var P=d,S=g;if(i&&(P=n.add(i.position,d)),a&&(S=n.add(a.position,g)),!(!P||!S)){var h=n.sub(P,S),v=n.magnitude(h);v<e._minLength&&(v=e._minLength);var y=(v-s.length)/v,x=s.stiffness<1?s.stiffness*t:s.stiffness,A=n.mult(h,y*x),M=(i?i.inverseMass:0)+(a?a.inverseMass:0),T=(i?i.inverseInertia:0)+(a?a.inverseInertia:0),C=M+T,R,E,V,L,F;if(s.damping){var B=n.create();V=n.div(h,v),F=n.sub(a&&n.sub(a.position,a.positionPrev)||B,i&&n.sub(i.position,i.positionPrev)||B),L=n.dot(V,F)}i&&!i.isStatic&&(E=i.inverseMass/M,i.constraintImpulse.x-=A.x*E,i.constraintImpulse.y-=A.y*E,i.position.x-=A.x*E,i.position.y-=A.y*E,s.damping&&(i.positionPrev.x-=s.damping*V.x*L*E,i.positionPrev.y-=s.damping*V.y*L*E),R=n.cross(d,A)/C*e._torqueDampen*i.inverseInertia*(1-s.angularStiffness),i.constraintImpulse.angle-=R,i.angle-=R),a&&!a.isStatic&&(E=a.inverseMass/M,a.constraintImpulse.x+=A.x*E,a.constraintImpulse.y+=A.y*E,a.position.x+=A.x*E,a.position.y+=A.y*E,s.damping&&(a.positionPrev.x+=s.damping*V.x*L*E,a.positionPrev.y+=s.damping*V.y*L*E),R=n.cross(g,A)/C*e._torqueDampen*a.inverseInertia*(1-s.angularStiffness),a.constraintImpulse.angle+=R,a.angle+=R)}}},e.postSolveAll=function(s){for(var t=0;t<s.length;t++){var i=s[t],a=i.constraintImpulse;if(!(i.isStatic||a.x===0&&a.y===0&&a.angle===0)){r.set(i,!1);for(var d=0;d<i.parts.length;d++){var g=i.parts[d];o.translate(g.vertices,a),d>0&&(g.position.x+=a.x,g.position.y+=a.y),a.angle!==0&&(o.rotate(g.vertices,a.angle,i.position),l.rotate(g.axes,a.angle),d>0&&n.rotateAbout(g.position,a.angle,i.position,g.position)),u.update(g.bounds,g.vertices,i.velocity)}a.angle*=e._warming,a.x*=e._warming,a.y*=e._warming}}},e.pointAWorld=function(s){return{x:(s.bodyA?s.bodyA.position.x:0)+s.pointA.x,y:(s.bodyA?s.bodyA.position.y:0)+s.pointA.y}},e.pointBWorld=function(s){return{x:(s.bodyB?s.bodyB.position.x:0)+s.pointB.x,y:(s.bodyB?s.bodyB.position.y:0)+s.pointB.y}}})()},function(p,w,c){var e={};p.exports=e;var o=c(2),n=c(0);(function(){e.fromVertices=function(r){for(var u={},l=0;l<r.length;l++){var f=(l+1)%r.length,s=o.normalise({x:r[f].y-r[l].y,y:r[l].x-r[f].x}),t=s.y===0?1/0:s.x/s.y;t=t.toFixed(3).toString(),u[t]=s}return n.values(u)},e.rotate=function(r,u){if(u!==0)for(var l=Math.cos(u),f=Math.sin(u),s=0;s<r.length;s++){var t=r[s],i;i=t.x*l-t.y*f,t.y=t.x*f+t.y*l,t.x=i}}})()},function(p,w,c){var e={};p.exports=e;var o=c(3),n=c(0),r=c(6),u=c(1),l=c(2);(function(){e.rectangle=function(f,s,t,i,a){a=a||{};var d={label:"Rectangle Body",position:{x:f,y:s},vertices:o.fromPath("L 0 0 L "+t+" 0 L "+t+" "+i+" L 0 "+i)};if(a.chamfer){var g=a.chamfer;d.vertices=o.chamfer(d.vertices,g.radius,g.quality,g.qualityMin,g.qualityMax),delete a.chamfer}return r.create(n.extend({},d,a))},e.trapezoid=function(f,s,t,i,a,d){d=d||{},a*=.5;var g=(1-a*2)*t,P=t*a,S=P+g,h=S+P,v;a<.5?v="L 0 0 L "+P+" "+-i+" L "+S+" "+-i+" L "+h+" 0":v="L 0 0 L "+S+" "+-i+" L "+h+" 0";var y={label:"Trapezoid Body",position:{x:f,y:s},vertices:o.fromPath(v)};if(d.chamfer){var x=d.chamfer;y.vertices=o.chamfer(y.vertices,x.radius,x.quality,x.qualityMin,x.qualityMax),delete d.chamfer}return r.create(n.extend({},y,d))},e.circle=function(f,s,t,i,a){i=i||{};var d={label:"Circle Body",circleRadius:t};a=a||25;var g=Math.ceil(Math.max(10,Math.min(a,t)));return g%2===1&&(g+=1),e.polygon(f,s,g,t,n.extend({},d,i))},e.polygon=function(f,s,t,i,a){if(a=a||{},t<3)return e.circle(f,s,i,a);for(var d=2*Math.PI/t,g="",P=d*.5,S=0;S<t;S+=1){var h=P+S*d,v=Math.cos(h)*i,y=Math.sin(h)*i;g+="L "+v.toFixed(3)+" "+y.toFixed(3)+" "}var x={label:"Polygon Body",position:{x:f,y:s},vertices:o.fromPath(g)};if(a.chamfer){var A=a.chamfer;x.vertices=o.chamfer(x.vertices,A.radius,A.quality,A.qualityMin,A.qualityMax),delete a.chamfer}return r.create(n.extend({},x,a))},e.fromVertices=function(f,s,t,i,a,d,g,P){var S=n.getDecomp(),h,v,y,x,A,M,T,C,R,E,V;for(h=Boolean(S&&S.quickDecomp),i=i||{},y=[],a=typeof a<"u"?a:!1,d=typeof d<"u"?d:.01,g=typeof g<"u"?g:10,P=typeof P<"u"?P:.01,n.isArray(t[0])||(t=[t]),E=0;E<t.length;E+=1)if(M=t[E],x=o.isConvex(M),A=!x,A&&!h&&n.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),x||!h)x?M=o.clockwiseSort(M):M=o.hull(M),y.push({position:{x:f,y:s},vertices:M});else{var L=M.map(function(N){return[N.x,N.y]});S.makeCCW(L),d!==!1&&S.removeCollinearPoints(L,d),P!==!1&&S.removeDuplicatePoints&&S.removeDuplicatePoints(L,P);var F=S.quickDecomp(L);for(T=0;T<F.length;T++){var B=F[T],O=B.map(function(N){return{x:N[0],y:N[1]}});g>0&&o.area(O)<g||y.push({position:o.centre(O),vertices:O})}}for(T=0;T<y.length;T++)y[T]=r.create(n.extend(y[T],i));if(a){var b=5;for(T=0;T<y.length;T++){var D=y[T];for(C=T+1;C<y.length;C++){var k=y[C];if(u.overlaps(D.bounds,k.bounds)){var W=D.vertices,z=k.vertices;for(R=0;R<D.vertices.length;R++)for(V=0;V<k.vertices.length;V++){var Z=l.magnitudeSquared(l.sub(W[(R+1)%W.length],z[V])),G=l.magnitudeSquared(l.sub(W[R],z[(V+1)%z.length]));Z<b&&G<b&&(W[R].isInternal=!0,z[V].isInternal=!0)}}}}}return y.length>1?(v=r.create(n.extend({parts:y.slice(0)},i)),r.setPosition(v,{x:f,y:s}),v):y[0]}})()},function(p,w,c){var e={};p.exports=e;var o=c(0);(function(){e.create=function(n){var r={};return n||o.log("Mouse.create: element was undefined, defaulting to document.body","warn"),r.element=n||document.body,r.absolute={x:0,y:0},r.position={x:0,y:0},r.mousedownPosition={x:0,y:0},r.mouseupPosition={x:0,y:0},r.offset={x:0,y:0},r.scale={x:1,y:1},r.wheelDelta=0,r.button=-1,r.pixelRatio=parseInt(r.element.getAttribute("data-pixel-ratio"),10)||1,r.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},r.mousemove=function(u){var l=e._getRelativeMousePosition(u,r.element,r.pixelRatio),f=u.changedTouches;f&&(r.button=0,u.preventDefault()),r.absolute.x=l.x,r.absolute.y=l.y,r.position.x=r.absolute.x*r.scale.x+r.offset.x,r.position.y=r.absolute.y*r.scale.y+r.offset.y,r.sourceEvents.mousemove=u},r.mousedown=function(u){var l=e._getRelativeMousePosition(u,r.element,r.pixelRatio),f=u.changedTouches;f?(r.button=0,u.preventDefault()):r.button=u.button,r.absolute.x=l.x,r.absolute.y=l.y,r.position.x=r.absolute.x*r.scale.x+r.offset.x,r.position.y=r.absolute.y*r.scale.y+r.offset.y,r.mousedownPosition.x=r.position.x,r.mousedownPosition.y=r.position.y,r.sourceEvents.mousedown=u},r.mouseup=function(u){var l=e._getRelativeMousePosition(u,r.element,r.pixelRatio),f=u.changedTouches;f&&u.preventDefault(),r.button=-1,r.absolute.x=l.x,r.absolute.y=l.y,r.position.x=r.absolute.x*r.scale.x+r.offset.x,r.position.y=r.absolute.y*r.scale.y+r.offset.y,r.mouseupPosition.x=r.position.x,r.mouseupPosition.y=r.position.y,r.sourceEvents.mouseup=u},r.mousewheel=function(u){r.wheelDelta=Math.max(-1,Math.min(1,u.wheelDelta||-u.detail)),u.preventDefault()},e.setElement(r,r.element),r},e.setElement=function(n,r){n.element=r,r.addEventListener("mousemove",n.mousemove),r.addEventListener("mousedown",n.mousedown),r.addEventListener("mouseup",n.mouseup),r.addEventListener("mousewheel",n.mousewheel),r.addEventListener("DOMMouseScroll",n.mousewheel),r.addEventListener("touchmove",n.mousemove),r.addEventListener("touchstart",n.mousedown),r.addEventListener("touchend",n.mouseup)},e.clearSourceEvents=function(n){n.sourceEvents.mousemove=null,n.sourceEvents.mousedown=null,n.sourceEvents.mouseup=null,n.sourceEvents.mousewheel=null,n.wheelDelta=0},e.setOffset=function(n,r){n.offset.x=r.x,n.offset.y=r.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y},e.setScale=function(n,r){n.scale.x=r.x,n.scale.y=r.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y},e._getRelativeMousePosition=function(n,r,u){var l=r.getBoundingClientRect(),f=document.documentElement||document.body.parentNode||document.body,s=window.pageXOffset!==void 0?window.pageXOffset:f.scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:f.scrollTop,i=n.changedTouches,a,d;return i?(a=i[0].pageX-l.left-s,d=i[0].pageY-l.top-t):(a=n.pageX-l.left-s,d=n.pageY-l.top-t),{x:a/(r.clientWidth/(r.width||r.clientWidth)*u),y:d/(r.clientHeight/(r.height||r.clientHeight)*u)}}})()},function(p,w,c){var e={};p.exports=e;var o=c(0),n=c(8);(function(){e.create=function(r){var u={bodies:[],pairs:null};return o.extend(u,r)},e.setBodies=function(r,u){r.bodies=u.slice(0)},e.clear=function(r){r.bodies=[]},e.collisions=function(r){var u=[],l=r.pairs,f=r.bodies,s=f.length,t=e.canCollide,i=n.collides,a,d;for(f.sort(e._compareBoundsX),a=0;a<s;a++){var g=f[a],P=g.bounds,S=g.bounds.max.x,h=g.bounds.max.y,v=g.bounds.min.y,y=g.isStatic||g.isSleeping,x=g.parts.length,A=x===1;for(d=a+1;d<s;d++){var M=f[d],T=M.bounds;if(T.min.x>S)break;if(!(h<T.min.y||v>T.max.y)&&!(y&&(M.isStatic||M.isSleeping))&&!!t(g.collisionFilter,M.collisionFilter)){var C=M.parts.length;if(A&&C===1){var R=i(g,M,l);R&&u.push(R)}else for(var E=x>1?1:0,V=C>1?1:0,L=E;L<x;L++)for(var F=g.parts[L],P=F.bounds,B=V;B<C;B++){var O=M.parts[B],T=O.bounds;if(!(P.min.x>T.max.x||P.max.x<T.min.x||P.max.y<T.min.y||P.min.y>T.max.y)){var R=i(F,O,l);R&&u.push(R)}}}}}return u},e.canCollide=function(r,u){return r.group===u.group&&r.group!==0?r.group>0:(r.mask&u.category)!==0&&(u.mask&r.category)!==0},e._compareBoundsX=function(r,u){return r.bounds.min.x-u.bounds.min.x}})()},function(p,w,c){var e={};p.exports=e;var o=c(0);(function(){e._registry={},e.register=function(n){if(e.isPlugin(n)||o.warn("Plugin.register:",e.toString(n),"does not implement all required fields."),n.name in e._registry){var r=e._registry[n.name],u=e.versionParse(n.version).number,l=e.versionParse(r.version).number;u>l?(o.warn("Plugin.register:",e.toString(r),"was upgraded to",e.toString(n)),e._registry[n.name]=n):u<l?o.warn("Plugin.register:",e.toString(r),"can not be downgraded to",e.toString(n)):n!==r&&o.warn("Plugin.register:",e.toString(n),"is already registered to different plugin object")}else e._registry[n.name]=n;return n},e.resolve=function(n){return e._registry[e.dependencyParse(n).name]},e.toString=function(n){return typeof n=="string"?n:(n.name||"anonymous")+"@"+(n.version||n.range||"0.0.0")},e.isPlugin=function(n){return n&&n.name&&n.version&&n.install},e.isUsed=function(n,r){return n.used.indexOf(r)>-1},e.isFor=function(n,r){var u=n.for&&e.dependencyParse(n.for);return!n.for||r.name===u.name&&e.versionSatisfies(r.version,u.range)},e.use=function(n,r){if(n.uses=(n.uses||[]).concat(r||[]),n.uses.length===0){o.warn("Plugin.use:",e.toString(n),"does not specify any dependencies to install.");return}for(var u=e.dependencies(n),l=o.topologicalSort(u),f=[],s=0;s<l.length;s+=1)if(l[s]!==n.name){var t=e.resolve(l[s]);if(!t){f.push("\u274C "+l[s]);continue}e.isUsed(n,t.name)||(e.isFor(t,n)||(o.warn("Plugin.use:",e.toString(t),"is for",t.for,"but installed on",e.toString(n)+"."),t._warned=!0),t.install?t.install(n):(o.warn("Plugin.use:",e.toString(t),"does not specify an install function."),t._warned=!0),t._warned?(f.push("\u{1F536} "+e.toString(t)),delete t._warned):f.push("\u2705 "+e.toString(t)),n.used.push(t.name))}f.length>0&&o.info(f.join("  "))},e.dependencies=function(n,r){var u=e.dependencyParse(n),l=u.name;if(r=r||{},!(l in r)){n=e.resolve(n)||n,r[l]=o.map(n.uses||[],function(s){e.isPlugin(s)&&e.register(s);var t=e.dependencyParse(s),i=e.resolve(s);return i&&!e.versionSatisfies(i.version,t.range)?(o.warn("Plugin.dependencies:",e.toString(i),"does not satisfy",e.toString(t),"used by",e.toString(u)+"."),i._warned=!0,n._warned=!0):i||(o.warn("Plugin.dependencies:",e.toString(s),"used by",e.toString(u),"could not be resolved."),n._warned=!0),t.name});for(var f=0;f<r[l].length;f+=1)e.dependencies(r[l][f],r);return r}},e.dependencyParse=function(n){if(o.isString(n)){var r=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return r.test(n)||o.warn("Plugin.dependencyParse:",n,"is not a valid dependency string."),{name:n.split("@")[0],range:n.split("@")[1]||"*"}}return{name:n.name,range:n.range||n.version}},e.versionParse=function(n){var r=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;r.test(n)||o.warn("Plugin.versionParse:",n,"is not a valid version or range.");var u=r.exec(n),l=Number(u[4]),f=Number(u[5]),s=Number(u[6]);return{isRange:Boolean(u[1]||u[2]),version:u[3],range:n,operator:u[1]||u[2]||"",major:l,minor:f,patch:s,parts:[l,f,s],prerelease:u[7],number:l*1e8+f*1e4+s}},e.versionSatisfies=function(n,r){r=r||"*";var u=e.versionParse(r),l=e.versionParse(n);if(u.isRange){if(u.operator==="*"||n==="*")return!0;if(u.operator===">")return l.number>u.number;if(u.operator===">=")return l.number>=u.number;if(u.operator==="~")return l.major===u.major&&l.minor===u.minor&&l.patch>=u.patch;if(u.operator==="^")return u.major>0?l.major===u.major&&l.number>=u.number:u.minor>0?l.minor===u.minor&&l.patch>=u.patch:l.patch===u.patch}return n===r||n==="*"}})()},function(p,w,c){var e={};p.exports=e;var o=c(0),n=c(5),r=c(1),u=c(4),l=c(2),f=c(13);(function(){var s,t;typeof window<"u"&&(s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(h){window.setTimeout(function(){h(o.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),e._goodFps=30,e._goodDelta=1e3/60,e.create=function(h){var v={controller:e,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!h.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},y=o.extend(v,h);return y.canvas&&(y.canvas.width=y.options.width||y.canvas.width,y.canvas.height=y.options.height||y.canvas.height),y.mouse=h.mouse,y.engine=h.engine,y.canvas=y.canvas||d(y.options.width,y.options.height),y.context=y.canvas.getContext("2d"),y.textures={},y.bounds=y.bounds||{min:{x:0,y:0},max:{x:y.canvas.width,y:y.canvas.height}},y.options.showBroadphase=!1,y.options.pixelRatio!==1&&e.setPixelRatio(y,y.options.pixelRatio),o.isElement(y.element)?y.element.appendChild(y.canvas):y.canvas.parentNode||o.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),y},e.run=function(h){(function v(y){h.frameRequestId=s(v),i(h,y),e.world(h,y),(h.options.showStats||h.options.showDebug)&&e.stats(h,h.context,y),(h.options.showPerformance||h.options.showDebug)&&e.performance(h,h.context,y)})()},e.stop=function(h){t(h.frameRequestId)},e.setPixelRatio=function(h,v){var y=h.options,x=h.canvas;v==="auto"&&(v=g(x)),y.pixelRatio=v,x.setAttribute("data-pixel-ratio",v),x.width=y.width*v,x.height=y.height*v,x.style.width=y.width+"px",x.style.height=y.height+"px"},e.lookAt=function(h,v,y,x){x=typeof x<"u"?x:!0,v=o.isArray(v)?v:[v],y=y||{x:0,y:0};for(var A={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},M=0;M<v.length;M+=1){var T=v[M],C=T.bounds?T.bounds.min:T.min||T.position||T,R=T.bounds?T.bounds.max:T.max||T.position||T;C&&R&&(C.x<A.min.x&&(A.min.x=C.x),R.x>A.max.x&&(A.max.x=R.x),C.y<A.min.y&&(A.min.y=C.y),R.y>A.max.y&&(A.max.y=R.y))}var E=A.max.x-A.min.x+2*y.x,V=A.max.y-A.min.y+2*y.y,L=h.canvas.height,F=h.canvas.width,B=F/L,O=E/V,b=1,D=1;O>B?D=O/B:b=B/O,h.options.hasBounds=!0,h.bounds.min.x=A.min.x,h.bounds.max.x=A.min.x+E*b,h.bounds.min.y=A.min.y,h.bounds.max.y=A.min.y+V*D,x&&(h.bounds.min.x+=E*.5-E*b*.5,h.bounds.max.x+=E*.5-E*b*.5,h.bounds.min.y+=V*.5-V*D*.5,h.bounds.max.y+=V*.5-V*D*.5),h.bounds.min.x-=y.x,h.bounds.max.x-=y.x,h.bounds.min.y-=y.y,h.bounds.max.y-=y.y,h.mouse&&(f.setScale(h.mouse,{x:(h.bounds.max.x-h.bounds.min.x)/h.canvas.width,y:(h.bounds.max.y-h.bounds.min.y)/h.canvas.height}),f.setOffset(h.mouse,h.bounds.min))},e.startViewTransform=function(h){var v=h.bounds.max.x-h.bounds.min.x,y=h.bounds.max.y-h.bounds.min.y,x=v/h.options.width,A=y/h.options.height;h.context.setTransform(h.options.pixelRatio/x,0,0,h.options.pixelRatio/A,0,0),h.context.translate(-h.bounds.min.x,-h.bounds.min.y)},e.endViewTransform=function(h){h.context.setTransform(h.options.pixelRatio,0,0,h.options.pixelRatio,0,0)},e.world=function(h,v){var y=o.now(),x=h.engine,A=x.world,M=h.canvas,T=h.context,C=h.options,R=h.timing,E=n.allBodies(A),V=n.allConstraints(A),L=C.wireframes?C.wireframeBackground:C.background,F=[],B=[],O,b={timestamp:x.timing.timestamp};if(u.trigger(h,"beforeRender",b),h.currentBackground!==L&&S(h,L),T.globalCompositeOperation="source-in",T.fillStyle="transparent",T.fillRect(0,0,M.width,M.height),T.globalCompositeOperation="source-over",C.hasBounds){for(O=0;O<E.length;O++){var D=E[O];r.overlaps(D.bounds,h.bounds)&&F.push(D)}for(O=0;O<V.length;O++){var k=V[O],W=k.bodyA,z=k.bodyB,Z=k.pointA,G=k.pointB;W&&(Z=l.add(W.position,k.pointA)),z&&(G=l.add(z.position,k.pointB)),!(!Z||!G)&&(r.contains(h.bounds,Z)||r.contains(h.bounds,G))&&B.push(k)}e.startViewTransform(h),h.mouse&&(f.setScale(h.mouse,{x:(h.bounds.max.x-h.bounds.min.x)/h.options.width,y:(h.bounds.max.y-h.bounds.min.y)/h.options.height}),f.setOffset(h.mouse,h.bounds.min))}else B=V,F=E,h.options.pixelRatio!==1&&h.context.setTransform(h.options.pixelRatio,0,0,h.options.pixelRatio,0,0);!C.wireframes||x.enableSleeping&&C.showSleeping?e.bodies(h,F,T):(C.showConvexHulls&&e.bodyConvexHulls(h,F,T),e.bodyWireframes(h,F,T)),C.showBounds&&e.bodyBounds(h,F,T),(C.showAxes||C.showAngleIndicator)&&e.bodyAxes(h,F,T),C.showPositions&&e.bodyPositions(h,F,T),C.showVelocity&&e.bodyVelocity(h,F,T),C.showIds&&e.bodyIds(h,F,T),C.showSeparations&&e.separations(h,x.pairs.list,T),C.showCollisions&&e.collisions(h,x.pairs.list,T),C.showVertexNumbers&&e.vertexNumbers(h,F,T),C.showMousePosition&&e.mousePosition(h,h.mouse,T),e.constraints(B,T),C.hasBounds&&e.endViewTransform(h),u.trigger(h,"afterRender",b),R.lastElapsed=o.now()-y},e.stats=function(h,v,y){for(var x=h.engine,A=x.world,M=n.allBodies(A),T=0,C=55,R=44,E=0,V=0,L=0;L<M.length;L+=1)T+=M[L].parts.length;var F={Part:T,Body:M.length,Cons:n.allConstraints(A).length,Comp:n.allComposites(A).length,Pair:x.pairs.list.length};v.fillStyle="#0e0f19",v.fillRect(E,V,C*5.5,R),v.font="12px Arial",v.textBaseline="top",v.textAlign="right";for(var B in F){var O=F[B];v.fillStyle="#aaa",v.fillText(B,E+C,V+8),v.fillStyle="#eee",v.fillText(O,E+C,V+26),E+=C}},e.performance=function(h,v){var y=h.engine,x=h.timing,A=x.deltaHistory,M=x.elapsedHistory,T=x.timestampElapsedHistory,C=x.engineDeltaHistory,R=x.engineElapsedHistory,E=y.timing.lastDelta,V=a(A),L=a(M),F=a(C),B=a(R),O=a(T),b=O/V||0,D=1e3/V||0,k=4,W=12,z=60,Z=34,G=10,N=69;v.fillStyle="#0e0f19",v.fillRect(0,50,W*4+z*5+22,Z),e.status(v,G,N,z,k,A.length,Math.round(D)+" fps",D/e._goodFps,function(U){return A[U]/V-1}),e.status(v,G+W+z,N,z,k,C.length,E.toFixed(2)+" dt",e._goodDelta/E,function(U){return C[U]/F-1}),e.status(v,G+(W+z)*2,N,z,k,R.length,B.toFixed(2)+" ut",1-B/e._goodFps,function(U){return R[U]/B-1}),e.status(v,G+(W+z)*3,N,z,k,M.length,L.toFixed(2)+" rt",1-L/e._goodFps,function(U){return M[U]/L-1}),e.status(v,G+(W+z)*4,N,z,k,T.length,b.toFixed(2)+" x",b*b*b,function(U){return(T[U]/A[U]/b||0)-1})},e.status=function(h,v,y,x,A,M,T,C,R){h.strokeStyle="#888",h.fillStyle="#444",h.lineWidth=1,h.fillRect(v,y+7,x,1),h.beginPath(),h.moveTo(v,y+7-A*o.clamp(.4*R(0),-2,2));for(var E=0;E<x;E+=1)h.lineTo(v+E,y+7-(E<M?A*o.clamp(.4*R(E),-2,2):0));h.stroke(),h.fillStyle="hsl("+o.clamp(25+95*C,0,120)+",100%,60%)",h.fillRect(v,y-7,4,4),h.font="12px Arial",h.textBaseline="middle",h.textAlign="right",h.fillStyle="#eee",h.fillText(T,v+x,y-5)},e.constraints=function(h,v){for(var y=v,x=0;x<h.length;x++){var A=h[x];if(!(!A.render.visible||!A.pointA||!A.pointB)){var M=A.bodyA,T=A.bodyB,C,R;if(M?C=l.add(M.position,A.pointA):C=A.pointA,A.render.type==="pin")y.beginPath(),y.arc(C.x,C.y,3,0,2*Math.PI),y.closePath();else{if(T?R=l.add(T.position,A.pointB):R=A.pointB,y.beginPath(),y.moveTo(C.x,C.y),A.render.type==="spring")for(var E=l.sub(R,C),V=l.perp(l.normalise(E)),L=Math.ceil(o.clamp(A.length/5,12,20)),F,B=1;B<L;B+=1)F=B%2===0?1:-1,y.lineTo(C.x+E.x*(B/L)+V.x*F*4,C.y+E.y*(B/L)+V.y*F*4);y.lineTo(R.x,R.y)}A.render.lineWidth&&(y.lineWidth=A.render.lineWidth,y.strokeStyle=A.render.strokeStyle,y.stroke()),A.render.anchors&&(y.fillStyle=A.render.strokeStyle,y.beginPath(),y.arc(C.x,C.y,3,0,2*Math.PI),y.arc(R.x,R.y,3,0,2*Math.PI),y.closePath(),y.fill())}}},e.bodies=function(h,v,y){var x=y;h.engine;var A=h.options,M=A.showInternalEdges||!A.wireframes,T,C,R,E;for(R=0;R<v.length;R++)if(T=v[R],!!T.render.visible){for(E=T.parts.length>1?1:0;E<T.parts.length;E++)if(C=T.parts[E],!!C.render.visible){if(A.showSleeping&&T.isSleeping?x.globalAlpha=.5*C.render.opacity:C.render.opacity!==1&&(x.globalAlpha=C.render.opacity),C.render.sprite&&C.render.sprite.texture&&!A.wireframes){var V=C.render.sprite,L=P(h,V.texture);x.translate(C.position.x,C.position.y),x.rotate(C.angle),x.drawImage(L,L.width*-V.xOffset*V.xScale,L.height*-V.yOffset*V.yScale,L.width*V.xScale,L.height*V.yScale),x.rotate(-C.angle),x.translate(-C.position.x,-C.position.y)}else{if(C.circleRadius)x.beginPath(),x.arc(C.position.x,C.position.y,C.circleRadius,0,2*Math.PI);else{x.beginPath(),x.moveTo(C.vertices[0].x,C.vertices[0].y);for(var F=1;F<C.vertices.length;F++)!C.vertices[F-1].isInternal||M?x.lineTo(C.vertices[F].x,C.vertices[F].y):x.moveTo(C.vertices[F].x,C.vertices[F].y),C.vertices[F].isInternal&&!M&&x.moveTo(C.vertices[(F+1)%C.vertices.length].x,C.vertices[(F+1)%C.vertices.length].y);x.lineTo(C.vertices[0].x,C.vertices[0].y),x.closePath()}A.wireframes?(x.lineWidth=1,x.strokeStyle="#bbb",x.stroke()):(x.fillStyle=C.render.fillStyle,C.render.lineWidth&&(x.lineWidth=C.render.lineWidth,x.strokeStyle=C.render.strokeStyle,x.stroke()),x.fill())}x.globalAlpha=1}}},e.bodyWireframes=function(h,v,y){var x=y,A=h.options.showInternalEdges,M,T,C,R,E;for(x.beginPath(),C=0;C<v.length;C++)if(M=v[C],!!M.render.visible)for(E=M.parts.length>1?1:0;E<M.parts.length;E++){for(T=M.parts[E],x.moveTo(T.vertices[0].x,T.vertices[0].y),R=1;R<T.vertices.length;R++)!T.vertices[R-1].isInternal||A?x.lineTo(T.vertices[R].x,T.vertices[R].y):x.moveTo(T.vertices[R].x,T.vertices[R].y),T.vertices[R].isInternal&&!A&&x.moveTo(T.vertices[(R+1)%T.vertices.length].x,T.vertices[(R+1)%T.vertices.length].y);x.lineTo(T.vertices[0].x,T.vertices[0].y)}x.lineWidth=1,x.strokeStyle="#bbb",x.stroke()},e.bodyConvexHulls=function(h,v,y){var x=y,A,M,T;for(x.beginPath(),M=0;M<v.length;M++)if(A=v[M],!(!A.render.visible||A.parts.length===1)){for(x.moveTo(A.vertices[0].x,A.vertices[0].y),T=1;T<A.vertices.length;T++)x.lineTo(A.vertices[T].x,A.vertices[T].y);x.lineTo(A.vertices[0].x,A.vertices[0].y)}x.lineWidth=1,x.strokeStyle="rgba(255,255,255,0.2)",x.stroke()},e.vertexNumbers=function(h,v,y){var x=y,A,M,T;for(A=0;A<v.length;A++){var C=v[A].parts;for(T=C.length>1?1:0;T<C.length;T++){var R=C[T];for(M=0;M<R.vertices.length;M++)x.fillStyle="rgba(255,255,255,0.2)",x.fillText(A+"_"+M,R.position.x+(R.vertices[M].x-R.position.x)*.8,R.position.y+(R.vertices[M].y-R.position.y)*.8)}}},e.mousePosition=function(h,v,y){var x=y;x.fillStyle="rgba(255,255,255,0.8)",x.fillText(v.position.x+"  "+v.position.y,v.position.x+5,v.position.y-5)},e.bodyBounds=function(h,v,y){var x=y;h.engine;var A=h.options;x.beginPath();for(var M=0;M<v.length;M++){var T=v[M];if(T.render.visible)for(var C=v[M].parts,R=C.length>1?1:0;R<C.length;R++){var E=C[R];x.rect(E.bounds.min.x,E.bounds.min.y,E.bounds.max.x-E.bounds.min.x,E.bounds.max.y-E.bounds.min.y)}}A.wireframes?x.strokeStyle="rgba(255,255,255,0.08)":x.strokeStyle="rgba(0,0,0,0.1)",x.lineWidth=1,x.stroke()},e.bodyAxes=function(h,v,y){var x=y;h.engine;var A=h.options,M,T,C,R;for(x.beginPath(),T=0;T<v.length;T++){var E=v[T],V=E.parts;if(!!E.render.visible)if(A.showAxes)for(C=V.length>1?1:0;C<V.length;C++)for(M=V[C],R=0;R<M.axes.length;R++){var L=M.axes[R];x.moveTo(M.position.x,M.position.y),x.lineTo(M.position.x+L.x*20,M.position.y+L.y*20)}else for(C=V.length>1?1:0;C<V.length;C++)for(M=V[C],R=0;R<M.axes.length;R++)x.moveTo(M.position.x,M.position.y),x.lineTo((M.vertices[0].x+M.vertices[M.vertices.length-1].x)/2,(M.vertices[0].y+M.vertices[M.vertices.length-1].y)/2)}A.wireframes?(x.strokeStyle="indianred",x.lineWidth=1):(x.strokeStyle="rgba(255, 255, 255, 0.4)",x.globalCompositeOperation="overlay",x.lineWidth=2),x.stroke(),x.globalCompositeOperation="source-over"},e.bodyPositions=function(h,v,y){var x=y;h.engine;var A=h.options,M,T,C,R;for(x.beginPath(),C=0;C<v.length;C++)if(M=v[C],!!M.render.visible)for(R=0;R<M.parts.length;R++)T=M.parts[R],x.arc(T.position.x,T.position.y,3,0,2*Math.PI,!1),x.closePath();for(A.wireframes?x.fillStyle="indianred":x.fillStyle="rgba(0,0,0,0.5)",x.fill(),x.beginPath(),C=0;C<v.length;C++)M=v[C],M.render.visible&&(x.arc(M.positionPrev.x,M.positionPrev.y,2,0,2*Math.PI,!1),x.closePath());x.fillStyle="rgba(255,165,0,0.8)",x.fill()},e.bodyVelocity=function(h,v,y){var x=y;x.beginPath();for(var A=0;A<v.length;A++){var M=v[A];!M.render.visible||(x.moveTo(M.position.x,M.position.y),x.lineTo(M.position.x+(M.position.x-M.positionPrev.x)*2,M.position.y+(M.position.y-M.positionPrev.y)*2))}x.lineWidth=3,x.strokeStyle="cornflowerblue",x.stroke()},e.bodyIds=function(h,v,y){var x=y,A,M;for(A=0;A<v.length;A++)if(!!v[A].render.visible){var T=v[A].parts;for(M=T.length>1?1:0;M<T.length;M++){var C=T[M];x.font="12px Arial",x.fillStyle="rgba(255,255,255,0.5)",x.fillText(C.id,C.position.x+10,C.position.y-10)}}},e.collisions=function(h,v,y){var x=y,A=h.options,M,T,C,R;for(x.beginPath(),C=0;C<v.length;C++)if(M=v[C],!!M.isActive)for(T=M.collision,R=0;R<M.activeContacts.length;R++){var E=M.activeContacts[R],V=E.vertex;x.rect(V.x-1.5,V.y-1.5,3.5,3.5)}for(A.wireframes?x.fillStyle="rgba(255,255,255,0.7)":x.fillStyle="orange",x.fill(),x.beginPath(),C=0;C<v.length;C++)if(M=v[C],!!M.isActive&&(T=M.collision,M.activeContacts.length>0)){var L=M.activeContacts[0].vertex.x,F=M.activeContacts[0].vertex.y;M.activeContacts.length===2&&(L=(M.activeContacts[0].vertex.x+M.activeContacts[1].vertex.x)/2,F=(M.activeContacts[0].vertex.y+M.activeContacts[1].vertex.y)/2),T.bodyB===T.supports[0].body||T.bodyA.isStatic===!0?x.moveTo(L-T.normal.x*8,F-T.normal.y*8):x.moveTo(L+T.normal.x*8,F+T.normal.y*8),x.lineTo(L,F)}A.wireframes?x.strokeStyle="rgba(255,165,0,0.7)":x.strokeStyle="orange",x.lineWidth=1,x.stroke()},e.separations=function(h,v,y){var x=y,A=h.options,M,T,C,R,E;for(x.beginPath(),E=0;E<v.length;E++)if(M=v[E],!!M.isActive){T=M.collision,C=T.bodyA,R=T.bodyB;var V=1;!R.isStatic&&!C.isStatic&&(V=.5),R.isStatic&&(V=0),x.moveTo(R.position.x,R.position.y),x.lineTo(R.position.x-T.penetration.x*V,R.position.y-T.penetration.y*V),V=1,!R.isStatic&&!C.isStatic&&(V=.5),C.isStatic&&(V=0),x.moveTo(C.position.x,C.position.y),x.lineTo(C.position.x+T.penetration.x*V,C.position.y+T.penetration.y*V)}A.wireframes?x.strokeStyle="rgba(255,165,0,0.5)":x.strokeStyle="orange",x.stroke()},e.inspector=function(h,v){h.engine;var y=h.selected,x=h.render,A=x.options,M;if(A.hasBounds){var T=x.bounds.max.x-x.bounds.min.x,C=x.bounds.max.y-x.bounds.min.y,R=T/x.options.width,E=C/x.options.height;v.scale(1/R,1/E),v.translate(-x.bounds.min.x,-x.bounds.min.y)}for(var V=0;V<y.length;V++){var L=y[V].data;switch(v.translate(.5,.5),v.lineWidth=1,v.strokeStyle="rgba(255,165,0,0.9)",v.setLineDash([1,2]),L.type){case"body":M=L.bounds,v.beginPath(),v.rect(Math.floor(M.min.x-3),Math.floor(M.min.y-3),Math.floor(M.max.x-M.min.x+6),Math.floor(M.max.y-M.min.y+6)),v.closePath(),v.stroke();break;case"constraint":var F=L.pointA;L.bodyA&&(F=L.pointB),v.beginPath(),v.arc(F.x,F.y,10,0,2*Math.PI),v.closePath(),v.stroke();break}v.setLineDash([]),v.translate(-.5,-.5)}h.selectStart!==null&&(v.translate(.5,.5),v.lineWidth=1,v.strokeStyle="rgba(255,165,0,0.6)",v.fillStyle="rgba(255,165,0,0.1)",M=h.selectBounds,v.beginPath(),v.rect(Math.floor(M.min.x),Math.floor(M.min.y),Math.floor(M.max.x-M.min.x),Math.floor(M.max.y-M.min.y)),v.closePath(),v.stroke(),v.fill(),v.translate(-.5,-.5)),A.hasBounds&&v.setTransform(1,0,0,1,0,0)};var i=function(h,v){var y=h.engine,x=h.timing,A=x.historySize,M=y.timing.timestamp;x.delta=v-x.lastTime||e._goodDelta,x.lastTime=v,x.timestampElapsed=M-x.lastTimestamp||0,x.lastTimestamp=M,x.deltaHistory.unshift(x.delta),x.deltaHistory.length=Math.min(x.deltaHistory.length,A),x.engineDeltaHistory.unshift(y.timing.lastDelta),x.engineDeltaHistory.length=Math.min(x.engineDeltaHistory.length,A),x.timestampElapsedHistory.unshift(x.timestampElapsed),x.timestampElapsedHistory.length=Math.min(x.timestampElapsedHistory.length,A),x.engineElapsedHistory.unshift(y.timing.lastElapsed),x.engineElapsedHistory.length=Math.min(x.engineElapsedHistory.length,A),x.elapsedHistory.unshift(x.lastElapsed),x.elapsedHistory.length=Math.min(x.elapsedHistory.length,A)},a=function(h){for(var v=0,y=0;y<h.length;y+=1)v+=h[y];return v/h.length||0},d=function(h,v){var y=document.createElement("canvas");return y.width=h,y.height=v,y.oncontextmenu=function(){return!1},y.onselectstart=function(){return!1},y},g=function(h){var v=h.getContext("2d"),y=window.devicePixelRatio||1,x=v.webkitBackingStorePixelRatio||v.mozBackingStorePixelRatio||v.msBackingStorePixelRatio||v.oBackingStorePixelRatio||v.backingStorePixelRatio||1;return y/x},P=function(h,v){var y=h.textures[v];return y||(y=h.textures[v]=new Image,y.src=v,y)},S=function(h,v){var y=v;/(jpg|gif|png)$/.test(v)&&(y="url("+v+")"),h.canvas.style.background=y,h.canvas.style.backgroundSize="contain",h.currentBackground=v}})()},function(p,w){var c={};p.exports=c,function(){c.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}}()},function(p,w,c){var e={};p.exports=e;var o=c(7),n=c(19),r=c(14),u=c(20),l=c(4),f=c(5),s=c(10),t=c(0),i=c(6);(function(){e.create=function(a){a=a||{};var d={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},g=t.extend(d,a);return g.world=a.world||f.create({label:"World"}),g.pairs=a.pairs||u.create(),g.detector=a.detector||r.create(),g.grid={buckets:[]},g.world.gravity=g.gravity,g.broadphase=g.grid,g.metrics={},g},e.update=function(a,d,g){var P=t.now();d=d||1e3/60,g=g||1;var S=a.world,h=a.detector,v=a.pairs,y=a.timing,x=y.timestamp,A;y.timestamp+=d*y.timeScale,y.lastDelta=d*y.timeScale;var M={timestamp:y.timestamp};l.trigger(a,"beforeUpdate",M);var T=f.allBodies(S),C=f.allConstraints(S);for(S.isModified&&r.setBodies(h,T),S.isModified&&f.setModified(S,!1,!1,!0),a.enableSleeping&&o.update(T,y.timeScale),e._bodiesApplyGravity(T,a.gravity),e._bodiesUpdate(T,d,y.timeScale,g,S.bounds),s.preSolveAll(T),A=0;A<a.constraintIterations;A++)s.solveAll(C,y.timeScale);s.postSolveAll(T),h.pairs=a.pairs;var R=r.collisions(h);for(u.update(v,R,x),a.enableSleeping&&o.afterCollisions(v.list,y.timeScale),v.collisionStart.length>0&&l.trigger(a,"collisionStart",{pairs:v.collisionStart}),n.preSolvePosition(v.list),A=0;A<a.positionIterations;A++)n.solvePosition(v.list,y.timeScale);for(n.postSolvePosition(T),s.preSolveAll(T),A=0;A<a.constraintIterations;A++)s.solveAll(C,y.timeScale);for(s.postSolveAll(T),n.preSolveVelocity(v.list),A=0;A<a.velocityIterations;A++)n.solveVelocity(v.list,y.timeScale);return v.collisionActive.length>0&&l.trigger(a,"collisionActive",{pairs:v.collisionActive}),v.collisionEnd.length>0&&l.trigger(a,"collisionEnd",{pairs:v.collisionEnd}),e._bodiesClearForces(T),l.trigger(a,"afterUpdate",M),a.timing.lastElapsed=t.now()-P,a},e.merge=function(a,d){if(t.extend(a,d),d.world){a.world=d.world,e.clear(a);for(var g=f.allBodies(a.world),P=0;P<g.length;P++){var S=g[P];o.set(S,!1),S.id=t.nextId()}}},e.clear=function(a){u.clear(a.pairs),r.clear(a.detector)},e._bodiesClearForces=function(a){for(var d=0;d<a.length;d++){var g=a[d];g.force.x=0,g.force.y=0,g.torque=0}},e._bodiesApplyGravity=function(a,d){var g=typeof d.scale<"u"?d.scale:.001;if(!(d.x===0&&d.y===0||g===0))for(var P=0;P<a.length;P++){var S=a[P];S.isStatic||S.isSleeping||(S.force.y+=S.mass*d.y*g,S.force.x+=S.mass*d.x*g)}},e._bodiesUpdate=function(a,d,g,P,S){for(var h=0;h<a.length;h++){var v=a[h];v.isStatic||v.isSleeping||i.update(v,d,g,P)}}})()},function(p,w,c){var e={};p.exports=e;var o=c(3),n=c(1);(function(){e._restingThresh=4,e._restingThreshTangent=6,e._positionDampen=.9,e._positionWarming=.8,e._frictionNormalMultiplier=5,e.preSolvePosition=function(r){var u,l,f,s=r.length;for(u=0;u<s;u++)l=r[u],l.isActive&&(f=l.activeContacts.length,l.collision.parentA.totalContacts+=f,l.collision.parentB.totalContacts+=f)},e.solvePosition=function(r,u){var l,f,s,t,i,a,d,g,P=e._positionDampen,S=r.length;for(l=0;l<S;l++)f=r[l],!(!f.isActive||f.isSensor)&&(s=f.collision,t=s.parentA,i=s.parentB,a=s.normal,f.separation=a.x*(i.positionImpulse.x+s.penetration.x-t.positionImpulse.x)+a.y*(i.positionImpulse.y+s.penetration.y-t.positionImpulse.y));for(l=0;l<S;l++)f=r[l],!(!f.isActive||f.isSensor)&&(s=f.collision,t=s.parentA,i=s.parentB,a=s.normal,g=(f.separation-f.slop)*u,(t.isStatic||i.isStatic)&&(g*=2),t.isStatic||t.isSleeping||(d=P/t.totalContacts,t.positionImpulse.x+=a.x*g*d,t.positionImpulse.y+=a.y*g*d),i.isStatic||i.isSleeping||(d=P/i.totalContacts,i.positionImpulse.x-=a.x*g*d,i.positionImpulse.y-=a.y*g*d))},e.postSolvePosition=function(r){for(var u=e._positionWarming,l=r.length,f=o.translate,s=n.update,t=0;t<l;t++){var i=r[t],a=i.positionImpulse,d=a.x,g=a.y,P=i.velocity;if(i.totalContacts=0,d!==0||g!==0){for(var S=0;S<i.parts.length;S++){var h=i.parts[S];f(h.vertices,a),s(h.bounds,h.vertices,P),h.position.x+=d,h.position.y+=g}i.positionPrev.x+=d,i.positionPrev.y+=g,d*P.x+g*P.y<0?(a.x=0,a.y=0):(a.x*=u,a.y*=u)}}},e.preSolveVelocity=function(r){var u=r.length,l,f;for(l=0;l<u;l++){var s=r[l];if(!(!s.isActive||s.isSensor)){var t=s.activeContacts,i=t.length,a=s.collision,d=a.parentA,g=a.parentB,P=a.normal,S=a.tangent;for(f=0;f<i;f++){var h=t[f],v=h.vertex,y=h.normalImpulse,x=h.tangentImpulse;if(y!==0||x!==0){var A=P.x*y+S.x*x,M=P.y*y+S.y*x;d.isStatic||d.isSleeping||(d.positionPrev.x+=A*d.inverseMass,d.positionPrev.y+=M*d.inverseMass,d.anglePrev+=d.inverseInertia*((v.x-d.position.x)*M-(v.y-d.position.y)*A)),g.isStatic||g.isSleeping||(g.positionPrev.x-=A*g.inverseMass,g.positionPrev.y-=M*g.inverseMass,g.anglePrev-=g.inverseInertia*((v.x-g.position.x)*M-(v.y-g.position.y)*A))}}}}},e.solveVelocity=function(r,u){var l=u*u,f=e._restingThresh*l,s=e._frictionNormalMultiplier,t=e._restingThreshTangent*l,i=Number.MAX_VALUE,a=r.length,d,g,P,S;for(P=0;P<a;P++){var h=r[P];if(!(!h.isActive||h.isSensor)){var v=h.collision,y=v.parentA,x=v.parentB,A=y.velocity,M=x.velocity,T=v.normal.x,C=v.normal.y,R=v.tangent.x,E=v.tangent.y,V=h.activeContacts,L=V.length,F=1/L,B=y.inverseMass+x.inverseMass,O=h.friction*h.frictionStatic*s*l;for(A.x=y.position.x-y.positionPrev.x,A.y=y.position.y-y.positionPrev.y,M.x=x.position.x-x.positionPrev.x,M.y=x.position.y-x.positionPrev.y,y.angularVelocity=y.angle-y.anglePrev,x.angularVelocity=x.angle-x.anglePrev,S=0;S<L;S++){var b=V[S],D=b.vertex,k=D.x-y.position.x,W=D.y-y.position.y,z=D.x-x.position.x,Z=D.y-x.position.y,G=A.x-W*y.angularVelocity,N=A.y+k*y.angularVelocity,U=M.x-Z*x.angularVelocity,_=M.y+z*x.angularVelocity,Q=G-U,X=N-_,K=T*Q+C*X,$=R*Q+E*X,ae=h.separation+K,te=Math.min(ae,1);te=ae<0?0:te;var Te=te*O;$>Te||-$>Te?(g=$>0?$:-$,d=h.friction*($>0?1:-1)*l,d<-g?d=-g:d>g&&(d=g)):(d=$,g=i);var Ie=k*C-W*T,Re=z*C-Z*T,Ee=F/(B+y.inverseInertia*Ie*Ie+x.inverseInertia*Re*Re),oe=(1+h.restitution)*K*Ee;if(d*=Ee,K*K>f&&K<0)b.normalImpulse=0;else{var Ue=b.normalImpulse;b.normalImpulse+=oe,b.normalImpulse=Math.min(b.normalImpulse,0),oe=b.normalImpulse-Ue}if($*$>t)b.tangentImpulse=0;else{var Ze=b.tangentImpulse;b.tangentImpulse+=d,b.tangentImpulse<-g&&(b.tangentImpulse=-g),b.tangentImpulse>g&&(b.tangentImpulse=g),d=b.tangentImpulse-Ze}var le=T*oe+R*d,ce=C*oe+E*d;y.isStatic||y.isSleeping||(y.positionPrev.x+=le*y.inverseMass,y.positionPrev.y+=ce*y.inverseMass,y.anglePrev+=(k*ce-W*le)*y.inverseInertia),x.isStatic||x.isSleeping||(x.positionPrev.x-=le*x.inverseMass,x.positionPrev.y-=ce*x.inverseMass,x.anglePrev-=(z*ce-Z*le)*x.inverseInertia)}}}}})()},function(p,w,c){var e={};p.exports=e;var o=c(9),n=c(0);(function(){e.create=function(r){return n.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},r)},e.update=function(r,u,l){var f=r.list,s=f.length,t=r.table,i=u.length,a=r.collisionStart,d=r.collisionEnd,g=r.collisionActive,P,S,h,v;for(a.length=0,d.length=0,g.length=0,v=0;v<s;v++)f[v].confirmedActive=!1;for(v=0;v<i;v++)P=u[v],h=P.pair,h?(h.isActive?g.push(h):a.push(h),o.update(h,P,l),h.confirmedActive=!0):(h=o.create(P,l),t[h.id]=h,a.push(h),f.push(h));var y=[];for(s=f.length,v=0;v<s;v++)h=f[v],h.confirmedActive||(o.setActive(h,!1,l),d.push(h),!h.collision.bodyA.isSleeping&&!h.collision.bodyB.isSleeping&&y.push(v));for(v=0;v<y.length;v++)S=y[v]-v,h=f[S],f.splice(S,1),delete t[h.id]},e.clear=function(r){return r.table={},r.list.length=0,r.collisionStart.length=0,r.collisionActive.length=0,r.collisionEnd.length=0,r}})()},function(p,w,c){var e=p.exports=c(22);e.Axes=c(11),e.Bodies=c(12),e.Body=c(6),e.Bounds=c(1),e.Collision=c(8),e.Common=c(0),e.Composite=c(5),e.Composites=c(23),e.Constraint=c(10),e.Contact=c(17),e.Detector=c(14),e.Engine=c(18),e.Events=c(4),e.Grid=c(24),e.Mouse=c(13),e.MouseConstraint=c(25),e.Pair=c(9),e.Pairs=c(20),e.Plugin=c(15),e.Query=c(26),e.Render=c(16),e.Resolver=c(19),e.Runner=c(27),e.SAT=c(28),e.Sleeping=c(7),e.Svg=c(29),e.Vector=c(2),e.Vertices=c(3),e.World=c(30),e.Engine.run=e.Runner.run,e.Common.deprecated(e.Engine,"run","Engine.run \u27A4 use Matter.Runner.run(engine) instead")},function(p,w,c){var e={};p.exports=e;var o=c(15),n=c(0);(function(){e.name="matter-js",e.version="0.18.0",e.uses=[],e.used=[],e.use=function(){o.use(e,Array.prototype.slice.call(arguments))},e.before=function(r,u){return r=r.replace(/^Matter./,""),n.chainPathBefore(e,r,u)},e.after=function(r,u){return r=r.replace(/^Matter./,""),n.chainPathAfter(e,r,u)}})()},function(p,w,c){var e={};p.exports=e;var o=c(5),n=c(10),r=c(0),u=c(6),l=c(12),f=r.deprecated;(function(){e.stack=function(s,t,i,a,d,g,P){for(var S=o.create({label:"Stack"}),h=s,v=t,y,x=0,A=0;A<a;A++){for(var M=0,T=0;T<i;T++){var C=P(h,v,T,A,y,x);if(C){var R=C.bounds.max.y-C.bounds.min.y,E=C.bounds.max.x-C.bounds.min.x;R>M&&(M=R),u.translate(C,{x:E*.5,y:R*.5}),h=C.bounds.max.x+d,o.addBody(S,C),y=C,x+=1}else h+=d}v+=M+g,h=s}return S},e.chain=function(s,t,i,a,d,g){for(var P=s.bodies,S=1;S<P.length;S++){var h=P[S-1],v=P[S],y=h.bounds.max.y-h.bounds.min.y,x=h.bounds.max.x-h.bounds.min.x,A=v.bounds.max.y-v.bounds.min.y,M=v.bounds.max.x-v.bounds.min.x,T={bodyA:h,pointA:{x:x*t,y:y*i},bodyB:v,pointB:{x:M*a,y:A*d}},C=r.extend(T,g);o.addConstraint(s,n.create(C))}return s.label+=" Chain",s},e.mesh=function(s,t,i,a,d){var g=s.bodies,P,S,h,v,y;for(P=0;P<i;P++){for(S=1;S<t;S++)h=g[S-1+P*t],v=g[S+P*t],o.addConstraint(s,n.create(r.extend({bodyA:h,bodyB:v},d)));if(P>0)for(S=0;S<t;S++)h=g[S+(P-1)*t],v=g[S+P*t],o.addConstraint(s,n.create(r.extend({bodyA:h,bodyB:v},d))),a&&S>0&&(y=g[S-1+(P-1)*t],o.addConstraint(s,n.create(r.extend({bodyA:y,bodyB:v},d)))),a&&S<t-1&&(y=g[S+1+(P-1)*t],o.addConstraint(s,n.create(r.extend({bodyA:y,bodyB:v},d))))}return s.label+=" Mesh",s},e.pyramid=function(s,t,i,a,d,g,P){return e.stack(s,t,i,a,d,g,function(S,h,v,y,x,A){var M=Math.min(a,Math.ceil(i/2)),T=x?x.bounds.max.x-x.bounds.min.x:0;if(!(y>M)){y=M-y;var C=y,R=i-1-y;if(!(v<C||v>R)){A===1&&u.translate(x,{x:(v+(i%2===1?1:-1))*T,y:0});var E=x?v*T:0;return P(s+E+v*d,h,v,y,x,A)}}})},e.newtonsCradle=function(s,t,i,a,d){for(var g=o.create({label:"Newtons Cradle"}),P=0;P<i;P++){var S=1.9,h=l.circle(s+P*(a*S),t+d,a,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),v=n.create({pointA:{x:s+P*(a*S),y:t},bodyB:h});o.addBody(g,h),o.addConstraint(g,v)}return g},f(e,"newtonsCradle","Composites.newtonsCradle \u27A4 moved to newtonsCradle example"),e.car=function(s,t,i,a,d){var g=u.nextGroup(!0),P=20,S=-i*.5+P,h=i*.5-P,v=0,y=o.create({label:"Car"}),x=l.rectangle(s,t,i,a,{collisionFilter:{group:g},chamfer:{radius:a*.5},density:2e-4}),A=l.circle(s+S,t+v,d,{collisionFilter:{group:g},friction:.8}),M=l.circle(s+h,t+v,d,{collisionFilter:{group:g},friction:.8}),T=n.create({bodyB:x,pointB:{x:S,y:v},bodyA:A,stiffness:1,length:0}),C=n.create({bodyB:x,pointB:{x:h,y:v},bodyA:M,stiffness:1,length:0});return o.addBody(y,x),o.addBody(y,A),o.addBody(y,M),o.addConstraint(y,T),o.addConstraint(y,C),y},f(e,"car","Composites.car \u27A4 moved to car example"),e.softBody=function(s,t,i,a,d,g,P,S,h,v){h=r.extend({inertia:1/0},h),v=r.extend({stiffness:.2,render:{type:"line",anchors:!1}},v);var y=e.stack(s,t,i,a,d,g,function(x,A){return l.circle(x,A,S,h)});return e.mesh(y,i,a,P,v),y.label="Soft Body",y},f(e,"softBody","Composites.softBody \u27A4 moved to softBody and cloth examples")})()},function(p,w,c){var e={};p.exports=e;var o=c(9),n=c(0),r=n.deprecated;(function(){e.create=function(u){var l={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return n.extend(l,u)},e.update=function(u,l,f,s){var t,i,a,d=f.world,g=u.buckets,P,S,h=!1;for(t=0;t<l.length;t++){var v=l[t];if(!(v.isSleeping&&!s)&&!(d.bounds&&(v.bounds.max.x<d.bounds.min.x||v.bounds.min.x>d.bounds.max.x||v.bounds.max.y<d.bounds.min.y||v.bounds.min.y>d.bounds.max.y))){var y=e._getRegion(u,v);if(!v.region||y.id!==v.region.id||s){(!v.region||s)&&(v.region=y);var x=e._regionUnion(y,v.region);for(i=x.startCol;i<=x.endCol;i++)for(a=x.startRow;a<=x.endRow;a++){S=e._getBucketId(i,a),P=g[S];var A=i>=y.startCol&&i<=y.endCol&&a>=y.startRow&&a<=y.endRow,M=i>=v.region.startCol&&i<=v.region.endCol&&a>=v.region.startRow&&a<=v.region.endRow;!A&&M&&M&&P&&e._bucketRemoveBody(u,P,v),(v.region===y||A&&!M||s)&&(P||(P=e._createBucket(g,S)),e._bucketAddBody(u,P,v))}v.region=y,h=!0}}}h&&(u.pairsList=e._createActivePairsList(u))},r(e,"update","Grid.update \u27A4 replaced by Matter.Detector"),e.clear=function(u){u.buckets={},u.pairs={},u.pairsList=[]},r(e,"clear","Grid.clear \u27A4 replaced by Matter.Detector"),e._regionUnion=function(u,l){var f=Math.min(u.startCol,l.startCol),s=Math.max(u.endCol,l.endCol),t=Math.min(u.startRow,l.startRow),i=Math.max(u.endRow,l.endRow);return e._createRegion(f,s,t,i)},e._getRegion=function(u,l){var f=l.bounds,s=Math.floor(f.min.x/u.bucketWidth),t=Math.floor(f.max.x/u.bucketWidth),i=Math.floor(f.min.y/u.bucketHeight),a=Math.floor(f.max.y/u.bucketHeight);return e._createRegion(s,t,i,a)},e._createRegion=function(u,l,f,s){return{id:u+","+l+","+f+","+s,startCol:u,endCol:l,startRow:f,endRow:s}},e._getBucketId=function(u,l){return"C"+u+"R"+l},e._createBucket=function(u,l){var f=u[l]=[];return f},e._bucketAddBody=function(u,l,f){var s=u.pairs,t=o.id,i=l.length,a;for(a=0;a<i;a++){var d=l[a];if(!(f.id===d.id||f.isStatic&&d.isStatic)){var g=t(f,d),P=s[g];P?P[2]+=1:s[g]=[f,d,1]}}l.push(f)},e._bucketRemoveBody=function(u,l,f){var s=u.pairs,t=o.id,i;l.splice(n.indexOf(l,f),1);var a=l.length;for(i=0;i<a;i++){var d=s[t(f,l[i])];d&&(d[2]-=1)}},e._createActivePairsList=function(u){var l,f=u.pairs,s=n.keys(f),t=s.length,i=[],a;for(a=0;a<t;a++)l=f[s[a]],l[2]>0?i.push(l):delete f[s[a]];return i}})()},function(p,w,c){var e={};p.exports=e;var o=c(3),n=c(7),r=c(13),u=c(4),l=c(14),f=c(10),s=c(5),t=c(0),i=c(1);(function(){e.create=function(a,d){var g=(a?a.mouse:null)||(d?d.mouse:null);g||(a&&a.render&&a.render.canvas?g=r.create(a.render.canvas):d&&d.element?g=r.create(d.element):(g=r.create(),t.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var P=f.create({label:"Mouse Constraint",pointA:g.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),S={type:"mouseConstraint",mouse:g,element:null,body:null,constraint:P,collisionFilter:{category:1,mask:4294967295,group:0}},h=t.extend(S,d);return u.on(a,"beforeUpdate",function(){var v=s.allBodies(a.world);e.update(h,v),e._triggerEvents(h)}),h},e.update=function(a,d){var g=a.mouse,P=a.constraint,S=a.body;if(g.button===0){if(P.bodyB)n.set(P.bodyB,!1),P.pointA=g.position;else for(var h=0;h<d.length;h++)if(S=d[h],i.contains(S.bounds,g.position)&&l.canCollide(S.collisionFilter,a.collisionFilter))for(var v=S.parts.length>1?1:0;v<S.parts.length;v++){var y=S.parts[v];if(o.contains(y.vertices,g.position)){P.pointA=g.position,P.bodyB=a.body=S,P.pointB={x:g.position.x-S.position.x,y:g.position.y-S.position.y},P.angleB=S.angle,n.set(S,!1),u.trigger(a,"startdrag",{mouse:g,body:S});break}}}else P.bodyB=a.body=null,P.pointB=null,S&&u.trigger(a,"enddrag",{mouse:g,body:S})},e._triggerEvents=function(a){var d=a.mouse,g=d.sourceEvents;g.mousemove&&u.trigger(a,"mousemove",{mouse:d}),g.mousedown&&u.trigger(a,"mousedown",{mouse:d}),g.mouseup&&u.trigger(a,"mouseup",{mouse:d}),r.clearSourceEvents(d)}})()},function(p,w,c){var e={};p.exports=e;var o=c(2),n=c(8),r=c(1),u=c(12),l=c(3);(function(){e.collides=function(f,s){for(var t=[],i=s.length,a=f.bounds,d=n.collides,g=r.overlaps,P=0;P<i;P++){var S=s[P],h=S.parts.length,v=h===1?0:1;if(g(S.bounds,a))for(var y=v;y<h;y++){var x=S.parts[y];if(g(x.bounds,a)){var A=d(x,f);if(A){t.push(A);break}}}}return t},e.ray=function(f,s,t,i){i=i||1e-100;for(var a=o.angle(s,t),d=o.magnitude(o.sub(s,t)),g=(t.x+s.x)*.5,P=(t.y+s.y)*.5,S=u.rectangle(g,P,d,i,{angle:a}),h=e.collides(S,f),v=0;v<h.length;v+=1){var y=h[v];y.body=y.bodyB=y.bodyA}return h},e.region=function(f,s,t){for(var i=[],a=0;a<f.length;a++){var d=f[a],g=r.overlaps(d.bounds,s);(g&&!t||!g&&t)&&i.push(d)}return i},e.point=function(f,s){for(var t=[],i=0;i<f.length;i++){var a=f[i];if(r.contains(a.bounds,s))for(var d=a.parts.length===1?0:1;d<a.parts.length;d++){var g=a.parts[d];if(r.contains(g.bounds,s)&&l.contains(g.vertices,s)){t.push(a);break}}}return t}})()},function(p,w,c){var e={};p.exports=e;var o=c(4),n=c(18),r=c(0);(function(){var u,l;if(typeof window<"u"&&(u=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,l=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!u){var f;u=function(s){f=setTimeout(function(){s(r.now())},1e3/60)},l=function(){clearTimeout(f)}}e.create=function(s){var t={fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},i=r.extend(t,s);return i.delta=i.delta||1e3/i.fps,i.deltaMin=i.deltaMin||1e3/i.fps,i.deltaMax=i.deltaMax||1e3/(i.fps*.5),i.fps=1e3/i.delta,i},e.run=function(s,t){return typeof s.positionIterations<"u"&&(t=s,s=e.create()),function i(a){s.frameRequestId=u(i),a&&s.enabled&&e.tick(s,t,a)}(),s},e.tick=function(s,t,i){var a=t.timing,d=1,g,P={timestamp:a.timestamp};o.trigger(s,"beforeTick",P),s.isFixed?g=s.delta:(g=i-s.timePrev||s.delta,s.timePrev=i,s.deltaHistory.push(g),s.deltaHistory=s.deltaHistory.slice(-s.deltaSampleSize),g=Math.min.apply(null,s.deltaHistory),g=g<s.deltaMin?s.deltaMin:g,g=g>s.deltaMax?s.deltaMax:g,d=g/s.delta,s.delta=g),s.timeScalePrev!==0&&(d*=a.timeScale/s.timeScalePrev),a.timeScale===0&&(d=0),s.timeScalePrev=a.timeScale,s.correction=d,s.frameCounter+=1,i-s.counterTimestamp>=1e3&&(s.fps=s.frameCounter*((i-s.counterTimestamp)/1e3),s.counterTimestamp=i,s.frameCounter=0),o.trigger(s,"tick",P),o.trigger(s,"beforeUpdate",P),n.update(t,g,d),o.trigger(s,"afterUpdate",P),o.trigger(s,"afterTick",P)},e.stop=function(s){l(s.frameRequestId)},e.start=function(s,t){e.run(s,t)}})()},function(p,w,c){var e={};p.exports=e;var o=c(8),n=c(0),r=n.deprecated;(function(){e.collides=function(u,l){return o.collides(u,l)},r(e,"collides","SAT.collides \u27A4 replaced by Collision.collides")})()},function(p,w,c){var e={};p.exports=e,c(1);var o=c(0);(function(){e.pathToVertices=function(n,r){typeof window<"u"&&!("SVGPathSeg"in window)&&o.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var u,l,f,s,t,i,a,d,g,P,S=[],h,v,y=0,x=0,A=0;r=r||15;var M=function(C,R,E){var V=E%2===1&&E>1;if(!g||C!=g.x||R!=g.y){g&&V?(h=g.x,v=g.y):(h=0,v=0);var L={x:h+C,y:v+R};(V||!g)&&(g=L),S.push(L),x=h+C,A=v+R}},T=function(C){var R=C.pathSegTypeAsLetter.toUpperCase();if(R!=="Z"){switch(R){case"M":case"L":case"T":case"C":case"S":case"Q":x=C.x,A=C.y;break;case"H":x=C.x;break;case"V":A=C.y;break}M(x,A,C.pathSegType)}};for(e._svgPathToAbsolute(n),f=n.getTotalLength(),i=[],u=0;u<n.pathSegList.numberOfItems;u+=1)i.push(n.pathSegList.getItem(u));for(a=i.concat();y<f;){if(P=n.getPathSegAtLength(y),t=i[P],t!=d){for(;a.length&&a[0]!=t;)T(a.shift());d=t}switch(t.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":s=n.getPointAtLength(y),M(s.x,s.y,0);break}y+=r}for(u=0,l=a.length;u<l;++u)T(a[u]);return S},e._svgPathToAbsolute=function(n){for(var r,u,l,f,s,t,i=n.pathSegList,a=0,d=0,g=i.numberOfItems,P=0;P<g;++P){var S=i.getItem(P),h=S.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(h))"x"in S&&(a=S.x),"y"in S&&(d=S.y);else switch("x1"in S&&(l=a+S.x1),"x2"in S&&(s=a+S.x2),"y1"in S&&(f=d+S.y1),"y2"in S&&(t=d+S.y2),"x"in S&&(a+=S.x),"y"in S&&(d+=S.y),h){case"m":i.replaceItem(n.createSVGPathSegMovetoAbs(a,d),P);break;case"l":i.replaceItem(n.createSVGPathSegLinetoAbs(a,d),P);break;case"h":i.replaceItem(n.createSVGPathSegLinetoHorizontalAbs(a),P);break;case"v":i.replaceItem(n.createSVGPathSegLinetoVerticalAbs(d),P);break;case"c":i.replaceItem(n.createSVGPathSegCurvetoCubicAbs(a,d,l,f,s,t),P);break;case"s":i.replaceItem(n.createSVGPathSegCurvetoCubicSmoothAbs(a,d,s,t),P);break;case"q":i.replaceItem(n.createSVGPathSegCurvetoQuadraticAbs(a,d,l,f),P);break;case"t":i.replaceItem(n.createSVGPathSegCurvetoQuadraticSmoothAbs(a,d),P);break;case"a":i.replaceItem(n.createSVGPathSegArcAbs(a,d,S.r1,S.r2,S.angle,S.largeArcFlag,S.sweepFlag),P);break;case"z":case"Z":a=r,d=u;break}(h=="M"||h=="m")&&(r=a,u=d)}}})()},function(p,w,c){var e={};p.exports=e;var o=c(5);c(0),function(){e.create=o.create,e.add=o.add,e.remove=o.remove,e.clear=o.clear,e.addComposite=o.addComposite,e.addBody=o.addBody,e.addConstraint=o.addConstraint}()}])})})(It);class Rt extends dt{constructor(m){super(),this.scene=m,this.modelInit()}modelInit(){const c=this.addWheel(1.5,2),e=this.addWheel(-1.5,2),o=this.addWheel(1.5,-2),n=this.addWheel(-1.5,-2),r=this.addRotor(1.5,2),u=this.addRotor(-1.5,2),l=this.addRotor(1.5,-2),f=this.addRotor(-1.5,-2),s=this.addAxis(2),t=this.addAxis(-2+.2,.04),i=this.addAxis(-2-.2),a={axisA:{y:1},axisB:{y:1}};this.motorBackLeft=this.scene.physics.add.constraints.hinge(e.body,u.body,a),this.motorBackRight=this.scene.physics.add.constraints.hinge(c.body,r.body,a),this.motorFrontLeft=this.scene.physics.add.constraints.hinge(n.body,f.body,a),this.motorFrontRight=this.scene.physics.add.constraints.hinge(o.body,l.body,a);const d=(S,h,v,y)=>{const x=this.scene.physics.add.constraints.hinge(S.body,v.body,{pivotA:{y:.2,z:y},pivotB:{y:-1.3},axisA:{x:1},axisB:{x:1}}),A=this.scene.physics.add.constraints.hinge(h.body,v.body,{pivotA:{y:-.2,z:y},pivotB:{y:1.3},axisA:{x:1},axisB:{x:1}});return{right:x,left:A}};this.scene.physics.add.constraints.lock(r.body,s.body),this.scene.physics.add.constraints.lock(u.body,s.body),this.m0=d(l,f,i,-0),d(l,f,t,.4),this.plate=this.addPlate(),this.plate.add(this.camera),this.scene.physics.add.constraints.lock(this.plate.body,s.body),this.scene.physics.add.constraints.lock(this.plate.body,i.body);const g=.3,P={angularLowerLimit:{x:0,y:0,z:0},angularUpperLimit:{x:0,y:0,z:0},linearLowerLimit:{x:0,y:-g,z:-.1},linearUpperLimit:{x:0,y:g,z:.1}};this.scene.physics.add.constraints.dof(this.plate.body,t.body,{...P,offset:{y:.9}}),this.scene.physics.add.constraints.dof(this.plate.body,t.body,{...P,offset:{y:-.9}}),this.m0.left.enableAngularMotor(!0,0,1e3),this.m0.right.enableAngularMotor(!0,0,1e3),console.log("Car")}addPlate(){const m=this.scene.add.box({y:1,width:1.8,depth:4.7,mass:5e3,height:.25},{lambert:{wireframe:!0}});return this.scene.physics.add.existing(m),m}addAxis(m,p=.06){const w=this.scene.add.cylinder({z:m,y:1,mass:10,radiusTop:p,radiusBottom:p,height:2.6},{lambert:{color:"blue",transparent:!0,opacity:.5}});return w.rotateZ(Math.PI/2),this.scene.physics.add.existing(w),w}addRotor(m,p){const w=this.scene.add.cylinder({mass:10,radiusBottom:.35,radiusTop:.35,radiusSegments:24,height:.4,x:m,y:1,z:p},{lambert:{color:"red",transparent:!0,opacity:.5}});return w.rotateZ(Math.PI/2),this.scene.physics.add.existing(w),w}addWheel(m,p){const w=this.scene.add.cylinder({mass:20,radiusBottom:.5,radiusTop:.5,radiusSegments:24,height:.35,x:m,y:1,z:p},{lambert:{color:"blue",transparent:!0,opacity:.5}});return w.rotateZ(Math.PI/2),this.scene.physics.add.existing(w),w.body.setFriction(3),w}addAxisRotor(m,p,w){const c=this.scene.add.box({x:m,y:p,z:w,mass:5,width:.25,height:.2,depth:1},{lambert:{transparent:!0,opacity:.5}});return this.scene.physics.add.existing(c),c}}const $t=Object.freeze(Object.defineProperty({__proto__:null,default:Rt},Symbol.toStringTag,{value:"Module"}));export{At as A,J as C,Dt as E,Ot as L,ve as P,ne as V,ft as a,Ut as b,Ct as c,Nt as d,Wt as e,zt as f,kt as g,dt as h,Gt as i,Rt as j,$t as k,Y as l};
