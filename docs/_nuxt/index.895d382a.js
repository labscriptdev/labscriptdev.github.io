import ee from"./layout.2704688b.js";import{V as Z,h as q,s as W,a3 as te,G as O,j as ne,Q as oe,y as re,W as se,o as j,c as A,w as $,f as C,a as p,e as h,t as H,a1 as ae,a4 as G,b as L,F as I,$ as R,g as U,a0 as ie,a2 as le,r as F}from"./entry.32c8ca23.js";/* empty css                                               */var Q={exports:{}};(function(f,i){(function(x,y){f.exports=y()})(Z,function(){var x,y,o=1e3,u=6e4,T=36e5,Y=864e5,E=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m=31536e6,v=2592e6,k=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,_={years:m,months:v,days:Y,hours:T,minutes:u,seconds:o,milliseconds:1,weeks:6048e5},g=function(l){return l instanceof P},M=function(l,e,t){return new P(l,t,e.$l)},d=function(l){return y.p(l)+"s"},D=function(l){return l<0},w=function(l){return D(l)?Math.ceil(l):Math.floor(l)},S=function(l){return Math.abs(l)},V=function(l,e){return l?D(l)?{negative:!0,format:""+S(l)+e}:{negative:!1,format:""+l+e}:{negative:!1,format:""}},P=function(){function l(t,c,n){var s=this;if(this.$d={},this.$l=n,t===void 0&&(this.$ms=0,this.parseFromMilliseconds()),c)return M(t*_[d(c)],this);if(typeof t=="number")return this.$ms=t,this.parseFromMilliseconds(),this;if(typeof t=="object")return Object.keys(t).forEach(function(b){s.$d[d(b)]=t[b]}),this.calMilliseconds(),this;if(typeof t=="string"){var a=t.match(k);if(a){var r=a.slice(2).map(function(b){return b!=null?Number(b):0});return this.$d.years=r[0],this.$d.months=r[1],this.$d.weeks=r[2],this.$d.days=r[3],this.$d.hours=r[4],this.$d.minutes=r[5],this.$d.seconds=r[6],this.calMilliseconds(),this}}return this}var e=l.prototype;return e.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce(function(c,n){return c+(t.$d[n]||0)*_[n]},0)},e.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=w(t/m),t%=m,this.$d.months=w(t/v),t%=v,this.$d.days=w(t/Y),t%=Y,this.$d.hours=w(t/T),t%=T,this.$d.minutes=w(t/u),t%=u,this.$d.seconds=w(t/o),t%=o,this.$d.milliseconds=t},e.toISOString=function(){var t=V(this.$d.years,"Y"),c=V(this.$d.months,"M"),n=+this.$d.days||0;this.$d.weeks&&(n+=7*this.$d.weeks);var s=V(n,"D"),a=V(this.$d.hours,"H"),r=V(this.$d.minutes,"M"),b=this.$d.seconds||0;this.$d.milliseconds&&(b+=this.$d.milliseconds/1e3);var z=V(b,"S"),N=t.negative||c.negative||s.negative||a.negative||r.negative||z.negative,X=a.format||r.format||z.format?"T":"",B=(N?"-":"")+"P"+t.format+c.format+s.format+X+a.format+r.format+z.format;return B==="P"||B==="-P"?"P0D":B},e.toJSON=function(){return this.toISOString()},e.format=function(t){var c=t||"YYYY-MM-DDTHH:mm:ss",n={Y:this.$d.years,YY:y.s(this.$d.years,2,"0"),YYYY:y.s(this.$d.years,4,"0"),M:this.$d.months,MM:y.s(this.$d.months,2,"0"),D:this.$d.days,DD:y.s(this.$d.days,2,"0"),H:this.$d.hours,HH:y.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:y.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:y.s(this.$d.seconds,2,"0"),SSS:y.s(this.$d.milliseconds,3,"0")};return c.replace(E,function(s,a){return a||String(n[s])})},e.as=function(t){return this.$ms/_[d(t)]},e.get=function(t){var c=this.$ms,n=d(t);return n==="milliseconds"?c%=1e3:c=n==="weeks"?w(c/_[n]):this.$d[n],c===0?0:c},e.add=function(t,c,n){var s;return s=c?t*_[d(c)]:g(t)?t.$ms:M(t,this).$ms,M(this.$ms+s*(n?-1:1),this)},e.subtract=function(t,c){return this.add(t,c,!0)},e.locale=function(t){var c=this.clone();return c.$l=t,c},e.clone=function(){return M(this.$ms,this)},e.humanize=function(t){return x().add(this.$ms,"ms").locale(this.$l).fromNow(!t)},e.milliseconds=function(){return this.get("milliseconds")},e.asMilliseconds=function(){return this.as("milliseconds")},e.seconds=function(){return this.get("seconds")},e.asSeconds=function(){return this.as("seconds")},e.minutes=function(){return this.get("minutes")},e.asMinutes=function(){return this.as("minutes")},e.hours=function(){return this.get("hours")},e.asHours=function(){return this.as("hours")},e.days=function(){return this.get("days")},e.asDays=function(){return this.as("days")},e.weeks=function(){return this.get("weeks")},e.asWeeks=function(){return this.as("weeks")},e.months=function(){return this.get("months")},e.asMonths=function(){return this.as("months")},e.years=function(){return this.get("years")},e.asYears=function(){return this.as("years")},l}();return function(l,e,t){x=t,y=t().$utils(),t.duration=function(s,a){var r=t.locale();return M(s,{$l:r},a)},t.isDuration=g;var c=e.prototype.add,n=e.prototype.subtract;e.prototype.add=function(s,a){return g(s)&&(s=s.asMilliseconds()),c.bind(this)(s,a)},e.prototype.subtract=function(s,a){return g(s)&&(s=s.asMilliseconds()),n.bind(this)(s,a)}}})})(Q);const ue=Q.exports;var J={exports:{}};(function(f,i){(function(x,y){f.exports=y()})(Z,function(){return function(x,y,o){x=x||{};var u=y.prototype,T={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Y(m,v,k,_){return u.fromToBase(m,v,k,_)}o.en.relativeTime=T,u.fromToBase=function(m,v,k,_,g){for(var M,d,D,w=k.$locale().relativeTime||T,S=x.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],V=S.length,P=0;P<V;P+=1){var l=S[P];l.d&&(M=_?o(m).diff(k,l.d,!0):k.diff(m,l.d,!0));var e=(x.rounding||Math.round)(Math.abs(M));if(D=M>0,e<=l.r||!l.r){e<=1&&P>0&&(l=S[P-1]);var t=w[l.l];g&&(e=g(""+e)),d=typeof t=="string"?t.replace("%d",e):t(e,v,l.l,D);break}}if(v)return d;var c=D?w.future:w.past;return typeof c=="function"?c(d):c.replace("%s",d)},u.to=function(m,v){return Y(m,v,this,!0)},u.from=function(m,v){return Y(m,v,this)};var E=function(m){return m.$u?o.utc():o()};u.toNow=function(m){return this.to(E(this),m)},u.fromNow=function(m){return this.from(E(this),m)}}})})(J);const ce=J.exports;function de(f={}){const{$dayjs:i,$axios:x}=q();i.extend(ue),i.extend(ce),f={storageKey:"clockify",dateStart:i().startOf("month").format("YYYY-MM-DDTHH:mm:ss.000z"),dateFinal:i().endOf("month").format("YYYY-MM-DDTHH:mm:ss.000z"),currencyFrom:"USD",currencyTo:"BRL",timeEntryParse:n=>n,...f};const y=W(f.dateStart||null),o=W(f.dateFinal||null),u=W(te(f.storageKey,{token:"",amountPerHour:13,amountCurrency:"BRL",amountGoal:1e3,currencyFrom:f.currencyFrom,currencyTo:f.currencyTo,securityMode:!1})),T=async n=>x.request({...n,url:["https://api.clockify.me/api/v1",n.url.replace(/^\/|\/$/g,"")].join("/"),headers:{"X-Api-Key":u.value.token}}),Y=W({loading:!1,currencyFrom:f.currencyFrom,currencyTo:f.currencyTo,rates:{}}),E=async()=>{Y.value.loading=!0;const{data:n}=await x.get(`https://api.exchangerate.host/latest?base=${u.value.currencyFrom}`);Y.value.rates=n.rates,Y.value.loading=!1},m=(n,s=2,a=",",r=".")=>{let[b,z]=parseFloat(n).toFixed(s).split(".");return b=b.split("").reverse().join("").replace(/(\d{3})/g,`$1${r}`).split("").reverse().join(""),[b,z].join(a).replace(new RegExp(`^\\${r}`,"g"),"")},v=(n,s=!0)=>{const a=u.value.currencyTo;return n=n*Y.value.rates[a]||1,s?m(n):n},k=W({loading:!1,data:!1}),_=async()=>{if(!u.value.token)return;k.value.loading=!0;const{data:n}=await T({url:"/user"});k.value.data=n,k.value.loading=!1},g=W({loading:!1,selected:!1,data:[]}),M=async()=>{if(!u.value.token)return;g.value.loading=!0;const{data:n}=await T({url:"/workspaces"});g.value.data=n,n.length==1&&(g.value.selected=n[0]),g.value.loading=!1},d=W({loading:!1,workedMinutes:0,working:!1,data:[]}),D=async()=>{d.value.loading&&clearTimeout(d.value.loading),d.value.loading=setTimeout(async()=>{if(!k.value||!g.value.selected)return;d.value.loading=!0;const{data:n}=await T({url:`/workspaces/${g.value.selected.id}/user/${k.value.data.id}/time-entries`,params:{start:y.value,end:o.value}});d.value.data=n.map(w),d.value.loading=!1},1e3)},w=n=>(n.workedMinutes=(()=>n.timeInterval.end?Math.abs(i(n.timeInterval.start).diff(n.timeInterval.end,"minute")):Math.abs(i(n.timeInterval.start).diff(i(),"minute")))(),n=f.timeEntryParse(n),n);let S;const V=async()=>{S&&clearTimeout(S),S=setInterval(async()=>{d.value.data=d.value.data.map(w);let n=d.value.data.filter(s=>!s.timeInterval.end);d.value.working=n[0]||!1,d.value.workedMinutes=d.value.data.reduce((s,a)=>s+a.workedMinutes,0),i().format("s")==59&&await D()},1e3)},P=()=>{let n=Math.abs(i(y.value).diff(o.value,"days"));return Array.from(Array(n+1).keys()).map(s=>i(y.value).add(s,"days"))},l=n=>[{value:Math.floor(n/60/24/30),signal:"m\xEAs"},{value:Math.floor(n/60/24),signal:"dia(s)"},{value:Math.floor(n/60),signal:"hs"},{value:n%60,signal:"m"}].filter(a=>a.value>0).map(a=>a.value+a.signal).join(", "),e=O(()=>k.value.data&&g.value.data.length>=1&&d.value.data.length>=1),t=O(()=>P().map(n=>{const s=d.value.data.filter(r=>i(r.timeInterval.start).format("YYYY-MM-DD")==n.format("YYYY-MM-DD"));let a={};return a.today=i().format("YYYY-MM-DD")==n.format("YYYY-MM-DD"),a.workingDay=![0,6].includes(n.day()),{date:n,year:n.format("YYYY"),month:n.format("MM"),day:n.format("DD"),is:a,entries:s}})),c=O(()=>{const n=P().filter(r=>![0,6].includes(r.day())),s=r=>(r={description:"",value:0,formatted:b=>b.value,...r},typeof r.value=="function"&&(r.value=r.value(r)),typeof r.description=="function"&&(r.description=r.description(r)),typeof r.formatted=="function"&&(r.formatted=r.formatted(r)),r);let a={};return a.rangeWorkExpected=s({description:`Tempo total esperado para trabalhar (${n.length} dias \xFAteis)`,value:60*8*n.length,formatted:r=>`${(r.value/60).toFixed(0)} horas`}),a.rangeWorkWorked=s({description:"Tempo total trabalhado",value:d.value.workedMinutes,formatted:r=>`${(r.value/60).toFixed(0)} horas`}),a.rangeWorkWorkedPercent=s({description:r=>`${r.value.toFixed(0)}% do m\xEAs trabalhado`,value:a.rangeWorkWorked.value/a.rangeWorkExpected.value*100,formatted:r=>r.value.toFixed(0)+"%"}),a.amountTotal=s({description:"Total para receber",value:d.value.workedMinutes/60*u.value.amountPerHour,formatted:r=>`${m(r.value)} (${u.value.currencyFrom}) / ${v(r.value)} (${u.value.currencyTo})`}),a.rangeWorkDayAverage=s({description:r=>"Quantidade de horas di\xE1rias para alcan\xE7ar a meta",value:r=>{const b=Math.abs(i().diff(o.value,"days")),N=(u.value.amountGoal-a.amountTotal.value)/u.value.amountPerHour;return Math.ceil(N/b)},formatted:r=>`${r.value} horas / dia`}),a.amountGoal=s({description:"Meta mensal",value:u.value.amountGoal,formatted:r=>`${m(r.value)} (${u.value.currencyFrom}) / ${v(r.value)} (${u.value.currencyTo})`}),a.amountGoalPercent=s({description:r=>`${r.value.toFixed(0)}% do valor da meta alcan\xE7ada`,value:a.amountTotal.value/u.value.amountGoal*100,formatted:r=>r.value.toFixed(0)+"%"}),a});return ne([y,o,u],async([n,s])=>{await E(),await D()}),oe(async()=>{await E(),await _(),await M(),await D(),await V()}),re(()=>{S&&clearInterval(S)}),{ready:e,dateStart:y,dateFinal:o,storage:u,currency:Y,currencyLoad:E,currencyFormat:m,currencyConvert:v,user:k,userLoad:_,workspace:g,workspaceLoad:M,timeEntry:d,timeEntryLoad:D,timeHumanize:l,dates:t,result:c}}function K(f={}){const{$dayjs:i}=q();f={date:i().format(),rangeStart:null,rangeFinal:null,...f};const x=W(f.date),y=W(f.rangeStart||null),o=W(f.rangeFinal||null),u=()=>i(x.value),T=()=>y.value?i(y.value):null,Y=()=>o.value?i(o.value):null,E=v=>({current:v.format("YYYY-MM-DD")==u().format("YYYY-MM-DD"),month:v.format("YYYY-MM")==u().format("YYYY-MM"),year:v.format("YYYY")==u().format("YYYY")}),m=O(()=>{const v=T()||u().startOf("month"),k=Y()||u().endOf("month");let _=[];for(let g=0;g<=Math.abs(v.diff(k,"day"));g++){const M=v.add(g,"days");_.push({date:M,is:E(M)})}return _});return{date:x,rangeStart:y,rangeFinal:o,dates:m}}const fe={meta:{active:!0,icon:"mdi-alarm-check",name:"Clockify",description:"Gerenciamento e c\xE1lculo de horas trabalhadas utilizando o app Clockify"},mounted(){},data(){return{clockify:de({timeEntryParse(f){return f.workedMinutesPercent=Math.min(100,f.workedMinutes/(60*14)*100),f}}),calendarDate:K(),calendarRange:K({rangeStart:"2023-01-01T00:00:00.000Z",rangeFinal:"2023-01-05T00:00:00.000Z"}),calendarDisplay:"range",dateStart:!1,dateFinal:!1}}},me={class:"d-flex",style:{gap:"5px"}},ye={style:{"white-space":"nowrap","font-size":"10px"}},he={class:"flex-grow-1 d-flex flex-column justify-end",style:{gap:"3px"}},ve=["title"],ge=h("br",null,null,-1),pe={class:"d-flex flex-column",style:{gap:"5px"}},ke=h("br",null,null,-1),_e=h("div",null,"Working:",-1),Me=h("br",null,null,-1),we=h("br",null,null,-1),xe={class:"d-flex align-center"},Ye={class:"fw-bold ms-3"},be={style:{width:"90vw","max-width":"600px!important",margin:"0 auto"}},$e=h("a",{href:"https://app.clockify.me/user/settings",target:"_blank"}," Acesse sua tela de configura\xE7\xF5es Clockify para gerar o token. ",-1),Te=h("br",null,null,-1),De=h("br",null,null,-1),Fe={class:"d-flex align-center mb-6",style:{gap:"15px"}};function Se(f,i,x,y,o,u){const T=F("v-progress-linear"),Y=F("v-alert"),E=F("v-table"),m=F("v-card"),v=F("v-img"),k=F("v-avatar"),_=F("v-btn"),g=F("v-text-field"),M=F("v-autocomplete"),d=F("v-switch"),D=F("v-card-text"),w=F("v-divider"),S=F("v-spacer"),V=F("v-card-actions"),P=F("v-dialog"),l=ee;return j(),A(l,{title:"Clockify","container-width":"100%"},{drawer:$(()=>[o.clockify.user.data?(j(),C(I,{key:0},[p(D,null,{default:$(()=>[h("div",xe,[p(k,null,{default:$(()=>[p(v,{src:o.clockify.user.data.profilePicture},null,8,["src"])]),_:1}),h("div",Ye,H(o.clockify.user.data.name),1),p(P,null,{activator:$(({props:e})=>[p(_,ae({icon:"mdi-cog",class:"ms-auto",flat:"",size:"20"},e,{ref:"settingsBtn"}),null,16)]),default:$(()=>[h("div",be,[p(m,null,{default:$(()=>[p(D,null,{default:$(()=>[$e,Te,De,p(g,{label:"Token",modelValue:o.clockify.storage.token,"onUpdate:modelValue":i[1]||(i[1]=e=>o.clockify.storage.token=e),class:G({"security-mode":o.clockify.storage.securityMode})},null,8,["modelValue","class"]),h("div",Fe,[p(g,{label:"Converter de",modelValue:o.clockify.storage.amountPerHour,"onUpdate:modelValue":i[2]||(i[2]=e=>o.clockify.storage.amountPerHour=e),modelModifiers:{number:!0},type:"number","hide-details":!0},null,8,["modelValue"]),p(M,{modelValue:o.clockify.storage.currencyFrom,"onUpdate:modelValue":i[3]||(i[3]=e=>o.clockify.storage.currencyFrom=e),items:Object.keys(o.clockify.currency.rates),"hide-details":!0,style:{width:"150px"}},null,8,["modelValue","items"]),p(M,{label:"Para",modelValue:o.clockify.storage.currencyTo,"onUpdate:modelValue":i[4]||(i[4]=e=>o.clockify.storage.currencyTo=e),items:Object.keys(o.clockify.currency.rates),"hide-details":!0,style:{width:"150px"}},null,8,["modelValue","items"])]),p(g,{label:`Meta (${o.clockify.storage.currencyFrom})`,modelValue:o.clockify.storage.amountGoal,"onUpdate:modelValue":i[5]||(i[5]=e=>o.clockify.storage.amountGoal=e),modelModifiers:{number:!0},type:"number","hide-details":!0,suffix:`${o.clockify.currencyConvert(o.clockify.storage.amountGoal)} ${o.clockify.storage.currencyTo}`,class:G({"security-mode":o.clockify.storage.securityMode})},null,8,["label","modelValue","suffix","class"]),p(d,{modelValue:o.clockify.storage.securityMode,"onUpdate:modelValue":i[6]||(i[6]=e=>o.clockify.storage.securityMode=e),"hide-details":"",label:o.clockify.storage.securityMode?"Hidden":"Shown"},null,8,["modelValue","label"])]),_:1}),p(w),p(V,null,{default:$(()=>[p(S),p(_,{onClick:i[7]||(i[7]=e=>{f.$refs.settingsBtn.$el.click()})},{default:$(()=>[L("Ok")]),_:1})]),_:1})]),_:1})])]),_:1})])]),_:1}),p(w)],64)):R("",!0),p(w),p(D,null,{default:$(()=>[p(g,{class:G({"security-mode":o.clockify.storage.securityMode}),label:`\xC0 receber (${o.clockify.storage.currencyFrom})`,"model-value":o.clockify.currencyFormat(o.clockify.result.amountTotal.value),suffix:`${o.clockify.currencyConvert(o.clockify.result.amountTotal.value)} ${o.clockify.storage.currencyTo}`,readonly:""},null,8,["class","label","model-value","suffix"])]),_:1})]),default:$(()=>[h("div",{class:"overflow-auto",ref:"scroll",onWheel:i[0]||(i[0]=le(e=>{f.$refs.scroll.scroll({left:f.$refs.scroll.scrollLeft+e.deltaY*4,top:0,behavior:"smooth"})},["prevent","stop"]))},[h("div",me,[(j(!0),C(I,null,U(o.clockify.dates,e=>(j(),C("div",{class:G(["d-flex flex-column border",{"bg-green-lighten-4":e.is.today,"bg-grey-lighten-4":!e.is.today}]),style:{gap:"2px",padding:"2px","min-width":"70px","max-width":"70px",height:"300px"}},[h("div",{class:G(["text-center py-2 fw-bold",{"bg-green-lighten-2":e.is.today,"bg-grey-lighten-2":!e.is.today}]),style:{"font-size":"12px"}},[h("div",null,H(e.date.format("ddd")),1),h("div",null,H(e.date.format("DD")),1),h("div",ye,"\xA0 "+H(o.clockify.timeHumanize(e.entries.reduce((t,c)=>t+c.workedMinutes,0))),1)],2),h("div",he,[(j(!0),C(I,null,U(e.entries,t=>(j(),C("div",{title:`${t.description} - ${t.workedMinutes} minutes worked`,class:G(["text-center overflow-hidden d-flex align-center justify-center",{"bg-green-lighten-2":o.clockify.timeEntry.working&&o.clockify.timeEntry.working.id==t.id,"bg-grey-lighten-2":!(o.clockify.timeEntry.working&&o.clockify.timeEntry.working.id==t.id)}]),style:ie([{height:`${t.workedMinutesPercent}%`},{"font-size":"10px","white-space":"nowrap"}])},[h("div",null,H(o.clockify.timeHumanize(t.workedMinutes)),1)],14,ve))),256))])],2))),256))])],544),ge,h("div",pe,[p(T,{"model-value":o.clockify.result.rangeWorkWorkedPercent.value,color:"light-green-darken-4",height:"16",striped:!!o.clockify.timeEntry.working,style:{"font-size":"10px"},rounded:""},{default:$(()=>[L(H(o.clockify.result.rangeWorkWorkedPercent.description),1)]),_:1},8,["model-value","striped"]),p(T,{"model-value":o.clockify.result.amountGoalPercent.value,color:"light-green-darken-4",height:"16",striped:!!o.clockify.timeEntry.working,style:{"font-size":"10px"},rounded:""},{default:$(()=>[L(H(o.clockify.result.amountGoalPercent.description),1)]),_:1},8,["model-value","striped"])]),ke,o.clockify.timeEntry.working?(j(),A(Y,{key:0,color:"success"},{default:$(()=>[_e,h("div",null,H(o.clockify.timeEntry.working.description),1),h("div",null,H(o.clockify.timeEntry.working.workedMinutes)+" minutos",1)]),_:1})):R("",!0),Me,p(m,null,{default:$(()=>[p(E,null,{default:$(()=>[h("tbody",null,[(j(!0),C(I,null,U(Object.entries(o.clockify.result),([e,t])=>(j(),C("tr",null,[h("td",null,H(t.description),1),h("td",null,H(t.formatted),1)]))),256))])]),_:1})]),_:1}),we]),_:1})}const He=se(fe,[["render",Se]]);export{He as default};
