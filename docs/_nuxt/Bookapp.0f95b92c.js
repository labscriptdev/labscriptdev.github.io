class u{uuid(e=""){return(e+[1e8]+0).replace(/[018]/g,s=>(s^crypto.getRandomValues(new Uint8Array(1))[0]&15>>s/4).toString(16))}newInstance(e,s){s=new e(s);let n=this;return s.parent=function(){return n},s}newInstances(e,s){return(s||[]).map(n=>this.newInstance(e,n))}}class i extends u{constructor(e={}){super(),this.name=e.name||"Bookapp",this.dependencies=this.newInstances(p,e.dependencies||[]),this.source=e.source||""}dependencyAdd(e={}){this.dependencies.push(this.newInstance(p,e))}dependencyRemove(e){const s=this.dependencies.indexOf(e);this.dependencies.splice(s,1)}build(){let e=[];return e.push("((run = false) => {"),e.push(`  const appData = ${JSON.stringify(this)};`),e.push("  if (!run) return appData;"),e.push(""),e.push("  const promises = appData.dependencies.map((asset, index) => {"),e.push("    return new Promise((resolve, reject) => {"),e.push("      document.body.appendChild(Object.assign(document.createElement(asset.tag), asset, {"),e.push("        src: asset.url,"),e.push("        href: asset.url,"),e.push("        rel: 'stylesheet',"),e.push("        onload: ev => { resolve(); },"),e.push("      }));"),e.push("    });"),e.push("  });"),e.push(""),e.push("  Promise.all(promises).then(resp => {"),e.push(decodeURI(this.source)),e.push("  });"),e.push("  return appData;"),e.push("})"),e=e.join(`
`),e=e.replace(/\n|\t/gi," ").replace(/\s+/gi," "),e}}class p extends u{constructor(e={}){super(),this.id=this.uuid("asset-"),this.url=e.url||"https://cdn.com/package.js",this.tag=e.tag||"link"}}export{i as Bookapp,p as BookappDependency};
