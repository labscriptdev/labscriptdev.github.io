import{p as N,d as M,s as W}from"./styles-88ad4441.c030ec07.js";import{c as S,l as i,i as u,j as H}from"./index.a00d451b.js";import{G as X,l as Y}from"./layout.0b4c808a.js";import{s as l}from"./svgDraw-5d8a058e.3d953bde.js";import"./entry.76f46d94.js";import"./index.dee23a23.js";import"./index.efd3f9dc.js";import"./index.2436dc53.js";import"./index.55f21d26.js";import"./Bookapp.ab6c422f.js";import"./Calculator.266d9ea7.js";import"./index.9f2c9fa7.js";import"./info.054acc3a.js";import"./info.ecb60be2.js";import"./info.1e4bb3a9.js";import"./info.3c1f35c2.js";import"./three.module.8fae685a.js";import"./matter.82a612f9.js";import"./scene-gltf.6f0110b7.js";import"./index.caf67749.js";import"./index.a7d7806e.js";import"./index.ba10b867.js";import"./index.b01b12e4.js";import"./index.4fa6d685.js";import"./index.59977eac.js";import"./index.7234cd1c.js";import"./___vite-browser-external.ee056a94.js";import"./index.8d58be09.js";import"./index.7d7ce856.js";import"./index.8a74e4d3.js";import"./info.72a08ec4.js";import"./info.bfb3dcff.js";import"./info.78333159.js";import"./info.72d8a16d.js";import"./info.71ed9620.js";import"./info.a88b74e6.js";import"./alert.e8c233a4.js";import"./index.896e6822.js";import"https://cdn.skypack.dev/dat.gui@0.7.9";import"./index.0c149d72.js";import"./line.b3aba31d.js";import"./array.9f3ba611.js";import"./path.53f90ab3.js";let g={};const f=20,p=function(e){const d=Object.entries(g).find(k=>k[1].label===e);if(d)return d[0]},Z=function(e){e.append("defs").append("marker").attr("id","extensionStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),e.append("defs").append("marker").attr("id","extensionEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z"),e.append("defs").append("marker").attr("id","compositionStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id","compositionEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id","aggregationStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id","aggregationEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id","dependencyStart").attr("class","extension").attr("refX",0).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id","dependencyEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},D=function(e,d,k,a){const m=S().class;g={},i.info("Rendering diagram "+e);const L=S().securityLevel;let y;L==="sandbox"&&(y=u("#i"+d));const x=L==="sandbox"?u(y.nodes()[0].contentDocument.body):u("body"),o=x.select(`[id='${d}']`);Z(o);const r=new X({multigraph:!0});r.setGraph({isMultiGraph:!0}),r.setDefaultEdgeLabel(function(){return{}});const h=a.db.getClasses(),$=Object.keys(h);for(const t of $){const n=h[t],s=l.drawClass(o,n,m,a);g[s.id]=s,r.setNode(s.id,s),i.info("Org height: "+s.height)}a.db.getRelations().forEach(function(t){i.info("tjoho"+p(t.id1)+p(t.id2)+JSON.stringify(t)),r.setEdge(p(t.id1),p(t.id2),{relation:t},t.title||"DEFAULT")}),a.db.getNotes().forEach(function(t){i.debug(`Adding note: ${JSON.stringify(t)}`);const n=l.drawNote(o,t,m,a);g[n.id]=n,r.setNode(n.id,n),t.class&&t.class in h&&r.setEdge(t.id,p(t.class),{relation:{id1:t.id,id2:t.class,relation:{type1:"none",type2:"none",lineType:10}}},"DEFAULT")}),Y(r),r.nodes().forEach(function(t){t!==void 0&&r.node(t)!==void 0&&(i.debug("Node "+t+": "+JSON.stringify(r.node(t))),x.select("#"+(a.db.lookUpDomId(t)||t)).attr("transform","translate("+(r.node(t).x-r.node(t).width/2)+","+(r.node(t).y-r.node(t).height/2)+" )"))}),r.edges().forEach(function(t){t!==void 0&&r.edge(t)!==void 0&&(i.debug("Edge "+t.v+" -> "+t.w+": "+JSON.stringify(r.edge(t))),l.drawEdge(o,r.edge(t),r.edge(t).relation,m,a))});const c=o.node().getBBox(),E=c.width+f*2,b=c.height+f*2;H(o,b,E,m.useMaxWidth);const w=`${c.x-f} ${c.y-f} ${E} ${b}`;i.debug(`viewBox ${w}`),o.attr("viewBox",w)},B={draw:D},$t={parser:N,db:M,renderer:B,styles:W,init:e=>{e.class||(e.class={}),e.class.arrowMarkerAbsolute=e.arrowMarkerAbsolute,M.clear()}};export{$t as diagram};
