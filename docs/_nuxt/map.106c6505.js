import n from"./base.3e4441c7.js";import{L as i}from"./leaflet-src.be40a842.js";import{Y as m,o as r,f as p}from"./entry.d6e52356.js";const h={extends:n,props:{center:{type:Array,default:()=>[0,0]},zoom:{type:Number,default:5},tileLayer:{type:[String],default:"https://tile.openstreetmap.org/{z}/{x}/{y}.png"},bounds:{type:Array,default:()=>[0,0,0,0]}},watch:{$props:{deep:!0,handler(t){t.zoom!=this.map.getZoom()&&this.map.setZoom(t.zoom),t.tileLayer!=this.mapTileLayer._url&&this.mapTileLayer.setUrl(t.tileLayer)}}},methods:{mapInit(){this.map=i.map(this.$el,{center:this.center,zoom:this.zoom}),this.mapTileLayer=i.tileLayer(this.tileLayer,{}).addTo(this.map),this.map.on("moveend",async e=>{const o=Object.values(this.map.getCenter());this.$emit("update:center",o),this.$emit("update:bounds",this.getBounds())}),this.map.on("zoomend",async e=>{this.$emit("update:zoom",this.map.getZoom()),this.$emit("update:bounds",this.getBounds())}),["zoomlevelschange","resize","unload","viewreset","load","zoomstart","movestart","zoom","move","zoomend","moveend","popupopen","popupclose","autopanstart","tooltipopen","tooltipclose","locationerror","locationfound","click","dblclick","mousedown","mouseup","mouseover","mouseout","mousemove","contextmenu","keypress","keydown","keyup","preclick","zoomanim"].forEach(e=>{this.map.on(e,o=>{this.emitMerge(`map:${e}`,{event:o}),this.emitMerge("map:any",{event:o})})});const t=new Event("init");this.emitMerge("map:init",{event:t}),this.emitMerge("map:any",{event:t})},emitMerge(t,e={}){this.$emit(t,{type:t,map:this.map,zoom:this.map.getZoom(),center:this.map.getCenter(),bounds:this.getBounds(),osmUrl:this.getOsmUrl(),xy:this.getXY(),...e})},getOsmUrl(){return`https://api.openstreetmap.org/api/0.6/map?[out:json];out;&bbox=${this.getBounds().join(",")}`},getBounds(){const t=this.map.getBounds();return[t.getWest(),t.getSouth(),t.getEast(),t.getNorth()]},getXY(){const[t,e]=this.center,o=this.map.getZoom(),s=Math.floor((1-Math.log(Math.tan(t*Math.PI/180)+1/Math.cos(t*Math.PI/180))/Math.PI)/2*Math.pow(2,o)),a=Math.floor((e+180)/360*Math.pow(2,o));return{x:s,y:a}}},data(){return{map:!1,mapTileLayer:!1}},mounted(){this.mapInit()}},u={style:{height:"400px"}};function l(t,e,o,s,a,c){return r(),p("div",u)}const f=m(h,[["render",l]]);export{f as default};
