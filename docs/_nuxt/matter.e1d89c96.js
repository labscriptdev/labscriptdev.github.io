import{O as Ne,V as O,A as Ge,L as Ue,B as $e,a as q,R as je,b as Oe,P as ue,T as Qe,c as Ze,F as Te,d as Ve,e as Ke,f as ye}from"./three.module.2ad6d296.js";import{q as te}from"./entry.8823a7a8.js";const le=new Map,Je=5,Y=(V,y=!1)=>{if(!le.has(V))le.set(V,1);else{const d=le.get(V);if(typeof d>"u"||d>=Je)return;le.set(V,d+1)}y?console.error(`%c [enable3d] ${V} `,"background: #222; color: #bada55"):console.warn(`%c [enable3d] ${V} `,"background: #222; color: #bada55")};var we={},me={};Object.defineProperty(me,"__esModule",{value:!0});me.VERSION=void 0;me.VERSION="0.0.5";/**
 * @package      npmjs.com/package/@yandeu/events (events.min.js)
 *
 * @author       Arnout Kazemier (https://github.com/3rd-Eden)
 * @copyright    Copyright (c) 2014 Arnout Kazemier
 * @license      {@link https://github.com/primus/eventemitter3/blob/master/LICENSE|MIT}
 *
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/yandeu/events
 * @license      {@link https://github.com/yandeu/events/blob/master/LICENSE|MIT}
 */var Ee=te&&te.__spreadArray||function(V,y){for(var d=0,P=y.length,u=V.length;d<P;d++,u++)V[u]=y[d];return V};Object.defineProperty(we,"__esModule",{value:!0});var Xe=we.Events=void 0,Ye=me,qe=function(){function V(y,d,P){P===void 0&&(P=!1),this.fn=y,this.context=d,this.once=P}return V}(),Ie=function(V,y,d,P,u){if(typeof d!="function")throw new TypeError("The listener must be a function");var e=new qe(d,P||V,u);return V._events.has(y)?V._events.get(y).fn?V._events.set(y,[V._events.get(y),e]):V._events.get(y).push(e):(V._events.set(y,e),V._eventsCount++),V},fe=function(V,y){--V._eventsCount===0?V._events=new Map:V._events.delete(y)},_e=function(){function V(){this._events=new Map,this._eventsCount=0}return Object.defineProperty(V,"VERSION",{get:function(){return Ye.VERSION},enumerable:!1,configurable:!0}),V.prototype.eventNames=function(){return Array.from(this._events.keys())},V.prototype.listeners=function(y){var d=this._events.get(y);if(!d)return[];if(d.fn)return[d.fn];for(var P=0,u=d.length,e=new Array(u);P<u;P++)e[P]=d[P].fn;return e},V.prototype.listenerCount=function(y){var d=this._events.get(y);return d?d.fn?1:d.length:0},V.prototype.emit=function(y){for(var d,P,u=[],e=1;e<arguments.length;e++)u[e-1]=arguments[e];if(!this._events.has(y))return!1;var o=this._events.get(y),n;if(o.fn)return o.once&&this.removeListener(y,o.fn,void 0,!0),(d=o.fn).call.apply(d,Ee([o.context],u)),!0;var r=o.length;for(n=0;n<r;n++)o[n].once&&this.removeListener(y,o[n].fn,void 0,!0),(P=o[n].fn).call.apply(P,Ee([o[n].context],u));return!0},V.prototype.on=function(y,d,P){return Ie(this,y,d,P,!1)},V.prototype.once=function(y,d,P){return Ie(this,y,d,P,!0)},V.prototype.removeListener=function(y,d,P,u){if(!this._events.has(y))return this;if(!d)return fe(this,y),this;var e=this._events.get(y);if(e.fn)e.fn===d&&(!u||e.once)&&(!P||e.context===P)&&fe(this,y);else{for(var o=0,n=[],r=e.length;o<r;o++)(e[o].fn!==d||u&&!e[o].once||P&&e[o].context!==P)&&n.push(e[o]);n.length?this._events.set(y,n.length===1?n[0]:n):fe(this,y)}return this},V.prototype.removeAllListeners=function(y){return y?this._events.delete(y)&&fe(this,y):(this._events=new Map,this._eventsCount=0),this},Object.defineProperty(V.prototype,"off",{get:function(){return this.removeListener},enumerable:!1,configurable:!0}),Object.defineProperty(V.prototype,"addListener",{get:function(){return this.on},enumerable:!1,configurable:!0}),V}();Xe=we.Events=_e;/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */class pt extends Ne{constructor(){super(),this.isExtendedObject3D=!0,this.isGroup=!1,this.vector3=new O,this.hasBody=!1,this.fragmentDepth=0,this.breakable=!1,this.fractureImpulse=1,this._currentAnimation="",this._animationActions=new Map,this.name=`object-${this.id}`}get world(){return{theta:this.worldTheta,phi:this.worldPhi}}get worldTheta(){return this.getWorldDirection(this.vector3),Math.atan2(this.vector3.x,this.vector3.z)}get worldPhi(){return this.getWorldDirection(this.vector3),Math.acos(this.vector3.y)}set animationMixer(y){this._animationMixer=y}get animationMixer(){return this._animationMixer||(this._animationMixer=new Ge(this)),this._animationMixer}get anims(){return{current:this._currentAnimation,add:(y,d)=>this._animsAdd(y,d),get:y=>this._animsGet(y),play:(y,d=500,P=!0)=>this._animsPlay(y,d,P),mixer:this.animationMixer}}get animation(){return Y('Please use "anims" instead of "animation"'),this.anims}_animsAdd(y,d){this._animationActions.set(y,this.animationMixer.clipAction(d))}_animsGet(y){const d=this._animationActions.get(y);return d||Y(`Animation(${y}) not found!`),d}_animsPlay(y,d=500,P=!0){const u=this._animationActions.get(y),e=this._animationActions.get(this._currentAnimation);u&&(u.reset(),e&&(u.crossFadeFrom(e,d/1e3,!0),u.clampWhenFinished=!0),P||u.setLoop(Ue,0),u.play()),this._currentAnimation=y}setAction(y){Y(`setAction(${y}) is deprecated. Use animation.play(${y}) instead!`)}traverse(y){super.traverse(y)}traverseVisible(y){super.traverseVisible(y)}traverseAncestors(y){super.traverseAncestors(y)}}const ne={BOX:"box",CYLINDER:"cylinder",SPHERE:"sphere",CAPSULE:"capsule",CONE:"cone",HULL:"hull",HACD:"hacd",VHACD:"vhacd",MESH:"mesh",HEIGHTFIELD:"heightfield"},ie={ALL:"all",MANUAL:"manual"},gt=function(){const V=new O,y=new O,d=new q;return function(P,u,e,o={}){if(o.type=ne.HULL,ve(o),o.fit===ie.MANUAL)return console.warn("cannot use fit: manual with type: hull"),null;const n=Se(P,u),r=new Ammo.btVector3,c=new Ammo.btConvexHullShape;c.setMargin(o.margin),y.addVectors(n.max,n.min).multiplyScalar(.5);let l=0;for(let i=0;i<P.length;i++)l+=P[i].length/3;const f=o.hullMaxVertices||1e5;l>f&&console.warn(`too many vertices for hull shape; sampling ~${f} from ~${l} vertices`);const s=Math.min(1,f/l);for(let i=0;i<P.length;i++){const a=P[i];d.fromArray(u[i]);for(let m=0;m<a.length;m+=3){const p=i===P.length-1&&m===a.length-3;(Math.random()<=s||p)&&(V.set(a[m],a[m+1],a[m+2]).applyMatrix4(d).sub(y),r.setValue(V.x,V.y,V.z),c.addPoint(r,p))}}let t=c;if(c.getNumVertices()>=100){const i=new Ammo.btShapeHull(c);i.buildHull(o.margin),Ammo.destroy(c),t=new Ammo.btConvexHullShape(Ammo.getPointer(i.getVertexPointer()),i.numVertices()),Ammo.destroy(i)}return Ammo.destroy(r),pe(t,o,ge(e,o)),t}}(),dt=function(){const V=new O,y=new O,d=new q;return function(P,u,e,o,n={}){if(n.type=ne.HACD,ve(n),n.fit===ie.MANUAL)return console.warn("cannot use fit: manual with type: hacd"),[];if(!Ammo.hasOwnProperty("HACD"))return console.warn("HACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const r=Se(P,u);ge(o,n);let c=0,l=0;y.addVectors(r.max,r.min).multiplyScalar(.5);for(let S=0;S<P.length;S++)c+=P[S].length/3,e&&e[S]?l+=e[S].length/3:l+=P[S].length/9;const f=new Ammo.HACD;n.hasOwnProperty("compacityWeight")&&f.SetCompacityWeight(n.compacityWeight),n.hasOwnProperty("volumeWeight")&&f.SetVolumeWeight(n.volumeWeight),n.hasOwnProperty("nClusters")&&f.SetNClusters(n.nClusters),n.hasOwnProperty("nVerticesPerCH")&&f.SetNVerticesPerCH(n.nVerticesPerCH),n.hasOwnProperty("concavity")&&f.SetConcavity(n.concavity);const s=Ammo._malloc(c*3*8),t=Ammo._malloc(l*3*4);f.SetPoints(s),f.SetTriangles(t),f.SetNPoints(c),f.SetNTriangles(l);let i=s/8,a=t/4;for(let S=0;S<P.length;S++){const w=P[S];d.fromArray(u[S]);for(let h=0;h<w.length;h+=3)V.set(w[h+0],w[h+1],w[h+2]).applyMatrix4(d).sub(y),Ammo.HEAPF64[i+0]=V.x,Ammo.HEAPF64[i+1]=V.y,Ammo.HEAPF64[i+2]=V.z,i+=3;if(e[S]){const h=e[S];for(let v=0;v<h.length;v++)Ammo.HEAP32[a]=h[v],a++}else for(let h=0;h<w.length/3;h++)Ammo.HEAP32[a]=h,a++}f.Compute(),Ammo._free(s),Ammo._free(t);const m=f.GetNClusters(),p=[];for(let S=0;S<m;S++){const w=new Ammo.btConvexHullShape;w.setMargin(n.margin);const h=f.GetNPointsCH(S),v=f.GetNTrianglesCH(S),x=Ammo._malloc(h*3*8),g=Ammo._malloc(v*3*4);f.GetCH(S,x,g);const M=x/8;for(let A=0;A<h;A++){const T=new Ammo.btVector3,C=Ammo.HEAPF64[M+A*3+0],E=Ammo.HEAPF64[M+A*3+1],I=Ammo.HEAPF64[M+A*3+2];T.setValue(C,E,I),w.addPoint(T,A===h-1),Ammo.destroy(T)}pe(),p.push(w)}return p}}(),xt=function(){const V=new O,y=new O,d=new q;return function(P,u,e,o,n={}){if(n.type=ne.VHACD,ve(n),n.fit===ie.MANUAL)return console.warn("cannot use fit: manual with type: vhacd"),[];if(!Ammo.hasOwnProperty("VHACD"))return console.warn("VHACD unavailable in included build of Ammo.js. Visit https://github.com/mozillareality/ammo.js for the latest version."),[];const r=Se(P,u);ge(o,n);let c=0,l=0;y.addVectors(r.max,r.min).multiplyScalar(.5);for(let h=0;h<P.length;h++)c+=P[h].length/3,e&&e[h]?l+=e[h].length/3:l+=P[h].length/9;const f=new Ammo.VHACD,s=new Ammo.Parameters;n.hasOwnProperty("resolution")&&s.set_m_resolution(n.resolution),n.hasOwnProperty("depth")&&s.set_m_depth(n.depth),n.hasOwnProperty("concavity")&&s.set_m_concavity(n.concavity),n.hasOwnProperty("planeDownsampling")&&s.set_m_planeDownsampling(n.planeDownsampling),n.hasOwnProperty("convexhullDownsampling")&&s.set_m_convexhullDownsampling(n.convexhullDownsampling),n.hasOwnProperty("alpha")&&s.set_m_alpha(n.alpha),n.hasOwnProperty("beta")&&s.set_m_beta(n.beta),n.hasOwnProperty("gamma")&&s.set_m_gamma(n.gamma),n.hasOwnProperty("pca")&&s.set_m_pca(n.pca),n.hasOwnProperty("mode")&&s.set_m_mode(n.mode),n.hasOwnProperty("maxNumVerticesPerCH")&&s.set_m_maxNumVerticesPerCH(n.maxNumVerticesPerCH),n.hasOwnProperty("minVolumePerCH")&&s.set_m_minVolumePerCH(n.minVolumePerCH),n.hasOwnProperty("convexhullApproximation")&&s.set_m_convexhullApproximation(n.convexhullApproximation),n.hasOwnProperty("oclAcceleration")&&s.set_m_oclAcceleration(n.oclAcceleration);const t=Ammo._malloc(c*3*8+3),i=Ammo._malloc(l*3*4);let a=t/8,m=i/4;for(let h=0;h<P.length;h++){const v=P[h];d.fromArray(u[h]);for(let x=0;x<v.length;x+=3)V.set(v[x+0],v[x+1],v[x+2]).applyMatrix4(d).sub(y),Ammo.HEAPF64[a+0]=V.x,Ammo.HEAPF64[a+1]=V.y,Ammo.HEAPF64[a+2]=V.z,a+=3;if(e[h]){const x=e[h];for(let g=0;g<x.length;g++)Ammo.HEAP32[m]=x[g],m++}else for(let x=0;x<v.length/3;x++)Ammo.HEAP32[m]=x,m++}f.Compute(t,3,c,i,3,l,s),Ammo._free(t),Ammo._free(i);const p=f.GetNConvexHulls(),S=[],w=new Ammo.ConvexHull;for(let h=0;h<p;h++){f.GetConvexHull(h,w);const v=w.get_m_nPoints();w.get_m_points();const x=new Ammo.btConvexHullShape;x.setMargin(n.margin);for(let g=0;g<v;g++){const M=new Ammo.btVector3,A=w.get_m_points(g*3+0),T=w.get_m_points(g*3+1),C=w.get_m_points(g*3+2);M.setValue(A,T,C),x.addPoint(M,g===v-1),Ammo.destroy(M)}pe(),S.push(x)}return Ammo.destroy(w),Ammo.destroy(f),S}}(),yt=function(){const V=new O,y=new O,d=new O,P=new q;return function(u,e,o,n,r={}){if(r.type=ne.MESH,ve(r),r.fit===ie.MANUAL)return console.warn("cannot use fit: manual with type: mesh"),null;const c=ge(n,r),l=new Ammo.btVector3,f=new Ammo.btVector3,s=new Ammo.btVector3,t=new Ammo.btTriangleMesh(!0,!1);for(let m=0;m<u.length;m++){const p=u[m],S=o[m]?o[m]:null;if(P.fromArray(e[m]),S)for(let w=0;w<S.length;w+=3){const h=S[w]*3,v=S[w+1]*3,x=S[w+2]*3;V.set(p[h],p[h+1],p[h+2]).applyMatrix4(P),y.set(p[v],p[v+1],p[v+2]).applyMatrix4(P),d.set(p[x],p[x+1],p[x+2]).applyMatrix4(P),l.setValue(V.x,V.y,V.z),f.setValue(y.x,y.y,y.z),s.setValue(d.x,d.y,d.z),t.addTriangle(l,f,s,!1)}else for(let w=0;w<p.length;w+=9)V.set(p[w+0],p[w+1],p[w+2]).applyMatrix4(P),y.set(p[w+3],p[w+4],p[w+5]).applyMatrix4(P),d.set(p[w+6],p[w+7],p[w+8]).applyMatrix4(P),l.setValue(V.x,V.y,V.z),f.setValue(y.x,y.y,y.z),s.setValue(d.x,d.y,d.z),t.addTriangle(l,f,s,!1)}const i=new Ammo.btVector3(c.x,c.y,c.z);t.setScaling(i),Ammo.destroy(i);let a;return r.concave?a=new Ammo.btBvhTriangleMeshShape(t,!0,!0):a=new Ammo.btConvexTriangleMeshShape(t,!0),a.resources=[t],Ammo.destroy(l),Ammo.destroy(f),Ammo.destroy(s),pe(),a}}();function ve(V){V.type=V.type||ne.HULL,V.margin=V.hasOwnProperty("margin")?V.margin:.01}const pe=function(V,y,d){},wt=function(){const V=new q;return function(y,d,P){parseInt(je)>=123?V.copy(y.matrixWorld).invert():V.getInverse(y.matrixWorld),new O().setFromMatrixScale(y.matrixWorld),y.traverse(e=>{const o=new q;e.isMesh&&(d.includeInvisible||e.el&&e.el.object3D.visible||e.visible)&&(e===y?o.identity():(e.updateWorldMatrix(!0),o.multiplyMatrices(V,e.matrixWorld)),P(e.geometry.isBufferGeometry?e.geometry.attributes.position.array:e.geometry.vertices,o.elements,e.geometry.index?e.geometry.index.array:null))})}}(),ge=function(){const V=new q;return function(y,d={}){const P=new O(1,1,1);return d.fit===ie.ALL&&(V.fromArray(y),P.setFromMatrixScale(V)),P}}();(function(){const V=new O;return function(y,d,P){let u=0,{x:e,y:o,z:n}=P.getCenter(V);return De(y,d,r=>{const c=e-r.x,l=o-r.y,f=n-r.z;u=Math.max(u,c*c+l*l+f*f)}),Math.sqrt(u)}})();const Se=function(V,y){const d=new $e;let P=1/0,u=1/0,e=1/0,o=-1/0,n=-1/0,r=-1/0;return d.min.set(0,0,0),d.max.set(0,0,0),De(V,y,c=>{c.x<P&&(P=c.x),c.y<u&&(u=c.y),c.z<e&&(e=c.z),c.x>o&&(o=c.x),c.y>n&&(n=c.y),c.z>r&&(r=c.z)}),d.min.set(P,u,e),d.max.set(o,n,r),d},De=function(){const V=new O,y=new q;return function(d,P,u){for(let e=0;e<d.length;e++){y.fromArray(P[e]);for(let o=0;o<d[e].length;o+=3)V.set(d[e][o],d[e][o+1],d[e][o+2]).applyMatrix4(y),u(V)}}}(),he=0,et=1,tt=new O,Re=new Oe,de=new ue,Fe=new O,ce=new Qe;class nt{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new He,this.unassigned=new He,this.vertices=[]}setFromPoints(y){if(y.length>=4){this.makeEmpty();for(let d=0,P=y.length;d<P;d++)this.vertices.push(new it(y[d]));this.compute()}return this}setFromObject(y){const d=[];return y.updateMatrixWorld(!0),y.traverse(function(P){const u=P.geometry;if(u!==void 0){const e=u.attributes.position;if(e!==void 0)for(let o=0,n=e.count;o<n;o++){const r=new O;r.fromBufferAttribute(e,o).applyMatrix4(P.matrixWorld),d.push(r)}}}),this.setFromPoints(d)}containsPoint(y){const d=this.faces;for(let P=0,u=d.length;P<u;P++)if(d[P].distanceToPoint(y)>this.tolerance)return!1;return!0}intersectRay(y,d){const P=this.faces;let u=-1/0,e=1/0;for(let o=0,n=P.length;o<n;o++){const r=P[o],c=r.distanceToPoint(y.origin),l=r.normal.dot(y.direction);if(c>0&&l>=0)return null;const f=l!==0?-c/l:0;if(!(f<=0)&&(l>0?e=Math.min(f,e):u=Math.max(f,u),u>e))return null}return u!==-1/0?y.at(u,d):y.at(e,d),d}intersectsRay(y){return this.intersectRay(y,tt)!==null}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(y,d){return y.face=d,d.outside===null?this.assigned.append(y):this.assigned.insertBefore(d.outside,y),d.outside=y,this}removeVertexFromFace(y,d){return y===d.outside&&(y.next!==null&&y.next.face===d?d.outside=y.next:d.outside=null),this.assigned.remove(y),this}removeAllVerticesFromFace(y){if(y.outside!==null){const d=y.outside;let P=y.outside;for(;P.next!==null&&P.next.face===y;)P=P.next;return this.assigned.removeSubList(d,P),d.prev=P.next=null,y.outside=null,d}}deleteFaceVertices(y,d){const P=this.removeAllVerticesFromFace(y);if(P!==void 0)if(d===void 0)this.unassigned.appendChain(P);else{let u=P;do{const e=u.next;d.distanceToPoint(u.point)>this.tolerance?this.addVertexToFace(u,d):this.unassigned.append(u),u=e}while(u!==null)}return this}resolveUnassignedPoints(y){if(this.unassigned.isEmpty()===!1){let d=this.unassigned.first();do{const P=d.next;let u=this.tolerance,e=null;for(let o=0;o<y.length;o++){const n=y[o];if(n.mark===he){const r=n.distanceToPoint(d.point);if(r>u&&(u=r,e=n),u>1e3*this.tolerance)break}}e!==null&&this.addVertexToFace(d,e),d=P}while(d!==null)}return this}computeExtremes(){const y=new O,d=new O,P=[],u=[];for(let e=0;e<3;e++)P[e]=u[e]=this.vertices[0];y.copy(this.vertices[0].point),d.copy(this.vertices[0].point);for(let e=0,o=this.vertices.length;e<o;e++){const n=this.vertices[e],r=n.point;for(let c=0;c<3;c++)r.getComponent(c)<y.getComponent(c)&&(y.setComponent(c,r.getComponent(c)),P[c]=n);for(let c=0;c<3;c++)r.getComponent(c)>d.getComponent(c)&&(d.setComponent(c,r.getComponent(c)),u[c]=n)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(y.x),Math.abs(d.x))+Math.max(Math.abs(y.y),Math.abs(d.y))+Math.max(Math.abs(y.z),Math.abs(d.z))),{min:P,max:u}}computeInitialHull(){const y=this.vertices,d=this.computeExtremes(),P=d.min,u=d.max;let e=0,o=0;for(let s=0;s<3;s++){const t=u[s].point.getComponent(s)-P[s].point.getComponent(s);t>e&&(e=t,o=s)}const n=P[o],r=u[o];let c,l;e=0,Re.set(n.point,r.point);for(let s=0,t=this.vertices.length;s<t;s++){const i=y[s];if(i!==n&&i!==r){Re.closestPointToPoint(i.point,!0,Fe);const a=Fe.distanceToSquared(i.point);a>e&&(e=a,c=i)}}e=-1,de.setFromCoplanarPoints(n.point,r.point,c.point);for(let s=0,t=this.vertices.length;s<t;s++){const i=y[s];if(i!==n&&i!==r&&i!==c){const a=Math.abs(de.distanceToPoint(i.point));a>e&&(e=a,l=i)}}const f=[];if(de.distanceToPoint(l.point)<0){f.push(Q.create(n,r,c),Q.create(l,r,n),Q.create(l,c,r),Q.create(l,n,c));for(let s=0;s<3;s++){const t=(s+1)%3;f[s+1].getEdge(2).setTwin(f[0].getEdge(t)),f[s+1].getEdge(1).setTwin(f[t+1].getEdge(0))}}else{f.push(Q.create(n,c,r),Q.create(l,n,r),Q.create(l,r,c),Q.create(l,c,n));for(let s=0;s<3;s++){const t=(s+1)%3;f[s+1].getEdge(2).setTwin(f[0].getEdge((3-s)%3)),f[s+1].getEdge(0).setTwin(f[t+1].getEdge(1))}}for(let s=0;s<4;s++)this.faces.push(f[s]);for(let s=0,t=y.length;s<t;s++){const i=y[s];if(i!==n&&i!==r&&i!==c&&i!==l){e=this.tolerance;let a=null;for(let m=0;m<4;m++){const p=this.faces[m].distanceToPoint(i.point);p>e&&(e=p,a=this.faces[m])}a!==null&&this.addVertexToFace(i,a)}}return this}reindexFaces(){const y=[];for(let d=0;d<this.faces.length;d++){const P=this.faces[d];P.mark===he&&y.push(P)}return this.faces=y,this}nextVertexToAdd(){if(this.assigned.isEmpty()===!1){let y,d=0;const P=this.assigned.first().face;let u=P.outside;do{const e=P.distanceToPoint(u.point);e>d&&(d=e,y=u),u=u.next}while(u!==null&&u.face===P);return y}}computeHorizon(y,d,P,u){this.deleteFaceVertices(P),P.mark=et;let e;d===null?e=d=P.getEdge(0):e=d.next;do{const o=e.twin,n=o.face;n.mark===he&&(n.distanceToPoint(y)>this.tolerance?this.computeHorizon(y,o,n,u):u.push(e)),e=e.next}while(e!==d);return this}addAdjoiningFace(y,d){const P=Q.create(y,d.tail(),d.head());return this.faces.push(P),P.getEdge(-1).setTwin(d.twin),P.getEdge(0)}addNewFaces(y,d){this.newFaces=[];let P=null,u=null;for(let e=0;e<d.length;e++){const o=d[e],n=this.addAdjoiningFace(y,o);P===null?P=n:n.next.setTwin(u),this.newFaces.push(n.face),u=n}return P.next.setTwin(u),this}addVertexToHull(y){const d=[];return this.unassigned.clear(),this.removeVertexFromFace(y,y.face),this.computeHorizon(y.point,null,y.face,d),this.addNewFaces(y,d),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let y;for(this.computeInitialHull();(y=this.nextVertexToAdd())!==void 0;)this.addVertexToHull(y);return this.reindexFaces(),this.cleanup(),this}}class Q{constructor(){this.normal=new O,this.midpoint=new O,this.area=0,this.constant=0,this.outside=null,this.mark=he,this.edge=null}static create(y,d,P){const u=new Q,e=new xe(y,u),o=new xe(d,u),n=new xe(P,u);return e.next=n.prev=o,o.next=e.prev=n,n.next=o.prev=e,u.edge=e,u.compute()}getEdge(y){let d=this.edge;for(;y>0;)d=d.next,y--;for(;y<0;)d=d.prev,y++;return d}compute(){const y=this.edge.tail(),d=this.edge.head(),P=this.edge.next.head();return ce.set(y.point,d.point,P.point),ce.getNormal(this.normal),ce.getMidpoint(this.midpoint),this.area=ce.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(y){return this.normal.dot(y)-this.constant}}class xe{constructor(y,d){this.vertex=y,this.prev=null,this.next=null,this.twin=null,this.face=d}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const y=this.head(),d=this.tail();return d!==null?d.point.distanceTo(y.point):-1}lengthSquared(){const y=this.head(),d=this.tail();return d!==null?d.point.distanceToSquared(y.point):-1}setTwin(y){return this.twin=y,y.twin=this,this}}class it{constructor(y){this.point=y,this.prev=null,this.next=null,this.face=null}}class He{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(y,d){return d.prev=y.prev,d.next=y,d.prev===null?this.head=d:d.prev.next=d,y.prev=d,this}insertAfter(y,d){return d.prev=y,d.next=y.next,d.next===null?this.tail=d:d.next.prev=d,y.next=d,this}append(y){return this.head===null?this.head=y:this.tail.next=y,y.prev=this.tail,y.next=null,this.tail=y,this}appendChain(y){for(this.head===null?this.head=y:this.tail.next=y,y.prev=this.tail;y.next!==null;)y=y.next;return this.tail=y,this}remove(y){return y.prev===null?this.head=y.next:y.prev.next=y.next,y.next===null?this.tail=y.prev:y.next.prev=y.prev,this}removeSubList(y,d){return y.prev===null?this.head=d.next:y.prev.next=d.next,d.next===null?this.tail=y.prev:d.next.prev=y.prev,this}isEmpty(){return this.head===null}}class st extends Ze{constructor(y=[]){super();const d=[],P=[],e=new nt().setFromPoints(y).faces;for(let o=0;o<e.length;o++){const n=e[o];let r=n.edge;do{const c=r.head().point;d.push(c.x,c.y,c.z),P.push(n.normal.x,n.normal.y,n.normal.z),r=r.next}while(r!==n.edge)}this.setAttribute("position",new Te(d,3)),this.setAttribute("normal",new Te(P,3))}}const Be=V=>{const y=window.THREE&&window.THREE.ConvexGeometry?window.THREE.ConvexGeometry:st;return new y(V)},X=function(V,y){this.minSizeForBreak=V||1.4,this.smallDelta=y||1e-4,this.tempLine1=new Oe,this.tempPlane1=new ue,this.tempPlane2=new ue,this.tempPlane_Cut=new ue,this.tempCM1=new O,this.tempCM2=new O,this.tempVector3=new O,this.tempVector3_2=new O,this.tempVector3_3=new O,this.tempVector3_P0=new O,this.tempVector3_P1=new O,this.tempVector3_P2=new O,this.tempVector3_N0=new O,this.tempVector3_N1=new O,this.tempVector3_AB=new O,this.tempVector3_CB=new O,this.tempResultObjects={object1:null,object2:null},this.segments=[];for(var d=30*30,P=0;P<d;P++)this.segments[P]=!1};X.prototype={constructor:X,prepareBreakableObject:function(V,y,d,P,u){V.geometry.isBufferGeometry||console.error("THREE.ConvexObjectBreaker.prepareBreakableObject(): Parameter object must have a BufferGeometry."),V.userData.ammoPhysicsData={};var e=V.userData.ammoPhysicsData;e.mass=y,e.velocity=d.clone(),e.angularVelocity=P.clone(),e.breakable=u},subdivideByImpact:function(V,y,d,P,u){var e=[],o=this.tempPlane1,n=this.tempPlane2;this.tempVector3.addVectors(y,d),o.setFromCoplanarPoints(y,V.position,this.tempVector3);var r=u+P,c=this;function l(f,s,t,i){if(Math.random()<i*.05||i>r){e.push(f);return}var a=Math.PI;i===0?(n.normal.copy(o.normal),n.constant=o.constant):i<=P?(a=(t-s)*(.2+.6*Math.random())+s,c.tempVector3_2.copy(V.position).sub(y).applyAxisAngle(d,a).add(y),n.setFromCoplanarPoints(y,c.tempVector3,c.tempVector3_2)):(a=(.5*(i&1)+.2*(2-Math.random()))*Math.PI,c.tempVector3_2.copy(y).sub(f.position).applyAxisAngle(d,a).add(f.position),c.tempVector3_3.copy(d).add(f.position),n.setFromCoplanarPoints(f.position,c.tempVector3_3,c.tempVector3_2)),c.cutByPlane(f,n,c.tempResultObjects);var m=c.tempResultObjects.object1,p=c.tempResultObjects.object2;m&&l(m,s,a,i+1),p&&l(p,a,t,i+1)}return l(V,0,2*Math.PI,0),e},cutByPlane:function(V,y,d){var P=V.geometry,u=P.attributes.position.array,e=P.attributes.normal.array,o=u.length/3,n=o/3,r=P.getIndex();r&&(r=r.array,n=r.length/3);function c(j,se){var ee=j*3+se;return r?r[ee]:ee}for(var l=[],f=[],s=this.smallDelta,t=o*o,i=0;i<t;i++)this.segments[i]=!1;for(var a=this.tempVector3_P0,m=this.tempVector3_P1,p=this.tempVector3_N0,S=this.tempVector3_N1,i=0;i<n-1;i++){var w=c(i,0),h=c(i,1),v=c(i,2);p.set(e[w],e[w]+1,e[w]+2);for(var x=i+1;x<n;x++){var g=c(x,0),M=c(x,1),A=c(x,2);S.set(e[g],e[g]+1,e[g]+2);var T=1-p.dot(S)<s;T&&(w===g||w===M||w===A?h===g||h===M||h===A?(this.segments[w*o+h]=!0,this.segments[h*o+w]=!0):(this.segments[v*o+w]=!0,this.segments[w*o+v]=!0):(h===g||h===M||h===A)&&(this.segments[v*o+h]=!0,this.segments[h*o+v]=!0))}}var C=this.tempPlane_Cut;V.updateMatrix(),X.transformPlaneToLocalSpace(y,V.matrix,C);for(var i=0;i<n;i++)for(var E=c(i,0),I=c(i,1),R=c(i,2),F=0;F<3;F++){var H=F===0?E:F===1?I:R,B=F===0?I:F===1?R:E,D=this.segments[H*o+B];if(!D){this.segments[H*o+B]=!0,this.segments[B*o+H]=!0,a.set(u[3*H],u[3*H+1],u[3*H+2]),m.set(u[3*B],u[3*B+1],u[3*B+2]);var L=0,b=C.distanceToPoint(a);b>s?(L=2,f.push(a.clone())):b<-s?(L=1,l.push(a.clone())):(L=3,l.push(a.clone()),f.push(a.clone()));var k=0,b=C.distanceToPoint(m);if(b>s?(k=2,f.push(m.clone())):b<-s?(k=1,l.push(m.clone())):(k=3,l.push(m.clone()),f.push(m.clone())),L===1&&k===2||L===2&&k===1){this.tempLine1.start.copy(a),this.tempLine1.end.copy(m);var z=new O;if(z=C.intersectLine(this.tempLine1,z),z===void 0)return console.error("Internal error: segment does not intersect plane."),d.segmentedObject1=null,d.segmentedObject2=null,0;l.push(z),f.push(z.clone())}}}var W=V.userData.ammoPhysicsData.mass*.5;this.tempCM1.set(0,0,0);var $=0,G=l.length;if(G>0){for(var i=0;i<G;i++)this.tempCM1.add(l[i]);this.tempCM1.divideScalar(G);for(var i=0;i<G;i++){var N=l[i];N.sub(this.tempCM1),$=Math.max($,N.x,N.y,N.z)}this.tempCM1.add(V.position)}this.tempCM2.set(0,0,0);var U=0,_=f.length;if(_>0){for(var i=0;i<_;i++)this.tempCM2.add(f[i]);this.tempCM2.divideScalar(_);for(var i=0;i<_;i++){var N=f[i];N.sub(this.tempCM2),U=Math.max(U,N.x,N.y,N.z)}this.tempCM2.add(V.position)}var Z=null,K=null,J=0;if(G>4)try{Z=new Ve(Be(l),V.material),Z.position.copy(this.tempCM1),Z.quaternion.copy(V.quaternion),Z.userData=V.userData,this.prepareBreakableObject(Z,W,V.userData.ammoPhysicsData.velocity,V.userData.ammoPhysicsData.angularVelocity,2*$>this.minSizeForBreak),J++}catch(j){Y("Error in ConvexObjectBreaker.ts",!0),Y(j,!0)}if(_>4)try{K=new Ve(Be(f),V.material),K.position.copy(this.tempCM2),K.quaternion.copy(V.quaternion),K.userData=V.userData,this.prepareBreakableObject(K,W,V.userData.ammoPhysicsData.velocity,V.userData.ammoPhysicsData.angularVelocity,2*U>this.minSizeForBreak),J++}catch(j){Y("Error in ConvexObjectBreaker.ts",!0),Y(j,!0)}return d.object1=Z,d.object2=K,J}};X.transformFreeVector=function(V,y){var d=V.x,P=V.y,u=V.z,e=y.elements;return V.x=e[0]*d+e[4]*P+e[8]*u,V.y=e[1]*d+e[5]*P+e[9]*u,V.z=e[2]*d+e[6]*P+e[10]*u,V};X.transformFreeVectorInverse=function(V,y){var d=V.x,P=V.y,u=V.z,e=y.elements;return V.x=e[0]*d+e[1]*P+e[2]*u,V.y=e[4]*d+e[5]*P+e[6]*u,V.z=e[8]*d+e[9]*P+e[10]*u,V};X.transformTiedVectorInverse=function(V,y){var d=V.x,P=V.y,u=V.z,e=y.elements;return V.x=e[0]*d+e[1]*P+e[2]*u-e[12],V.y=e[4]*d+e[5]*P+e[6]*u-e[13],V.z=e[8]*d+e[9]*P+e[10]*u-e[14],V};X.transformPlaneToLocalSpace=function(){var V=new O;return function(d,P,u){u.normal.copy(d.normal),u.constant=d.constant;var e=X.transformTiedVectorInverse(d.coplanarPoint(V),P);X.transformFreeVectorInverse(u.normal,P),u.constant=-e.dot(u.normal)}}();const rt=(()=>{try{if(typeof WebAssembly=="object"&&typeof WebAssembly.instantiate=="function"){const V=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));if(V instanceof WebAssembly.Module)return new WebAssembly.Instance(V)instanceof WebAssembly.Instance}}catch(V){V instanceof Error&&console.error(V.message)}return!1})(),Le=(V,y)=>{var d=document.createElement("script");d.onload=()=>{y()},d.onerror=()=>{throw new Error(`failed to load ${V}`)},d.async=!0,d.src=V,document.head.appendChild(d)},St=(V,y)=>{rt?Le(`${V}/ammo.wasm.js`,()=>y()):Le(`${V}/ammo.js`,()=>y())};function ke(V,y){y.forEach(d=>{Object.getOwnPropertyNames(d.prototype).forEach(P=>{Object.defineProperty(V.prototype,P,Object.getOwnPropertyDescriptor(d.prototype,P)||Object.create(null))})})}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */class at{constructor(y){this.physics=y}getHitPointWorld(){const y=this._btRayCallback.get_m_hitPointWorld();return{x:y.x(),y:y.y(),z:y.z()}}getHitNormalWorld(){const y=this._btRayCallback.get_m_hitNormalWorld();return{x:y.x(),y:y.y(),z:y.z()}}getCollisionObject(){return Ammo.castObject(this._btRayCallback.get_m_collisionObject(),Ammo.btRigidBody).threeObject}}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */class ot{constructor(y){this.physics=y}getHitPointsWorld(){const y=this._btRayCallback.get_m_hitPointWorld(),d=[];for(let P=y.size()-1;P>=0;P--){const u=y.at(P);d.push({x:u.x(),y:u.y(),z:u.z()})}return d}getHitPointWorld(){return Y("Use getHitPointsWorld() instead of getHitPointWorld() for the AllHitsRayCaster!"),this.getHitPointsWorld()}getHitNormalsWorld(){const y=this._btRayCallback.get_m_hitNormalWorld(),d=[];for(let P=y.size()-1;P>=0;P--){const u=y.at(P);d.push({x:u.x(),y:u.y(),z:u.z()})}return d}getCollisionObjects(){const y=[],d=this._btRayCallback.get_m_collisionObjects();for(let P=d.size()-1;P>=0;P--){const u=Ammo.castObject(d.at(P),Ammo.btRigidBody);y.push(u.threeObject)}return y}}/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2020 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */class be{constructor(y){this.physics=y}setRayFromWorld(y=0,d=0,P=0){this._btRayFrom.setValue(y,d,P)}setRayToWorld(y=0,d=0,P=0){this._btRayTo.setValue(y,d,P)}hasHit(){return this._btRayCallback.hasHit()}rayTest(){typeof this._btRayCallback<"u"&&Ammo.destroy(this._btRayCallback),this._btRayCallback=this.type==="closest"?new Ammo.ClosestRayResultCallback(this._btRayFrom,this._btRayTo):new Ammo.AllHitsRayResultCallback(this._btRayFrom,this._btRayTo),this.physics.physicsWorld.rayTest(this._btRayFrom,this._btRayTo,this._btRayCallback)}destroy(){typeof this._btRayFrom<"u"&&Ammo.destroy(this._btRayFrom),typeof this._btRayTo<"u"&&Ammo.destroy(this._btRayTo),typeof this._btRayCallback<"u"&&Ammo.destroy(this._btRayCallback)}}class lt{constructor(y){this.physics=y,this.type="closest",this._btRayFrom=new Ammo.btVector3(0,0,0),this._btRayTo=new Ammo.btVector3(0,0,0)}}class ft{constructor(y){this.physics=y,this.type="allHits",this._btRayFrom=new Ammo.btVector3(0,0,0),this._btRayTo=new Ammo.btVector3(0,0,0)}}ke(lt,[be,at]);ke(ft,[be,ot]);const ct="0.25.3",ut=`Powered by enable3d v${ct}`;console.log(`%c %c %c %c %c ${ut} %c https://enable3d.io/`,"background: #ff0000","background: #ffff00","background: #00ff00","background: #00ffff","color: #fff; background: #000000;","background: none");/**
 * @author       Yannick Deubel (https://github.com/yandeu)
 * @copyright    Copyright (c) 2021 Yannick Deubel; Project Url: https://github.com/enable3d/enable3d
 * @license      {@link https://github.com/enable3d/enable3d/blob/master/LICENSE|GNU GPLv3}
 */document.createElement("canvas");new Ke;new ye;new ye;new ye;var ht={exports:{}};/*!
 * matter-js 0.18.0 by @liabru
 * http://brm.io/matter-js/
 * License MIT
 * 
 * The MIT License (MIT)
 * 
 * Copyright (c) Liam Brummitt and contributors.
 * 
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 * 
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 * 
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(V,y){(function(P,u){V.exports=u()})(te,function(){return function(d){var P={};function u(e){if(P[e])return P[e].exports;var o=P[e]={i:e,l:!1,exports:{}};return d[e].call(o.exports,o,o.exports,u),o.l=!0,o.exports}return u.m=d,u.c=P,u.d=function(e,o,n){u.o(e,o)||Object.defineProperty(e,o,{enumerable:!0,get:n})},u.r=function(e){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},u.t=function(e,o){if(o&1&&(e=u(e)),o&8||o&4&&typeof e=="object"&&e&&e.__esModule)return e;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),o&2&&typeof e!="string")for(var r in e)u.d(n,r,function(c){return e[c]}.bind(null,r));return n},u.n=function(e){var o=e&&e.__esModule?function(){return e.default}:function(){return e};return u.d(o,"a",o),o},u.o=function(e,o){return Object.prototype.hasOwnProperty.call(e,o)},u.p="",u(u.s=21)}([function(d,P){var u={};d.exports=u,function(){u._nextId=0,u._seed=0,u._nowStartTime=+new Date,u._warnedOnce={},u._decomp=null,u.extend=function(o,n){var r,c;typeof n=="boolean"?(r=2,c=n):(r=1,c=!0);for(var l=r;l<arguments.length;l++){var f=arguments[l];if(f)for(var s in f)c&&f[s]&&f[s].constructor===Object&&(!o[s]||o[s].constructor===Object)?(o[s]=o[s]||{},u.extend(o[s],c,f[s])):o[s]=f[s]}return o},u.clone=function(o,n){return u.extend({},n,o)},u.keys=function(o){if(Object.keys)return Object.keys(o);var n=[];for(var r in o)n.push(r);return n},u.values=function(o){var n=[];if(Object.keys){for(var r=Object.keys(o),c=0;c<r.length;c++)n.push(o[r[c]]);return n}for(var l in o)n.push(o[l]);return n},u.get=function(o,n,r,c){n=n.split(".").slice(r,c);for(var l=0;l<n.length;l+=1)o=o[n[l]];return o},u.set=function(o,n,r,c,l){var f=n.split(".").slice(c,l);return u.get(o,n,0,-1)[f[f.length-1]]=r,r},u.shuffle=function(o){for(var n=o.length-1;n>0;n--){var r=Math.floor(u.random()*(n+1)),c=o[n];o[n]=o[r],o[r]=c}return o},u.choose=function(o){return o[Math.floor(u.random()*o.length)]},u.isElement=function(o){return typeof HTMLElement<"u"?o instanceof HTMLElement:!!(o&&o.nodeType&&o.nodeName)},u.isArray=function(o){return Object.prototype.toString.call(o)==="[object Array]"},u.isFunction=function(o){return typeof o=="function"},u.isPlainObject=function(o){return typeof o=="object"&&o.constructor===Object},u.isString=function(o){return toString.call(o)==="[object String]"},u.clamp=function(o,n,r){return o<n?n:o>r?r:o},u.sign=function(o){return o<0?-1:1},u.now=function(){if(typeof window<"u"&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-u._nowStartTime},u.random=function(o,n){return o=typeof o<"u"?o:0,n=typeof n<"u"?n:1,o+e()*(n-o)};var e=function(){return u._seed=(u._seed*9301+49297)%233280,u._seed/233280};u.colorToNumber=function(o){return o=o.replace("#",""),o.length==3&&(o=o.charAt(0)+o.charAt(0)+o.charAt(1)+o.charAt(1)+o.charAt(2)+o.charAt(2)),parseInt(o,16)},u.logLevel=1,u.log=function(){console&&u.logLevel>0&&u.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},u.info=function(){console&&u.logLevel>0&&u.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},u.warn=function(){console&&u.logLevel>0&&u.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},u.warnOnce=function(){var o=Array.prototype.slice.call(arguments).join(" ");u._warnedOnce[o]||(u.warn(o),u._warnedOnce[o]=!0)},u.deprecated=function(o,n,r){o[n]=u.chain(function(){u.warnOnce("\u{1F505} deprecated \u{1F505}",r)},o[n])},u.nextId=function(){return u._nextId++},u.indexOf=function(o,n){if(o.indexOf)return o.indexOf(n);for(var r=0;r<o.length;r++)if(o[r]===n)return r;return-1},u.map=function(o,n){if(o.map)return o.map(n);for(var r=[],c=0;c<o.length;c+=1)r.push(n(o[c]));return r},u.topologicalSort=function(o){var n=[],r=[],c=[];for(var l in o)!r[l]&&!c[l]&&u._topologicalSort(l,r,c,o,n);return n},u._topologicalSort=function(o,n,r,c,l){var f=c[o]||[];r[o]=!0;for(var s=0;s<f.length;s+=1){var t=f[s];r[t]||n[t]||u._topologicalSort(t,n,r,c,l)}r[o]=!1,n[o]=!0,l.push(o)},u.chain=function(){for(var o=[],n=0;n<arguments.length;n+=1){var r=arguments[n];r._chained?o.push.apply(o,r._chained):o.push(r)}var c=function(){for(var l,f=new Array(arguments.length),s=0,t=arguments.length;s<t;s++)f[s]=arguments[s];for(s=0;s<o.length;s+=1){var i=o[s].apply(l,f);typeof i<"u"&&(l=i)}return l};return c._chained=o,c},u.chainPathBefore=function(o,n,r){return u.set(o,n,u.chain(r,u.get(o,n)))},u.chainPathAfter=function(o,n,r){return u.set(o,n,u.chain(u.get(o,n),r))},u.setDecomp=function(o){u._decomp=o},u.getDecomp=function(){var o=u._decomp;try{!o&&typeof window<"u"&&(o=window.decomp),!o&&typeof te<"u"&&(o=te.decomp)}catch{o=null}return o}}()},function(d,P){var u={};d.exports=u,function(){u.create=function(e){var o={min:{x:0,y:0},max:{x:0,y:0}};return e&&u.update(o,e),o},u.update=function(e,o,n){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var r=0;r<o.length;r++){var c=o[r];c.x>e.max.x&&(e.max.x=c.x),c.x<e.min.x&&(e.min.x=c.x),c.y>e.max.y&&(e.max.y=c.y),c.y<e.min.y&&(e.min.y=c.y)}n&&(n.x>0?e.max.x+=n.x:e.min.x+=n.x,n.y>0?e.max.y+=n.y:e.min.y+=n.y)},u.contains=function(e,o){return o.x>=e.min.x&&o.x<=e.max.x&&o.y>=e.min.y&&o.y<=e.max.y},u.overlaps=function(e,o){return e.min.x<=o.max.x&&e.max.x>=o.min.x&&e.max.y>=o.min.y&&e.min.y<=o.max.y},u.translate=function(e,o){e.min.x+=o.x,e.max.x+=o.x,e.min.y+=o.y,e.max.y+=o.y},u.shift=function(e,o){var n=e.max.x-e.min.x,r=e.max.y-e.min.y;e.min.x=o.x,e.max.x=o.x+n,e.min.y=o.y,e.max.y=o.y+r}}()},function(d,P){var u={};d.exports=u,function(){u.create=function(e,o){return{x:e||0,y:o||0}},u.clone=function(e){return{x:e.x,y:e.y}},u.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},u.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},u.rotate=function(e,o,n){var r=Math.cos(o),c=Math.sin(o);n||(n={});var l=e.x*r-e.y*c;return n.y=e.x*c+e.y*r,n.x=l,n},u.rotateAbout=function(e,o,n,r){var c=Math.cos(o),l=Math.sin(o);r||(r={});var f=n.x+((e.x-n.x)*c-(e.y-n.y)*l);return r.y=n.y+((e.x-n.x)*l+(e.y-n.y)*c),r.x=f,r},u.normalise=function(e){var o=u.magnitude(e);return o===0?{x:0,y:0}:{x:e.x/o,y:e.y/o}},u.dot=function(e,o){return e.x*o.x+e.y*o.y},u.cross=function(e,o){return e.x*o.y-e.y*o.x},u.cross3=function(e,o,n){return(o.x-e.x)*(n.y-e.y)-(o.y-e.y)*(n.x-e.x)},u.add=function(e,o,n){return n||(n={}),n.x=e.x+o.x,n.y=e.y+o.y,n},u.sub=function(e,o,n){return n||(n={}),n.x=e.x-o.x,n.y=e.y-o.y,n},u.mult=function(e,o){return{x:e.x*o,y:e.y*o}},u.div=function(e,o){return{x:e.x/o,y:e.y/o}},u.perp=function(e,o){return o=o===!0?-1:1,{x:o*-e.y,y:o*e.x}},u.neg=function(e){return{x:-e.x,y:-e.y}},u.angle=function(e,o){return Math.atan2(o.y-e.y,o.x-e.x)},u._temp=[u.create(),u.create(),u.create(),u.create(),u.create(),u.create()]}()},function(d,P,u){var e={};d.exports=e;var o=u(2),n=u(0);(function(){e.create=function(r,c){for(var l=[],f=0;f<r.length;f++){var s=r[f],t={x:s.x,y:s.y,index:f,body:c,isInternal:!1};l.push(t)}return l},e.fromPath=function(r,c){var l=/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/ig,f=[];return r.replace(l,function(s,t,i){f.push({x:parseFloat(t),y:parseFloat(i)})}),e.create(f,c)},e.centre=function(r){for(var c=e.area(r,!0),l={x:0,y:0},f,s,t,i=0;i<r.length;i++)t=(i+1)%r.length,f=o.cross(r[i],r[t]),s=o.mult(o.add(r[i],r[t]),f),l=o.add(l,s);return o.div(l,6*c)},e.mean=function(r){for(var c={x:0,y:0},l=0;l<r.length;l++)c.x+=r[l].x,c.y+=r[l].y;return o.div(c,r.length)},e.area=function(r,c){for(var l=0,f=r.length-1,s=0;s<r.length;s++)l+=(r[f].x-r[s].x)*(r[f].y+r[s].y),f=s;return c?l/2:Math.abs(l)/2},e.inertia=function(r,c){for(var l=0,f=0,s=r,t,i,a=0;a<s.length;a++)i=(a+1)%s.length,t=Math.abs(o.cross(s[i],s[a])),l+=t*(o.dot(s[i],s[i])+o.dot(s[i],s[a])+o.dot(s[a],s[a])),f+=t;return c/6*(l/f)},e.translate=function(r,c,l){l=typeof l<"u"?l:1;var f=r.length,s=c.x*l,t=c.y*l,i;for(i=0;i<f;i++)r[i].x+=s,r[i].y+=t;return r},e.rotate=function(r,c,l){if(c!==0){var f=Math.cos(c),s=Math.sin(c),t=l.x,i=l.y,a=r.length,m,p,S,w;for(w=0;w<a;w++)m=r[w],p=m.x-t,S=m.y-i,m.x=t+(p*f-S*s),m.y=i+(p*s+S*f);return r}},e.contains=function(r,c){for(var l=c.x,f=c.y,s=r.length,t=r[s-1],i,a=0;a<s;a++){if(i=r[a],(l-t.x)*(i.y-t.y)+(f-t.y)*(t.x-i.x)>0)return!1;t=i}return!0},e.scale=function(r,c,l,f){if(c===1&&l===1)return r;f=f||e.centre(r);for(var s,t,i=0;i<r.length;i++)s=r[i],t=o.sub(s,f),r[i].x=f.x+t.x*c,r[i].y=f.y+t.y*l;return r},e.chamfer=function(r,c,l,f,s){typeof c=="number"?c=[c]:c=c||[8],l=typeof l<"u"?l:-1,f=f||2,s=s||14;for(var t=[],i=0;i<r.length;i++){var a=r[i-1>=0?i-1:r.length-1],m=r[i],p=r[(i+1)%r.length],S=c[i<c.length?i:c.length-1];if(S===0){t.push(m);continue}var w=o.normalise({x:m.y-a.y,y:a.x-m.x}),h=o.normalise({x:p.y-m.y,y:m.x-p.x}),v=Math.sqrt(2*Math.pow(S,2)),x=o.mult(n.clone(w),S),g=o.normalise(o.mult(o.add(w,h),.5)),M=o.sub(m,o.mult(g,v)),A=l;l===-1&&(A=Math.pow(S,.32)*1.75),A=n.clamp(A,f,s),A%2===1&&(A+=1);for(var T=Math.acos(o.dot(w,h)),C=T/A,E=0;E<A;E++)t.push(o.add(o.rotate(x,C*E),M))}return t},e.clockwiseSort=function(r){var c=e.mean(r);return r.sort(function(l,f){return o.angle(c,l)-o.angle(c,f)}),r},e.isConvex=function(r){var c=0,l=r.length,f,s,t,i;if(l<3)return null;for(f=0;f<l;f++)if(s=(f+1)%l,t=(f+2)%l,i=(r[s].x-r[f].x)*(r[t].y-r[s].y),i-=(r[s].y-r[f].y)*(r[t].x-r[s].x),i<0?c|=1:i>0&&(c|=2),c===3)return!1;return c!==0?!0:null},e.hull=function(r){var c=[],l=[],f,s;for(r=r.slice(0),r.sort(function(t,i){var a=t.x-i.x;return a!==0?a:t.y-i.y}),s=0;s<r.length;s+=1){for(f=r[s];l.length>=2&&o.cross3(l[l.length-2],l[l.length-1],f)<=0;)l.pop();l.push(f)}for(s=r.length-1;s>=0;s-=1){for(f=r[s];c.length>=2&&o.cross3(c[c.length-2],c[c.length-1],f)<=0;)c.pop();c.push(f)}return c.pop(),l.pop(),c.concat(l)}})()},function(d,P,u){var e={};d.exports=e;var o=u(0);(function(){e.on=function(n,r,c){for(var l=r.split(" "),f,s=0;s<l.length;s++)f=l[s],n.events=n.events||{},n.events[f]=n.events[f]||[],n.events[f].push(c);return c},e.off=function(n,r,c){if(!r){n.events={};return}typeof r=="function"&&(c=r,r=o.keys(n.events).join(" "));for(var l=r.split(" "),f=0;f<l.length;f++){var s=n.events[l[f]],t=[];if(c&&s)for(var i=0;i<s.length;i++)s[i]!==c&&t.push(s[i]);n.events[l[f]]=t}},e.trigger=function(n,r,c){var l,f,s,t,i=n.events;if(i&&o.keys(i).length>0){c||(c={}),l=r.split(" ");for(var a=0;a<l.length;a++)if(f=l[a],s=i[f],s){t=o.clone(c,!1),t.name=f,t.source=n;for(var m=0;m<s.length;m++)s[m].apply(n,[t])}}}})()},function(d,P,u){var e={};d.exports=e;var o=u(4),n=u(0),r=u(1),c=u(6);(function(){e.create=function(l){return n.extend({id:n.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},l)},e.setModified=function(l,f,s,t){if(l.isModified=f,f&&l.cache&&(l.cache.allBodies=null,l.cache.allConstraints=null,l.cache.allComposites=null),s&&l.parent&&e.setModified(l.parent,f,s,t),t)for(var i=0;i<l.composites.length;i++){var a=l.composites[i];e.setModified(a,f,s,t)}},e.add=function(l,f){var s=[].concat(f);o.trigger(l,"beforeAdd",{object:f});for(var t=0;t<s.length;t++){var i=s[t];switch(i.type){case"body":if(i.parent!==i){n.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}e.addBody(l,i);break;case"constraint":e.addConstraint(l,i);break;case"composite":e.addComposite(l,i);break;case"mouseConstraint":e.addConstraint(l,i.constraint);break}}return o.trigger(l,"afterAdd",{object:f}),l},e.remove=function(l,f,s){var t=[].concat(f);o.trigger(l,"beforeRemove",{object:f});for(var i=0;i<t.length;i++){var a=t[i];switch(a.type){case"body":e.removeBody(l,a,s);break;case"constraint":e.removeConstraint(l,a,s);break;case"composite":e.removeComposite(l,a,s);break;case"mouseConstraint":e.removeConstraint(l,a.constraint);break}}return o.trigger(l,"afterRemove",{object:f}),l},e.addComposite=function(l,f){return l.composites.push(f),f.parent=l,e.setModified(l,!0,!0,!1),l},e.removeComposite=function(l,f,s){var t=n.indexOf(l.composites,f);if(t!==-1&&e.removeCompositeAt(l,t),s)for(var i=0;i<l.composites.length;i++)e.removeComposite(l.composites[i],f,!0);return l},e.removeCompositeAt=function(l,f){return l.composites.splice(f,1),e.setModified(l,!0,!0,!1),l},e.addBody=function(l,f){return l.bodies.push(f),e.setModified(l,!0,!0,!1),l},e.removeBody=function(l,f,s){var t=n.indexOf(l.bodies,f);if(t!==-1&&e.removeBodyAt(l,t),s)for(var i=0;i<l.composites.length;i++)e.removeBody(l.composites[i],f,!0);return l},e.removeBodyAt=function(l,f){return l.bodies.splice(f,1),e.setModified(l,!0,!0,!1),l},e.addConstraint=function(l,f){return l.constraints.push(f),e.setModified(l,!0,!0,!1),l},e.removeConstraint=function(l,f,s){var t=n.indexOf(l.constraints,f);if(t!==-1&&e.removeConstraintAt(l,t),s)for(var i=0;i<l.composites.length;i++)e.removeConstraint(l.composites[i],f,!0);return l},e.removeConstraintAt=function(l,f){return l.constraints.splice(f,1),e.setModified(l,!0,!0,!1),l},e.clear=function(l,f,s){if(s)for(var t=0;t<l.composites.length;t++)e.clear(l.composites[t],f,!0);return f?l.bodies=l.bodies.filter(function(i){return i.isStatic}):l.bodies.length=0,l.constraints.length=0,l.composites.length=0,e.setModified(l,!0,!0,!1),l},e.allBodies=function(l){if(l.cache&&l.cache.allBodies)return l.cache.allBodies;for(var f=[].concat(l.bodies),s=0;s<l.composites.length;s++)f=f.concat(e.allBodies(l.composites[s]));return l.cache&&(l.cache.allBodies=f),f},e.allConstraints=function(l){if(l.cache&&l.cache.allConstraints)return l.cache.allConstraints;for(var f=[].concat(l.constraints),s=0;s<l.composites.length;s++)f=f.concat(e.allConstraints(l.composites[s]));return l.cache&&(l.cache.allConstraints=f),f},e.allComposites=function(l){if(l.cache&&l.cache.allComposites)return l.cache.allComposites;for(var f=[].concat(l.composites),s=0;s<l.composites.length;s++)f=f.concat(e.allComposites(l.composites[s]));return l.cache&&(l.cache.allComposites=f),f},e.get=function(l,f,s){var t,i;switch(s){case"body":t=e.allBodies(l);break;case"constraint":t=e.allConstraints(l);break;case"composite":t=e.allComposites(l).concat(l);break}return t?(i=t.filter(function(a){return a.id.toString()===f.toString()}),i.length===0?null:i[0]):null},e.move=function(l,f,s){return e.remove(l,f),e.add(s,f),l},e.rebase=function(l){for(var f=e.allBodies(l).concat(e.allConstraints(l)).concat(e.allComposites(l)),s=0;s<f.length;s++)f[s].id=n.nextId();return l},e.translate=function(l,f,s){for(var t=s?e.allBodies(l):l.bodies,i=0;i<t.length;i++)c.translate(t[i],f);return l},e.rotate=function(l,f,s,t){for(var i=Math.cos(f),a=Math.sin(f),m=t?e.allBodies(l):l.bodies,p=0;p<m.length;p++){var S=m[p],w=S.position.x-s.x,h=S.position.y-s.y;c.setPosition(S,{x:s.x+(w*i-h*a),y:s.y+(w*a+h*i)}),c.rotate(S,f)}return l},e.scale=function(l,f,s,t,i){for(var a=i?e.allBodies(l):l.bodies,m=0;m<a.length;m++){var p=a[m],S=p.position.x-t.x,w=p.position.y-t.y;c.setPosition(p,{x:t.x+S*f,y:t.y+w*s}),c.scale(p,f,s)}return l},e.bounds=function(l){for(var f=e.allBodies(l),s=[],t=0;t<f.length;t+=1){var i=f[t];s.push(i.bounds.min,i.bounds.max)}return r.create(s)}})()},function(d,P,u){var e={};d.exports=e;var o=u(3),n=u(2),r=u(7);u(16);var c=u(0),l=u(1),f=u(11);(function(){e._inertiaScale=4,e._nextCollidingGroupId=1,e._nextNonCollidingGroupId=-1,e._nextCategory=1,e.create=function(t){var i={id:c.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:o.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,_original:null},a=c.extend(i,t);return s(a,t),a},e.nextGroup=function(t){return t?e._nextNonCollidingGroupId--:e._nextCollidingGroupId++},e.nextCategory=function(){return e._nextCategory=e._nextCategory<<1,e._nextCategory};var s=function(t,i){i=i||{},e.set(t,{bounds:t.bounds||l.create(t.vertices),positionPrev:t.positionPrev||n.clone(t.position),anglePrev:t.anglePrev||t.angle,vertices:t.vertices,parts:t.parts||[t],isStatic:t.isStatic,isSleeping:t.isSleeping,parent:t.parent||t}),o.rotate(t.vertices,t.angle,t.position),f.rotate(t.axes,t.angle),l.update(t.bounds,t.vertices,t.velocity),e.set(t,{axes:i.axes||t.axes,area:i.area||t.area,mass:i.mass||t.mass,inertia:i.inertia||t.inertia});var a=t.isStatic?"#14151f":c.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),m=t.isStatic?"#555":"#ccc",p=t.isStatic&&t.render.fillStyle===null?1:0;t.render.fillStyle=t.render.fillStyle||a,t.render.strokeStyle=t.render.strokeStyle||m,t.render.lineWidth=t.render.lineWidth||p,t.render.sprite.xOffset+=-(t.bounds.min.x-t.position.x)/(t.bounds.max.x-t.bounds.min.x),t.render.sprite.yOffset+=-(t.bounds.min.y-t.position.y)/(t.bounds.max.y-t.bounds.min.y)};e.set=function(t,i,a){var m;typeof i=="string"&&(m=i,i={},i[m]=a);for(m in i)if(!!Object.prototype.hasOwnProperty.call(i,m))switch(a=i[m],m){case"isStatic":e.setStatic(t,a);break;case"isSleeping":r.set(t,a);break;case"mass":e.setMass(t,a);break;case"density":e.setDensity(t,a);break;case"inertia":e.setInertia(t,a);break;case"vertices":e.setVertices(t,a);break;case"position":e.setPosition(t,a);break;case"angle":e.setAngle(t,a);break;case"velocity":e.setVelocity(t,a);break;case"angularVelocity":e.setAngularVelocity(t,a);break;case"parts":e.setParts(t,a);break;case"centre":e.setCentre(t,a);break;default:t[m]=a}},e.setStatic=function(t,i){for(var a=0;a<t.parts.length;a++){var m=t.parts[a];m.isStatic=i,i?(m._original={restitution:m.restitution,friction:m.friction,mass:m.mass,inertia:m.inertia,density:m.density,inverseMass:m.inverseMass,inverseInertia:m.inverseInertia},m.restitution=0,m.friction=1,m.mass=m.inertia=m.density=1/0,m.inverseMass=m.inverseInertia=0,m.positionPrev.x=m.position.x,m.positionPrev.y=m.position.y,m.anglePrev=m.angle,m.angularVelocity=0,m.speed=0,m.angularSpeed=0,m.motion=0):m._original&&(m.restitution=m._original.restitution,m.friction=m._original.friction,m.mass=m._original.mass,m.inertia=m._original.inertia,m.density=m._original.density,m.inverseMass=m._original.inverseMass,m.inverseInertia=m._original.inverseInertia,m._original=null)}},e.setMass=function(t,i){var a=t.inertia/(t.mass/6);t.inertia=a*(i/6),t.inverseInertia=1/t.inertia,t.mass=i,t.inverseMass=1/t.mass,t.density=t.mass/t.area},e.setDensity=function(t,i){e.setMass(t,i*t.area),t.density=i},e.setInertia=function(t,i){t.inertia=i,t.inverseInertia=1/t.inertia},e.setVertices=function(t,i){i[0].body===t?t.vertices=i:t.vertices=o.create(i,t),t.axes=f.fromVertices(t.vertices),t.area=o.area(t.vertices),e.setMass(t,t.density*t.area);var a=o.centre(t.vertices);o.translate(t.vertices,a,-1),e.setInertia(t,e._inertiaScale*o.inertia(t.vertices,t.mass)),o.translate(t.vertices,t.position),l.update(t.bounds,t.vertices,t.velocity)},e.setParts=function(t,i,a){var m;for(i=i.slice(0),t.parts.length=0,t.parts.push(t),t.parent=t,m=0;m<i.length;m++){var p=i[m];p!==t&&(p.parent=t,t.parts.push(p))}if(t.parts.length!==1){if(a=typeof a<"u"?a:!0,a){var S=[];for(m=0;m<i.length;m++)S=S.concat(i[m].vertices);o.clockwiseSort(S);var w=o.hull(S),h=o.centre(w);e.setVertices(t,w),o.translate(t.vertices,h)}var v=e._totalProperties(t);t.area=v.area,t.parent=t,t.position.x=v.centre.x,t.position.y=v.centre.y,t.positionPrev.x=v.centre.x,t.positionPrev.y=v.centre.y,e.setMass(t,v.mass),e.setInertia(t,v.inertia),e.setPosition(t,v.centre)}},e.setCentre=function(t,i,a){a?(t.positionPrev.x+=i.x,t.positionPrev.y+=i.y,t.position.x+=i.x,t.position.y+=i.y):(t.positionPrev.x=i.x-(t.position.x-t.positionPrev.x),t.positionPrev.y=i.y-(t.position.y-t.positionPrev.y),t.position.x=i.x,t.position.y=i.y)},e.setPosition=function(t,i){var a=n.sub(i,t.position);t.positionPrev.x+=a.x,t.positionPrev.y+=a.y;for(var m=0;m<t.parts.length;m++){var p=t.parts[m];p.position.x+=a.x,p.position.y+=a.y,o.translate(p.vertices,a),l.update(p.bounds,p.vertices,t.velocity)}},e.setAngle=function(t,i){var a=i-t.angle;t.anglePrev+=a;for(var m=0;m<t.parts.length;m++){var p=t.parts[m];p.angle+=a,o.rotate(p.vertices,a,t.position),f.rotate(p.axes,a),l.update(p.bounds,p.vertices,t.velocity),m>0&&n.rotateAbout(p.position,a,t.position,p.position)}},e.setVelocity=function(t,i){t.positionPrev.x=t.position.x-i.x,t.positionPrev.y=t.position.y-i.y,t.velocity.x=i.x,t.velocity.y=i.y,t.speed=n.magnitude(t.velocity)},e.setAngularVelocity=function(t,i){t.anglePrev=t.angle-i,t.angularVelocity=i,t.angularSpeed=Math.abs(t.angularVelocity)},e.translate=function(t,i){e.setPosition(t,n.add(t.position,i))},e.rotate=function(t,i,a){if(!a)e.setAngle(t,t.angle+i);else{var m=Math.cos(i),p=Math.sin(i),S=t.position.x-a.x,w=t.position.y-a.y;e.setPosition(t,{x:a.x+(S*m-w*p),y:a.y+(S*p+w*m)}),e.setAngle(t,t.angle+i)}},e.scale=function(t,i,a,m){var p=0,S=0;m=m||t.position;for(var w=0;w<t.parts.length;w++){var h=t.parts[w];o.scale(h.vertices,i,a,m),h.axes=f.fromVertices(h.vertices),h.area=o.area(h.vertices),e.setMass(h,t.density*h.area),o.translate(h.vertices,{x:-h.position.x,y:-h.position.y}),e.setInertia(h,e._inertiaScale*o.inertia(h.vertices,h.mass)),o.translate(h.vertices,{x:h.position.x,y:h.position.y}),w>0&&(p+=h.area,S+=h.inertia),h.position.x=m.x+(h.position.x-m.x)*i,h.position.y=m.y+(h.position.y-m.y)*a,l.update(h.bounds,h.vertices,t.velocity)}t.parts.length>1&&(t.area=p,t.isStatic||(e.setMass(t,t.density*p),e.setInertia(t,S))),t.circleRadius&&(i===a?t.circleRadius*=i:t.circleRadius=null)},e.update=function(t,i,a,m){var p=Math.pow(i*a*t.timeScale,2),S=1-t.frictionAir*a*t.timeScale,w=t.position.x-t.positionPrev.x,h=t.position.y-t.positionPrev.y;t.velocity.x=w*S*m+t.force.x/t.mass*p,t.velocity.y=h*S*m+t.force.y/t.mass*p,t.positionPrev.x=t.position.x,t.positionPrev.y=t.position.y,t.position.x+=t.velocity.x,t.position.y+=t.velocity.y,t.angularVelocity=(t.angle-t.anglePrev)*S*m+t.torque/t.inertia*p,t.anglePrev=t.angle,t.angle+=t.angularVelocity,t.speed=n.magnitude(t.velocity),t.angularSpeed=Math.abs(t.angularVelocity);for(var v=0;v<t.parts.length;v++){var x=t.parts[v];o.translate(x.vertices,t.velocity),v>0&&(x.position.x+=t.velocity.x,x.position.y+=t.velocity.y),t.angularVelocity!==0&&(o.rotate(x.vertices,t.angularVelocity,t.position),f.rotate(x.axes,t.angularVelocity),v>0&&n.rotateAbout(x.position,t.angularVelocity,t.position,x.position)),l.update(x.bounds,x.vertices,t.velocity)}},e.applyForce=function(t,i,a){t.force.x+=a.x,t.force.y+=a.y;var m={x:i.x-t.position.x,y:i.y-t.position.y};t.torque+=m.x*a.y-m.y*a.x},e._totalProperties=function(t){for(var i={mass:0,area:0,inertia:0,centre:{x:0,y:0}},a=t.parts.length===1?0:1;a<t.parts.length;a++){var m=t.parts[a],p=m.mass!==1/0?m.mass:1;i.mass+=p,i.area+=m.area,i.inertia+=m.inertia,i.centre=n.add(i.centre,n.mult(m.position,p))}return i.centre=n.div(i.centre,i.mass),i}})()},function(d,P,u){var e={};d.exports=e;var o=u(4);(function(){e._motionWakeThreshold=.18,e._motionSleepThreshold=.08,e._minBias=.9,e.update=function(n,r){for(var c=r*r*r,l=0;l<n.length;l++){var f=n[l],s=f.speed*f.speed+f.angularSpeed*f.angularSpeed;if(f.force.x!==0||f.force.y!==0){e.set(f,!1);continue}var t=Math.min(f.motion,s),i=Math.max(f.motion,s);f.motion=e._minBias*t+(1-e._minBias)*i,f.sleepThreshold>0&&f.motion<e._motionSleepThreshold*c?(f.sleepCounter+=1,f.sleepCounter>=f.sleepThreshold&&e.set(f,!0)):f.sleepCounter>0&&(f.sleepCounter-=1)}},e.afterCollisions=function(n,r){for(var c=r*r*r,l=0;l<n.length;l++){var f=n[l];if(!!f.isActive){var s=f.collision,t=s.bodyA.parent,i=s.bodyB.parent;if(!(t.isSleeping&&i.isSleeping||t.isStatic||i.isStatic)&&(t.isSleeping||i.isSleeping)){var a=t.isSleeping&&!t.isStatic?t:i,m=a===t?i:t;!a.isStatic&&m.motion>e._motionWakeThreshold*c&&e.set(a,!1)}}}},e.set=function(n,r){var c=n.isSleeping;r?(n.isSleeping=!0,n.sleepCounter=n.sleepThreshold,n.positionImpulse.x=0,n.positionImpulse.y=0,n.positionPrev.x=n.position.x,n.positionPrev.y=n.position.y,n.anglePrev=n.angle,n.speed=0,n.angularSpeed=0,n.motion=0,c||o.trigger(n,"sleepStart")):(n.isSleeping=!1,n.sleepCounter=0,c&&o.trigger(n,"sleepEnd"))}})()},function(d,P,u){var e={};d.exports=e;var o=u(3),n=u(9);(function(){var r=[],c={overlap:0,axis:null},l={overlap:0,axis:null};e.create=function(f,s){return{pair:null,collided:!1,bodyA:f,bodyB:s,parentA:f.parent,parentB:s.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},e.collides=function(f,s,t){if(e._overlapAxes(c,f.vertices,s.vertices,f.axes),c.overlap<=0||(e._overlapAxes(l,s.vertices,f.vertices,s.axes),l.overlap<=0))return null;var i=t&&t.table[n.id(f,s)],a;i?a=i.collision:(a=e.create(f,s),a.collided=!0,a.bodyA=f.id<s.id?f:s,a.bodyB=f.id<s.id?s:f,a.parentA=a.bodyA.parent,a.parentB=a.bodyB.parent),f=a.bodyA,s=a.bodyB;var m;c.overlap<l.overlap?m=c:m=l;var p=a.normal,S=a.supports,w=m.axis,h=w.x,v=w.y;h*(s.position.x-f.position.x)+v*(s.position.y-f.position.y)<0?(p.x=h,p.y=v):(p.x=-h,p.y=-v),a.tangent.x=-p.y,a.tangent.y=p.x,a.depth=m.overlap,a.penetration.x=p.x*a.depth,a.penetration.y=p.y*a.depth;var x=e._findSupports(f,s,p,1),g=0;if(o.contains(f.vertices,x[0])&&(S[g++]=x[0]),o.contains(f.vertices,x[1])&&(S[g++]=x[1]),g<2){var M=e._findSupports(s,f,p,-1);o.contains(s.vertices,M[0])&&(S[g++]=M[0]),g<2&&o.contains(s.vertices,M[1])&&(S[g++]=M[1])}return g===0&&(S[g++]=x[0]),S.length=g,a},e._overlapAxes=function(f,s,t,i){var a=s.length,m=t.length,p=s[0].x,S=s[0].y,w=t[0].x,h=t[0].y,v=i.length,x=Number.MAX_VALUE,g=0,M,A,T,C,E,I;for(E=0;E<v;E++){var R=i[E],F=R.x,H=R.y,B=p*F+S*H,D=w*F+h*H,L=B,k=D;for(I=1;I<a;I+=1)C=s[I].x*F+s[I].y*H,C>L?L=C:C<B&&(B=C);for(I=1;I<m;I+=1)C=t[I].x*F+t[I].y*H,C>k?k=C:C<D&&(D=C);if(A=L-D,T=k-B,M=A<T?A:T,M<x&&(x=M,g=E,M<=0))break}f.axis=i[g],f.overlap=x},e._projectToAxis=function(f,s,t){for(var i=s[0].x*t.x+s[0].y*t.y,a=i,m=1;m<s.length;m+=1){var p=s[m].x*t.x+s[m].y*t.y;p>a?a=p:p<i&&(i=p)}f.min=i,f.max=a},e._findSupports=function(f,s,t,i){var a=s.vertices,m=a.length,p=f.position.x,S=f.position.y,w=t.x*i,h=t.y*i,v=Number.MAX_VALUE,x,g,M,A,T;for(T=0;T<m;T+=1)g=a[T],A=w*(p-g.x)+h*(S-g.y),A<v&&(v=A,x=g);return M=a[(m+x.index-1)%m],v=w*(p-M.x)+h*(S-M.y),g=a[(x.index+1)%m],w*(p-g.x)+h*(S-g.y)<v?(r[0]=x,r[1]=g,r):(r[0]=x,r[1]=M,r)}})()},function(d,P,u){var e={};d.exports=e;var o=u(17);(function(){e.create=function(n,r){var c=n.bodyA,l=n.bodyB,f={id:e.id(c,l),bodyA:c,bodyB:l,collision:n,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:c.isSensor||l.isSensor,timeCreated:r,timeUpdated:r,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return e.update(f,n,r),f},e.update=function(n,r,c){var l=n.contacts,f=r.supports,s=n.activeContacts,t=r.parentA,i=r.parentB,a=t.vertices.length;n.isActive=!0,n.timeUpdated=c,n.collision=r,n.separation=r.depth,n.inverseMass=t.inverseMass+i.inverseMass,n.friction=t.friction<i.friction?t.friction:i.friction,n.frictionStatic=t.frictionStatic>i.frictionStatic?t.frictionStatic:i.frictionStatic,n.restitution=t.restitution>i.restitution?t.restitution:i.restitution,n.slop=t.slop>i.slop?t.slop:i.slop,r.pair=n,s.length=0;for(var m=0;m<f.length;m++){var p=f[m],S=p.body===t?p.index:a+p.index,w=l[S];w?s.push(w):s.push(l[S]=o.create(p))}},e.setActive=function(n,r,c){r?(n.isActive=!0,n.timeUpdated=c):(n.isActive=!1,n.activeContacts.length=0)},e.id=function(n,r){return n.id<r.id?"A"+n.id+"B"+r.id:"A"+r.id+"B"+n.id}})()},function(d,P,u){var e={};d.exports=e;var o=u(3),n=u(2),r=u(7),c=u(1),l=u(11),f=u(0);(function(){e._warming=.4,e._torqueDampen=1,e._minLength=1e-6,e.create=function(s){var t=s;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var i=t.bodyA?n.add(t.bodyA.position,t.pointA):t.pointA,a=t.bodyB?n.add(t.bodyB.position,t.pointB):t.pointB,m=n.magnitude(n.sub(i,a));t.length=typeof t.length<"u"?t.length:m,t.id=t.id||f.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(t.length>0?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var p={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return t.length===0&&t.stiffness>.1?(p.type="pin",p.anchors=!1):t.stiffness<.9&&(p.type="spring"),t.render=f.extend(p,t.render),t},e.preSolveAll=function(s){for(var t=0;t<s.length;t+=1){var i=s[t],a=i.constraintImpulse;i.isStatic||a.x===0&&a.y===0&&a.angle===0||(i.position.x+=a.x,i.position.y+=a.y,i.angle+=a.angle)}},e.solveAll=function(s,t){for(var i=0;i<s.length;i+=1){var a=s[i],m=!a.bodyA||a.bodyA&&a.bodyA.isStatic,p=!a.bodyB||a.bodyB&&a.bodyB.isStatic;(m||p)&&e.solve(s[i],t)}for(i=0;i<s.length;i+=1)a=s[i],m=!a.bodyA||a.bodyA&&a.bodyA.isStatic,p=!a.bodyB||a.bodyB&&a.bodyB.isStatic,!m&&!p&&e.solve(s[i],t)},e.solve=function(s,t){var i=s.bodyA,a=s.bodyB,m=s.pointA,p=s.pointB;if(!(!i&&!a)){i&&!i.isStatic&&(n.rotate(m,i.angle-s.angleA,m),s.angleA=i.angle),a&&!a.isStatic&&(n.rotate(p,a.angle-s.angleB,p),s.angleB=a.angle);var S=m,w=p;if(i&&(S=n.add(i.position,m)),a&&(w=n.add(a.position,p)),!(!S||!w)){var h=n.sub(S,w),v=n.magnitude(h);v<e._minLength&&(v=e._minLength);var x=(v-s.length)/v,g=s.stiffness<1?s.stiffness*t:s.stiffness,M=n.mult(h,x*g),A=(i?i.inverseMass:0)+(a?a.inverseMass:0),T=(i?i.inverseInertia:0)+(a?a.inverseInertia:0),C=A+T,E,I,R,F,H;if(s.damping){var B=n.create();R=n.div(h,v),H=n.sub(a&&n.sub(a.position,a.positionPrev)||B,i&&n.sub(i.position,i.positionPrev)||B),F=n.dot(R,H)}i&&!i.isStatic&&(I=i.inverseMass/A,i.constraintImpulse.x-=M.x*I,i.constraintImpulse.y-=M.y*I,i.position.x-=M.x*I,i.position.y-=M.y*I,s.damping&&(i.positionPrev.x-=s.damping*R.x*F*I,i.positionPrev.y-=s.damping*R.y*F*I),E=n.cross(m,M)/C*e._torqueDampen*i.inverseInertia*(1-s.angularStiffness),i.constraintImpulse.angle-=E,i.angle-=E),a&&!a.isStatic&&(I=a.inverseMass/A,a.constraintImpulse.x+=M.x*I,a.constraintImpulse.y+=M.y*I,a.position.x+=M.x*I,a.position.y+=M.y*I,s.damping&&(a.positionPrev.x+=s.damping*R.x*F*I,a.positionPrev.y+=s.damping*R.y*F*I),E=n.cross(p,M)/C*e._torqueDampen*a.inverseInertia*(1-s.angularStiffness),a.constraintImpulse.angle+=E,a.angle+=E)}}},e.postSolveAll=function(s){for(var t=0;t<s.length;t++){var i=s[t],a=i.constraintImpulse;if(!(i.isStatic||a.x===0&&a.y===0&&a.angle===0)){r.set(i,!1);for(var m=0;m<i.parts.length;m++){var p=i.parts[m];o.translate(p.vertices,a),m>0&&(p.position.x+=a.x,p.position.y+=a.y),a.angle!==0&&(o.rotate(p.vertices,a.angle,i.position),l.rotate(p.axes,a.angle),m>0&&n.rotateAbout(p.position,a.angle,i.position,p.position)),c.update(p.bounds,p.vertices,i.velocity)}a.angle*=e._warming,a.x*=e._warming,a.y*=e._warming}}},e.pointAWorld=function(s){return{x:(s.bodyA?s.bodyA.position.x:0)+s.pointA.x,y:(s.bodyA?s.bodyA.position.y:0)+s.pointA.y}},e.pointBWorld=function(s){return{x:(s.bodyB?s.bodyB.position.x:0)+s.pointB.x,y:(s.bodyB?s.bodyB.position.y:0)+s.pointB.y}}})()},function(d,P,u){var e={};d.exports=e;var o=u(2),n=u(0);(function(){e.fromVertices=function(r){for(var c={},l=0;l<r.length;l++){var f=(l+1)%r.length,s=o.normalise({x:r[f].y-r[l].y,y:r[l].x-r[f].x}),t=s.y===0?1/0:s.x/s.y;t=t.toFixed(3).toString(),c[t]=s}return n.values(c)},e.rotate=function(r,c){if(c!==0)for(var l=Math.cos(c),f=Math.sin(c),s=0;s<r.length;s++){var t=r[s],i;i=t.x*l-t.y*f,t.y=t.x*f+t.y*l,t.x=i}}})()},function(d,P,u){var e={};d.exports=e;var o=u(3),n=u(0),r=u(6),c=u(1),l=u(2);(function(){e.rectangle=function(f,s,t,i,a){a=a||{};var m={label:"Rectangle Body",position:{x:f,y:s},vertices:o.fromPath("L 0 0 L "+t+" 0 L "+t+" "+i+" L 0 "+i)};if(a.chamfer){var p=a.chamfer;m.vertices=o.chamfer(m.vertices,p.radius,p.quality,p.qualityMin,p.qualityMax),delete a.chamfer}return r.create(n.extend({},m,a))},e.trapezoid=function(f,s,t,i,a,m){m=m||{},a*=.5;var p=(1-a*2)*t,S=t*a,w=S+p,h=w+S,v;a<.5?v="L 0 0 L "+S+" "+-i+" L "+w+" "+-i+" L "+h+" 0":v="L 0 0 L "+w+" "+-i+" L "+h+" 0";var x={label:"Trapezoid Body",position:{x:f,y:s},vertices:o.fromPath(v)};if(m.chamfer){var g=m.chamfer;x.vertices=o.chamfer(x.vertices,g.radius,g.quality,g.qualityMin,g.qualityMax),delete m.chamfer}return r.create(n.extend({},x,m))},e.circle=function(f,s,t,i,a){i=i||{};var m={label:"Circle Body",circleRadius:t};a=a||25;var p=Math.ceil(Math.max(10,Math.min(a,t)));return p%2===1&&(p+=1),e.polygon(f,s,p,t,n.extend({},m,i))},e.polygon=function(f,s,t,i,a){if(a=a||{},t<3)return e.circle(f,s,i,a);for(var m=2*Math.PI/t,p="",S=m*.5,w=0;w<t;w+=1){var h=S+w*m,v=Math.cos(h)*i,x=Math.sin(h)*i;p+="L "+v.toFixed(3)+" "+x.toFixed(3)+" "}var g={label:"Polygon Body",position:{x:f,y:s},vertices:o.fromPath(p)};if(a.chamfer){var M=a.chamfer;g.vertices=o.chamfer(g.vertices,M.radius,M.quality,M.qualityMin,M.qualityMax),delete a.chamfer}return r.create(n.extend({},g,a))},e.fromVertices=function(f,s,t,i,a,m,p,S){var w=n.getDecomp(),h,v,x,g,M,A,T,C,E,I,R;for(h=Boolean(w&&w.quickDecomp),i=i||{},x=[],a=typeof a<"u"?a:!1,m=typeof m<"u"?m:.01,p=typeof p<"u"?p:10,S=typeof S<"u"?S:.01,n.isArray(t[0])||(t=[t]),I=0;I<t.length;I+=1)if(A=t[I],g=o.isConvex(A),M=!g,M&&!h&&n.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),g||!h)g?A=o.clockwiseSort(A):A=o.hull(A),x.push({position:{x:f,y:s},vertices:A});else{var F=A.map(function(N){return[N.x,N.y]});w.makeCCW(F),m!==!1&&w.removeCollinearPoints(F,m),S!==!1&&w.removeDuplicatePoints&&w.removeDuplicatePoints(F,S);var H=w.quickDecomp(F);for(T=0;T<H.length;T++){var B=H[T],D=B.map(function(N){return{x:N[0],y:N[1]}});p>0&&o.area(D)<p||x.push({position:o.centre(D),vertices:D})}}for(T=0;T<x.length;T++)x[T]=r.create(n.extend(x[T],i));if(a){var L=5;for(T=0;T<x.length;T++){var k=x[T];for(C=T+1;C<x.length;C++){var b=x[C];if(c.overlaps(k.bounds,b.bounds)){var z=k.vertices,W=b.vertices;for(E=0;E<k.vertices.length;E++)for(R=0;R<b.vertices.length;R++){var $=l.magnitudeSquared(l.sub(z[(E+1)%z.length],W[R])),G=l.magnitudeSquared(l.sub(z[E],W[(R+1)%W.length]));$<L&&G<L&&(z[E].isInternal=!0,W[R].isInternal=!0)}}}}}return x.length>1?(v=r.create(n.extend({parts:x.slice(0)},i)),r.setPosition(v,{x:f,y:s}),v):x[0]}})()},function(d,P,u){var e={};d.exports=e;var o=u(0);(function(){e.create=function(n){var r={};return n||o.log("Mouse.create: element was undefined, defaulting to document.body","warn"),r.element=n||document.body,r.absolute={x:0,y:0},r.position={x:0,y:0},r.mousedownPosition={x:0,y:0},r.mouseupPosition={x:0,y:0},r.offset={x:0,y:0},r.scale={x:1,y:1},r.wheelDelta=0,r.button=-1,r.pixelRatio=parseInt(r.element.getAttribute("data-pixel-ratio"),10)||1,r.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},r.mousemove=function(c){var l=e._getRelativeMousePosition(c,r.element,r.pixelRatio),f=c.changedTouches;f&&(r.button=0,c.preventDefault()),r.absolute.x=l.x,r.absolute.y=l.y,r.position.x=r.absolute.x*r.scale.x+r.offset.x,r.position.y=r.absolute.y*r.scale.y+r.offset.y,r.sourceEvents.mousemove=c},r.mousedown=function(c){var l=e._getRelativeMousePosition(c,r.element,r.pixelRatio),f=c.changedTouches;f?(r.button=0,c.preventDefault()):r.button=c.button,r.absolute.x=l.x,r.absolute.y=l.y,r.position.x=r.absolute.x*r.scale.x+r.offset.x,r.position.y=r.absolute.y*r.scale.y+r.offset.y,r.mousedownPosition.x=r.position.x,r.mousedownPosition.y=r.position.y,r.sourceEvents.mousedown=c},r.mouseup=function(c){var l=e._getRelativeMousePosition(c,r.element,r.pixelRatio),f=c.changedTouches;f&&c.preventDefault(),r.button=-1,r.absolute.x=l.x,r.absolute.y=l.y,r.position.x=r.absolute.x*r.scale.x+r.offset.x,r.position.y=r.absolute.y*r.scale.y+r.offset.y,r.mouseupPosition.x=r.position.x,r.mouseupPosition.y=r.position.y,r.sourceEvents.mouseup=c},r.mousewheel=function(c){r.wheelDelta=Math.max(-1,Math.min(1,c.wheelDelta||-c.detail)),c.preventDefault()},e.setElement(r,r.element),r},e.setElement=function(n,r){n.element=r,r.addEventListener("mousemove",n.mousemove),r.addEventListener("mousedown",n.mousedown),r.addEventListener("mouseup",n.mouseup),r.addEventListener("mousewheel",n.mousewheel),r.addEventListener("DOMMouseScroll",n.mousewheel),r.addEventListener("touchmove",n.mousemove),r.addEventListener("touchstart",n.mousedown),r.addEventListener("touchend",n.mouseup)},e.clearSourceEvents=function(n){n.sourceEvents.mousemove=null,n.sourceEvents.mousedown=null,n.sourceEvents.mouseup=null,n.sourceEvents.mousewheel=null,n.wheelDelta=0},e.setOffset=function(n,r){n.offset.x=r.x,n.offset.y=r.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y},e.setScale=function(n,r){n.scale.x=r.x,n.scale.y=r.y,n.position.x=n.absolute.x*n.scale.x+n.offset.x,n.position.y=n.absolute.y*n.scale.y+n.offset.y},e._getRelativeMousePosition=function(n,r,c){var l=r.getBoundingClientRect(),f=document.documentElement||document.body.parentNode||document.body,s=window.pageXOffset!==void 0?window.pageXOffset:f.scrollLeft,t=window.pageYOffset!==void 0?window.pageYOffset:f.scrollTop,i=n.changedTouches,a,m;return i?(a=i[0].pageX-l.left-s,m=i[0].pageY-l.top-t):(a=n.pageX-l.left-s,m=n.pageY-l.top-t),{x:a/(r.clientWidth/(r.width||r.clientWidth)*c),y:m/(r.clientHeight/(r.height||r.clientHeight)*c)}}})()},function(d,P,u){var e={};d.exports=e;var o=u(0),n=u(8);(function(){e.create=function(r){var c={bodies:[],pairs:null};return o.extend(c,r)},e.setBodies=function(r,c){r.bodies=c.slice(0)},e.clear=function(r){r.bodies=[]},e.collisions=function(r){var c=[],l=r.pairs,f=r.bodies,s=f.length,t=e.canCollide,i=n.collides,a,m;for(f.sort(e._compareBoundsX),a=0;a<s;a++){var p=f[a],S=p.bounds,w=p.bounds.max.x,h=p.bounds.max.y,v=p.bounds.min.y,x=p.isStatic||p.isSleeping,g=p.parts.length,M=g===1;for(m=a+1;m<s;m++){var A=f[m],T=A.bounds;if(T.min.x>w)break;if(!(h<T.min.y||v>T.max.y)&&!(x&&(A.isStatic||A.isSleeping))&&!!t(p.collisionFilter,A.collisionFilter)){var C=A.parts.length;if(M&&C===1){var E=i(p,A,l);E&&c.push(E)}else for(var I=g>1?1:0,R=C>1?1:0,F=I;F<g;F++)for(var H=p.parts[F],S=H.bounds,B=R;B<C;B++){var D=A.parts[B],T=D.bounds;if(!(S.min.x>T.max.x||S.max.x<T.min.x||S.max.y<T.min.y||S.min.y>T.max.y)){var E=i(H,D,l);E&&c.push(E)}}}}}return c},e.canCollide=function(r,c){return r.group===c.group&&r.group!==0?r.group>0:(r.mask&c.category)!==0&&(c.mask&r.category)!==0},e._compareBoundsX=function(r,c){return r.bounds.min.x-c.bounds.min.x}})()},function(d,P,u){var e={};d.exports=e;var o=u(0);(function(){e._registry={},e.register=function(n){if(e.isPlugin(n)||o.warn("Plugin.register:",e.toString(n),"does not implement all required fields."),n.name in e._registry){var r=e._registry[n.name],c=e.versionParse(n.version).number,l=e.versionParse(r.version).number;c>l?(o.warn("Plugin.register:",e.toString(r),"was upgraded to",e.toString(n)),e._registry[n.name]=n):c<l?o.warn("Plugin.register:",e.toString(r),"can not be downgraded to",e.toString(n)):n!==r&&o.warn("Plugin.register:",e.toString(n),"is already registered to different plugin object")}else e._registry[n.name]=n;return n},e.resolve=function(n){return e._registry[e.dependencyParse(n).name]},e.toString=function(n){return typeof n=="string"?n:(n.name||"anonymous")+"@"+(n.version||n.range||"0.0.0")},e.isPlugin=function(n){return n&&n.name&&n.version&&n.install},e.isUsed=function(n,r){return n.used.indexOf(r)>-1},e.isFor=function(n,r){var c=n.for&&e.dependencyParse(n.for);return!n.for||r.name===c.name&&e.versionSatisfies(r.version,c.range)},e.use=function(n,r){if(n.uses=(n.uses||[]).concat(r||[]),n.uses.length===0){o.warn("Plugin.use:",e.toString(n),"does not specify any dependencies to install.");return}for(var c=e.dependencies(n),l=o.topologicalSort(c),f=[],s=0;s<l.length;s+=1)if(l[s]!==n.name){var t=e.resolve(l[s]);if(!t){f.push("\u274C "+l[s]);continue}e.isUsed(n,t.name)||(e.isFor(t,n)||(o.warn("Plugin.use:",e.toString(t),"is for",t.for,"but installed on",e.toString(n)+"."),t._warned=!0),t.install?t.install(n):(o.warn("Plugin.use:",e.toString(t),"does not specify an install function."),t._warned=!0),t._warned?(f.push("\u{1F536} "+e.toString(t)),delete t._warned):f.push("\u2705 "+e.toString(t)),n.used.push(t.name))}f.length>0&&o.info(f.join("  "))},e.dependencies=function(n,r){var c=e.dependencyParse(n),l=c.name;if(r=r||{},!(l in r)){n=e.resolve(n)||n,r[l]=o.map(n.uses||[],function(s){e.isPlugin(s)&&e.register(s);var t=e.dependencyParse(s),i=e.resolve(s);return i&&!e.versionSatisfies(i.version,t.range)?(o.warn("Plugin.dependencies:",e.toString(i),"does not satisfy",e.toString(t),"used by",e.toString(c)+"."),i._warned=!0,n._warned=!0):i||(o.warn("Plugin.dependencies:",e.toString(s),"used by",e.toString(c),"could not be resolved."),n._warned=!0),t.name});for(var f=0;f<r[l].length;f+=1)e.dependencies(r[l][f],r);return r}},e.dependencyParse=function(n){if(o.isString(n)){var r=/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/;return r.test(n)||o.warn("Plugin.dependencyParse:",n,"is not a valid dependency string."),{name:n.split("@")[0],range:n.split("@")[1]||"*"}}return{name:n.name,range:n.range||n.version}},e.versionParse=function(n){var r=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;r.test(n)||o.warn("Plugin.versionParse:",n,"is not a valid version or range.");var c=r.exec(n),l=Number(c[4]),f=Number(c[5]),s=Number(c[6]);return{isRange:Boolean(c[1]||c[2]),version:c[3],range:n,operator:c[1]||c[2]||"",major:l,minor:f,patch:s,parts:[l,f,s],prerelease:c[7],number:l*1e8+f*1e4+s}},e.versionSatisfies=function(n,r){r=r||"*";var c=e.versionParse(r),l=e.versionParse(n);if(c.isRange){if(c.operator==="*"||n==="*")return!0;if(c.operator===">")return l.number>c.number;if(c.operator===">=")return l.number>=c.number;if(c.operator==="~")return l.major===c.major&&l.minor===c.minor&&l.patch>=c.patch;if(c.operator==="^")return c.major>0?l.major===c.major&&l.number>=c.number:c.minor>0?l.minor===c.minor&&l.patch>=c.patch:l.patch===c.patch}return n===r||n==="*"}})()},function(d,P,u){var e={};d.exports=e;var o=u(0),n=u(5),r=u(1),c=u(4),l=u(2),f=u(13);(function(){var s,t;typeof window<"u"&&(s=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(h){window.setTimeout(function(){h(o.now())},1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),e._goodFps=30,e._goodDelta=1e3/60,e.create=function(h){var v={controller:e,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!h.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},x=o.extend(v,h);return x.canvas&&(x.canvas.width=x.options.width||x.canvas.width,x.canvas.height=x.options.height||x.canvas.height),x.mouse=h.mouse,x.engine=h.engine,x.canvas=x.canvas||m(x.options.width,x.options.height),x.context=x.canvas.getContext("2d"),x.textures={},x.bounds=x.bounds||{min:{x:0,y:0},max:{x:x.canvas.width,y:x.canvas.height}},x.options.showBroadphase=!1,x.options.pixelRatio!==1&&e.setPixelRatio(x,x.options.pixelRatio),o.isElement(x.element)?x.element.appendChild(x.canvas):x.canvas.parentNode||o.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),x},e.run=function(h){(function v(x){h.frameRequestId=s(v),i(h,x),e.world(h,x),(h.options.showStats||h.options.showDebug)&&e.stats(h,h.context,x),(h.options.showPerformance||h.options.showDebug)&&e.performance(h,h.context,x)})()},e.stop=function(h){t(h.frameRequestId)},e.setPixelRatio=function(h,v){var x=h.options,g=h.canvas;v==="auto"&&(v=p(g)),x.pixelRatio=v,g.setAttribute("data-pixel-ratio",v),g.width=x.width*v,g.height=x.height*v,g.style.width=x.width+"px",g.style.height=x.height+"px"},e.lookAt=function(h,v,x,g){g=typeof g<"u"?g:!0,v=o.isArray(v)?v:[v],x=x||{x:0,y:0};for(var M={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},A=0;A<v.length;A+=1){var T=v[A],C=T.bounds?T.bounds.min:T.min||T.position||T,E=T.bounds?T.bounds.max:T.max||T.position||T;C&&E&&(C.x<M.min.x&&(M.min.x=C.x),E.x>M.max.x&&(M.max.x=E.x),C.y<M.min.y&&(M.min.y=C.y),E.y>M.max.y&&(M.max.y=E.y))}var I=M.max.x-M.min.x+2*x.x,R=M.max.y-M.min.y+2*x.y,F=h.canvas.height,H=h.canvas.width,B=H/F,D=I/R,L=1,k=1;D>B?k=D/B:L=B/D,h.options.hasBounds=!0,h.bounds.min.x=M.min.x,h.bounds.max.x=M.min.x+I*L,h.bounds.min.y=M.min.y,h.bounds.max.y=M.min.y+R*k,g&&(h.bounds.min.x+=I*.5-I*L*.5,h.bounds.max.x+=I*.5-I*L*.5,h.bounds.min.y+=R*.5-R*k*.5,h.bounds.max.y+=R*.5-R*k*.5),h.bounds.min.x-=x.x,h.bounds.max.x-=x.x,h.bounds.min.y-=x.y,h.bounds.max.y-=x.y,h.mouse&&(f.setScale(h.mouse,{x:(h.bounds.max.x-h.bounds.min.x)/h.canvas.width,y:(h.bounds.max.y-h.bounds.min.y)/h.canvas.height}),f.setOffset(h.mouse,h.bounds.min))},e.startViewTransform=function(h){var v=h.bounds.max.x-h.bounds.min.x,x=h.bounds.max.y-h.bounds.min.y,g=v/h.options.width,M=x/h.options.height;h.context.setTransform(h.options.pixelRatio/g,0,0,h.options.pixelRatio/M,0,0),h.context.translate(-h.bounds.min.x,-h.bounds.min.y)},e.endViewTransform=function(h){h.context.setTransform(h.options.pixelRatio,0,0,h.options.pixelRatio,0,0)},e.world=function(h,v){var x=o.now(),g=h.engine,M=g.world,A=h.canvas,T=h.context,C=h.options,E=h.timing,I=n.allBodies(M),R=n.allConstraints(M),F=C.wireframes?C.wireframeBackground:C.background,H=[],B=[],D,L={timestamp:g.timing.timestamp};if(c.trigger(h,"beforeRender",L),h.currentBackground!==F&&w(h,F),T.globalCompositeOperation="source-in",T.fillStyle="transparent",T.fillRect(0,0,A.width,A.height),T.globalCompositeOperation="source-over",C.hasBounds){for(D=0;D<I.length;D++){var k=I[D];r.overlaps(k.bounds,h.bounds)&&H.push(k)}for(D=0;D<R.length;D++){var b=R[D],z=b.bodyA,W=b.bodyB,$=b.pointA,G=b.pointB;z&&($=l.add(z.position,b.pointA)),W&&(G=l.add(W.position,b.pointB)),!(!$||!G)&&(r.contains(h.bounds,$)||r.contains(h.bounds,G))&&B.push(b)}e.startViewTransform(h),h.mouse&&(f.setScale(h.mouse,{x:(h.bounds.max.x-h.bounds.min.x)/h.options.width,y:(h.bounds.max.y-h.bounds.min.y)/h.options.height}),f.setOffset(h.mouse,h.bounds.min))}else B=R,H=I,h.options.pixelRatio!==1&&h.context.setTransform(h.options.pixelRatio,0,0,h.options.pixelRatio,0,0);!C.wireframes||g.enableSleeping&&C.showSleeping?e.bodies(h,H,T):(C.showConvexHulls&&e.bodyConvexHulls(h,H,T),e.bodyWireframes(h,H,T)),C.showBounds&&e.bodyBounds(h,H,T),(C.showAxes||C.showAngleIndicator)&&e.bodyAxes(h,H,T),C.showPositions&&e.bodyPositions(h,H,T),C.showVelocity&&e.bodyVelocity(h,H,T),C.showIds&&e.bodyIds(h,H,T),C.showSeparations&&e.separations(h,g.pairs.list,T),C.showCollisions&&e.collisions(h,g.pairs.list,T),C.showVertexNumbers&&e.vertexNumbers(h,H,T),C.showMousePosition&&e.mousePosition(h,h.mouse,T),e.constraints(B,T),C.hasBounds&&e.endViewTransform(h),c.trigger(h,"afterRender",L),E.lastElapsed=o.now()-x},e.stats=function(h,v,x){for(var g=h.engine,M=g.world,A=n.allBodies(M),T=0,C=55,E=44,I=0,R=0,F=0;F<A.length;F+=1)T+=A[F].parts.length;var H={Part:T,Body:A.length,Cons:n.allConstraints(M).length,Comp:n.allComposites(M).length,Pair:g.pairs.list.length};v.fillStyle="#0e0f19",v.fillRect(I,R,C*5.5,E),v.font="12px Arial",v.textBaseline="top",v.textAlign="right";for(var B in H){var D=H[B];v.fillStyle="#aaa",v.fillText(B,I+C,R+8),v.fillStyle="#eee",v.fillText(D,I+C,R+26),I+=C}},e.performance=function(h,v){var x=h.engine,g=h.timing,M=g.deltaHistory,A=g.elapsedHistory,T=g.timestampElapsedHistory,C=g.engineDeltaHistory,E=g.engineElapsedHistory,I=x.timing.lastDelta,R=a(M),F=a(A),H=a(C),B=a(E),D=a(T),L=D/R||0,k=1e3/R||0,b=4,z=12,W=60,$=34,G=10,N=69;v.fillStyle="#0e0f19",v.fillRect(0,50,z*4+W*5+22,$),e.status(v,G,N,W,b,M.length,Math.round(k)+" fps",k/e._goodFps,function(U){return M[U]/R-1}),e.status(v,G+z+W,N,W,b,C.length,I.toFixed(2)+" dt",e._goodDelta/I,function(U){return C[U]/H-1}),e.status(v,G+(z+W)*2,N,W,b,E.length,B.toFixed(2)+" ut",1-B/e._goodFps,function(U){return E[U]/B-1}),e.status(v,G+(z+W)*3,N,W,b,A.length,F.toFixed(2)+" rt",1-F/e._goodFps,function(U){return A[U]/F-1}),e.status(v,G+(z+W)*4,N,W,b,T.length,L.toFixed(2)+" x",L*L*L,function(U){return(T[U]/M[U]/L||0)-1})},e.status=function(h,v,x,g,M,A,T,C,E){h.strokeStyle="#888",h.fillStyle="#444",h.lineWidth=1,h.fillRect(v,x+7,g,1),h.beginPath(),h.moveTo(v,x+7-M*o.clamp(.4*E(0),-2,2));for(var I=0;I<g;I+=1)h.lineTo(v+I,x+7-(I<A?M*o.clamp(.4*E(I),-2,2):0));h.stroke(),h.fillStyle="hsl("+o.clamp(25+95*C,0,120)+",100%,60%)",h.fillRect(v,x-7,4,4),h.font="12px Arial",h.textBaseline="middle",h.textAlign="right",h.fillStyle="#eee",h.fillText(T,v+g,x-5)},e.constraints=function(h,v){for(var x=v,g=0;g<h.length;g++){var M=h[g];if(!(!M.render.visible||!M.pointA||!M.pointB)){var A=M.bodyA,T=M.bodyB,C,E;if(A?C=l.add(A.position,M.pointA):C=M.pointA,M.render.type==="pin")x.beginPath(),x.arc(C.x,C.y,3,0,2*Math.PI),x.closePath();else{if(T?E=l.add(T.position,M.pointB):E=M.pointB,x.beginPath(),x.moveTo(C.x,C.y),M.render.type==="spring")for(var I=l.sub(E,C),R=l.perp(l.normalise(I)),F=Math.ceil(o.clamp(M.length/5,12,20)),H,B=1;B<F;B+=1)H=B%2===0?1:-1,x.lineTo(C.x+I.x*(B/F)+R.x*H*4,C.y+I.y*(B/F)+R.y*H*4);x.lineTo(E.x,E.y)}M.render.lineWidth&&(x.lineWidth=M.render.lineWidth,x.strokeStyle=M.render.strokeStyle,x.stroke()),M.render.anchors&&(x.fillStyle=M.render.strokeStyle,x.beginPath(),x.arc(C.x,C.y,3,0,2*Math.PI),x.arc(E.x,E.y,3,0,2*Math.PI),x.closePath(),x.fill())}}},e.bodies=function(h,v,x){var g=x;h.engine;var M=h.options,A=M.showInternalEdges||!M.wireframes,T,C,E,I;for(E=0;E<v.length;E++)if(T=v[E],!!T.render.visible){for(I=T.parts.length>1?1:0;I<T.parts.length;I++)if(C=T.parts[I],!!C.render.visible){if(M.showSleeping&&T.isSleeping?g.globalAlpha=.5*C.render.opacity:C.render.opacity!==1&&(g.globalAlpha=C.render.opacity),C.render.sprite&&C.render.sprite.texture&&!M.wireframes){var R=C.render.sprite,F=S(h,R.texture);g.translate(C.position.x,C.position.y),g.rotate(C.angle),g.drawImage(F,F.width*-R.xOffset*R.xScale,F.height*-R.yOffset*R.yScale,F.width*R.xScale,F.height*R.yScale),g.rotate(-C.angle),g.translate(-C.position.x,-C.position.y)}else{if(C.circleRadius)g.beginPath(),g.arc(C.position.x,C.position.y,C.circleRadius,0,2*Math.PI);else{g.beginPath(),g.moveTo(C.vertices[0].x,C.vertices[0].y);for(var H=1;H<C.vertices.length;H++)!C.vertices[H-1].isInternal||A?g.lineTo(C.vertices[H].x,C.vertices[H].y):g.moveTo(C.vertices[H].x,C.vertices[H].y),C.vertices[H].isInternal&&!A&&g.moveTo(C.vertices[(H+1)%C.vertices.length].x,C.vertices[(H+1)%C.vertices.length].y);g.lineTo(C.vertices[0].x,C.vertices[0].y),g.closePath()}M.wireframes?(g.lineWidth=1,g.strokeStyle="#bbb",g.stroke()):(g.fillStyle=C.render.fillStyle,C.render.lineWidth&&(g.lineWidth=C.render.lineWidth,g.strokeStyle=C.render.strokeStyle,g.stroke()),g.fill())}g.globalAlpha=1}}},e.bodyWireframes=function(h,v,x){var g=x,M=h.options.showInternalEdges,A,T,C,E,I;for(g.beginPath(),C=0;C<v.length;C++)if(A=v[C],!!A.render.visible)for(I=A.parts.length>1?1:0;I<A.parts.length;I++){for(T=A.parts[I],g.moveTo(T.vertices[0].x,T.vertices[0].y),E=1;E<T.vertices.length;E++)!T.vertices[E-1].isInternal||M?g.lineTo(T.vertices[E].x,T.vertices[E].y):g.moveTo(T.vertices[E].x,T.vertices[E].y),T.vertices[E].isInternal&&!M&&g.moveTo(T.vertices[(E+1)%T.vertices.length].x,T.vertices[(E+1)%T.vertices.length].y);g.lineTo(T.vertices[0].x,T.vertices[0].y)}g.lineWidth=1,g.strokeStyle="#bbb",g.stroke()},e.bodyConvexHulls=function(h,v,x){var g=x,M,A,T;for(g.beginPath(),A=0;A<v.length;A++)if(M=v[A],!(!M.render.visible||M.parts.length===1)){for(g.moveTo(M.vertices[0].x,M.vertices[0].y),T=1;T<M.vertices.length;T++)g.lineTo(M.vertices[T].x,M.vertices[T].y);g.lineTo(M.vertices[0].x,M.vertices[0].y)}g.lineWidth=1,g.strokeStyle="rgba(255,255,255,0.2)",g.stroke()},e.vertexNumbers=function(h,v,x){var g=x,M,A,T;for(M=0;M<v.length;M++){var C=v[M].parts;for(T=C.length>1?1:0;T<C.length;T++){var E=C[T];for(A=0;A<E.vertices.length;A++)g.fillStyle="rgba(255,255,255,0.2)",g.fillText(M+"_"+A,E.position.x+(E.vertices[A].x-E.position.x)*.8,E.position.y+(E.vertices[A].y-E.position.y)*.8)}}},e.mousePosition=function(h,v,x){var g=x;g.fillStyle="rgba(255,255,255,0.8)",g.fillText(v.position.x+"  "+v.position.y,v.position.x+5,v.position.y-5)},e.bodyBounds=function(h,v,x){var g=x;h.engine;var M=h.options;g.beginPath();for(var A=0;A<v.length;A++){var T=v[A];if(T.render.visible)for(var C=v[A].parts,E=C.length>1?1:0;E<C.length;E++){var I=C[E];g.rect(I.bounds.min.x,I.bounds.min.y,I.bounds.max.x-I.bounds.min.x,I.bounds.max.y-I.bounds.min.y)}}M.wireframes?g.strokeStyle="rgba(255,255,255,0.08)":g.strokeStyle="rgba(0,0,0,0.1)",g.lineWidth=1,g.stroke()},e.bodyAxes=function(h,v,x){var g=x;h.engine;var M=h.options,A,T,C,E;for(g.beginPath(),T=0;T<v.length;T++){var I=v[T],R=I.parts;if(!!I.render.visible)if(M.showAxes)for(C=R.length>1?1:0;C<R.length;C++)for(A=R[C],E=0;E<A.axes.length;E++){var F=A.axes[E];g.moveTo(A.position.x,A.position.y),g.lineTo(A.position.x+F.x*20,A.position.y+F.y*20)}else for(C=R.length>1?1:0;C<R.length;C++)for(A=R[C],E=0;E<A.axes.length;E++)g.moveTo(A.position.x,A.position.y),g.lineTo((A.vertices[0].x+A.vertices[A.vertices.length-1].x)/2,(A.vertices[0].y+A.vertices[A.vertices.length-1].y)/2)}M.wireframes?(g.strokeStyle="indianred",g.lineWidth=1):(g.strokeStyle="rgba(255, 255, 255, 0.4)",g.globalCompositeOperation="overlay",g.lineWidth=2),g.stroke(),g.globalCompositeOperation="source-over"},e.bodyPositions=function(h,v,x){var g=x;h.engine;var M=h.options,A,T,C,E;for(g.beginPath(),C=0;C<v.length;C++)if(A=v[C],!!A.render.visible)for(E=0;E<A.parts.length;E++)T=A.parts[E],g.arc(T.position.x,T.position.y,3,0,2*Math.PI,!1),g.closePath();for(M.wireframes?g.fillStyle="indianred":g.fillStyle="rgba(0,0,0,0.5)",g.fill(),g.beginPath(),C=0;C<v.length;C++)A=v[C],A.render.visible&&(g.arc(A.positionPrev.x,A.positionPrev.y,2,0,2*Math.PI,!1),g.closePath());g.fillStyle="rgba(255,165,0,0.8)",g.fill()},e.bodyVelocity=function(h,v,x){var g=x;g.beginPath();for(var M=0;M<v.length;M++){var A=v[M];!A.render.visible||(g.moveTo(A.position.x,A.position.y),g.lineTo(A.position.x+(A.position.x-A.positionPrev.x)*2,A.position.y+(A.position.y-A.positionPrev.y)*2))}g.lineWidth=3,g.strokeStyle="cornflowerblue",g.stroke()},e.bodyIds=function(h,v,x){var g=x,M,A;for(M=0;M<v.length;M++)if(!!v[M].render.visible){var T=v[M].parts;for(A=T.length>1?1:0;A<T.length;A++){var C=T[A];g.font="12px Arial",g.fillStyle="rgba(255,255,255,0.5)",g.fillText(C.id,C.position.x+10,C.position.y-10)}}},e.collisions=function(h,v,x){var g=x,M=h.options,A,T,C,E;for(g.beginPath(),C=0;C<v.length;C++)if(A=v[C],!!A.isActive)for(T=A.collision,E=0;E<A.activeContacts.length;E++){var I=A.activeContacts[E],R=I.vertex;g.rect(R.x-1.5,R.y-1.5,3.5,3.5)}for(M.wireframes?g.fillStyle="rgba(255,255,255,0.7)":g.fillStyle="orange",g.fill(),g.beginPath(),C=0;C<v.length;C++)if(A=v[C],!!A.isActive&&(T=A.collision,A.activeContacts.length>0)){var F=A.activeContacts[0].vertex.x,H=A.activeContacts[0].vertex.y;A.activeContacts.length===2&&(F=(A.activeContacts[0].vertex.x+A.activeContacts[1].vertex.x)/2,H=(A.activeContacts[0].vertex.y+A.activeContacts[1].vertex.y)/2),T.bodyB===T.supports[0].body||T.bodyA.isStatic===!0?g.moveTo(F-T.normal.x*8,H-T.normal.y*8):g.moveTo(F+T.normal.x*8,H+T.normal.y*8),g.lineTo(F,H)}M.wireframes?g.strokeStyle="rgba(255,165,0,0.7)":g.strokeStyle="orange",g.lineWidth=1,g.stroke()},e.separations=function(h,v,x){var g=x,M=h.options,A,T,C,E,I;for(g.beginPath(),I=0;I<v.length;I++)if(A=v[I],!!A.isActive){T=A.collision,C=T.bodyA,E=T.bodyB;var R=1;!E.isStatic&&!C.isStatic&&(R=.5),E.isStatic&&(R=0),g.moveTo(E.position.x,E.position.y),g.lineTo(E.position.x-T.penetration.x*R,E.position.y-T.penetration.y*R),R=1,!E.isStatic&&!C.isStatic&&(R=.5),C.isStatic&&(R=0),g.moveTo(C.position.x,C.position.y),g.lineTo(C.position.x+T.penetration.x*R,C.position.y+T.penetration.y*R)}M.wireframes?g.strokeStyle="rgba(255,165,0,0.5)":g.strokeStyle="orange",g.stroke()},e.inspector=function(h,v){h.engine;var x=h.selected,g=h.render,M=g.options,A;if(M.hasBounds){var T=g.bounds.max.x-g.bounds.min.x,C=g.bounds.max.y-g.bounds.min.y,E=T/g.options.width,I=C/g.options.height;v.scale(1/E,1/I),v.translate(-g.bounds.min.x,-g.bounds.min.y)}for(var R=0;R<x.length;R++){var F=x[R].data;switch(v.translate(.5,.5),v.lineWidth=1,v.strokeStyle="rgba(255,165,0,0.9)",v.setLineDash([1,2]),F.type){case"body":A=F.bounds,v.beginPath(),v.rect(Math.floor(A.min.x-3),Math.floor(A.min.y-3),Math.floor(A.max.x-A.min.x+6),Math.floor(A.max.y-A.min.y+6)),v.closePath(),v.stroke();break;case"constraint":var H=F.pointA;F.bodyA&&(H=F.pointB),v.beginPath(),v.arc(H.x,H.y,10,0,2*Math.PI),v.closePath(),v.stroke();break}v.setLineDash([]),v.translate(-.5,-.5)}h.selectStart!==null&&(v.translate(.5,.5),v.lineWidth=1,v.strokeStyle="rgba(255,165,0,0.6)",v.fillStyle="rgba(255,165,0,0.1)",A=h.selectBounds,v.beginPath(),v.rect(Math.floor(A.min.x),Math.floor(A.min.y),Math.floor(A.max.x-A.min.x),Math.floor(A.max.y-A.min.y)),v.closePath(),v.stroke(),v.fill(),v.translate(-.5,-.5)),M.hasBounds&&v.setTransform(1,0,0,1,0,0)};var i=function(h,v){var x=h.engine,g=h.timing,M=g.historySize,A=x.timing.timestamp;g.delta=v-g.lastTime||e._goodDelta,g.lastTime=v,g.timestampElapsed=A-g.lastTimestamp||0,g.lastTimestamp=A,g.deltaHistory.unshift(g.delta),g.deltaHistory.length=Math.min(g.deltaHistory.length,M),g.engineDeltaHistory.unshift(x.timing.lastDelta),g.engineDeltaHistory.length=Math.min(g.engineDeltaHistory.length,M),g.timestampElapsedHistory.unshift(g.timestampElapsed),g.timestampElapsedHistory.length=Math.min(g.timestampElapsedHistory.length,M),g.engineElapsedHistory.unshift(x.timing.lastElapsed),g.engineElapsedHistory.length=Math.min(g.engineElapsedHistory.length,M),g.elapsedHistory.unshift(g.lastElapsed),g.elapsedHistory.length=Math.min(g.elapsedHistory.length,M)},a=function(h){for(var v=0,x=0;x<h.length;x+=1)v+=h[x];return v/h.length||0},m=function(h,v){var x=document.createElement("canvas");return x.width=h,x.height=v,x.oncontextmenu=function(){return!1},x.onselectstart=function(){return!1},x},p=function(h){var v=h.getContext("2d"),x=window.devicePixelRatio||1,g=v.webkitBackingStorePixelRatio||v.mozBackingStorePixelRatio||v.msBackingStorePixelRatio||v.oBackingStorePixelRatio||v.backingStorePixelRatio||1;return x/g},S=function(h,v){var x=h.textures[v];return x||(x=h.textures[v]=new Image,x.src=v,x)},w=function(h,v){var x=v;/(jpg|gif|png)$/.test(v)&&(x="url("+v+")"),h.canvas.style.background=x,h.canvas.style.backgroundSize="contain",h.currentBackground=v}})()},function(d,P){var u={};d.exports=u,function(){u.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}}()},function(d,P,u){var e={};d.exports=e;var o=u(7),n=u(19),r=u(14),c=u(20),l=u(4),f=u(5),s=u(10),t=u(0),i=u(6);(function(){e.create=function(a){a=a||{};var m={positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},p=t.extend(m,a);return p.world=a.world||f.create({label:"World"}),p.pairs=a.pairs||c.create(),p.detector=a.detector||r.create(),p.grid={buckets:[]},p.world.gravity=p.gravity,p.broadphase=p.grid,p.metrics={},p},e.update=function(a,m,p){var S=t.now();m=m||1e3/60,p=p||1;var w=a.world,h=a.detector,v=a.pairs,x=a.timing,g=x.timestamp,M;x.timestamp+=m*x.timeScale,x.lastDelta=m*x.timeScale;var A={timestamp:x.timestamp};l.trigger(a,"beforeUpdate",A);var T=f.allBodies(w),C=f.allConstraints(w);for(w.isModified&&r.setBodies(h,T),w.isModified&&f.setModified(w,!1,!1,!0),a.enableSleeping&&o.update(T,x.timeScale),e._bodiesApplyGravity(T,a.gravity),e._bodiesUpdate(T,m,x.timeScale,p,w.bounds),s.preSolveAll(T),M=0;M<a.constraintIterations;M++)s.solveAll(C,x.timeScale);s.postSolveAll(T),h.pairs=a.pairs;var E=r.collisions(h);for(c.update(v,E,g),a.enableSleeping&&o.afterCollisions(v.list,x.timeScale),v.collisionStart.length>0&&l.trigger(a,"collisionStart",{pairs:v.collisionStart}),n.preSolvePosition(v.list),M=0;M<a.positionIterations;M++)n.solvePosition(v.list,x.timeScale);for(n.postSolvePosition(T),s.preSolveAll(T),M=0;M<a.constraintIterations;M++)s.solveAll(C,x.timeScale);for(s.postSolveAll(T),n.preSolveVelocity(v.list),M=0;M<a.velocityIterations;M++)n.solveVelocity(v.list,x.timeScale);return v.collisionActive.length>0&&l.trigger(a,"collisionActive",{pairs:v.collisionActive}),v.collisionEnd.length>0&&l.trigger(a,"collisionEnd",{pairs:v.collisionEnd}),e._bodiesClearForces(T),l.trigger(a,"afterUpdate",A),a.timing.lastElapsed=t.now()-S,a},e.merge=function(a,m){if(t.extend(a,m),m.world){a.world=m.world,e.clear(a);for(var p=f.allBodies(a.world),S=0;S<p.length;S++){var w=p[S];o.set(w,!1),w.id=t.nextId()}}},e.clear=function(a){c.clear(a.pairs),r.clear(a.detector)},e._bodiesClearForces=function(a){for(var m=0;m<a.length;m++){var p=a[m];p.force.x=0,p.force.y=0,p.torque=0}},e._bodiesApplyGravity=function(a,m){var p=typeof m.scale<"u"?m.scale:.001;if(!(m.x===0&&m.y===0||p===0))for(var S=0;S<a.length;S++){var w=a[S];w.isStatic||w.isSleeping||(w.force.y+=w.mass*m.y*p,w.force.x+=w.mass*m.x*p)}},e._bodiesUpdate=function(a,m,p,S,w){for(var h=0;h<a.length;h++){var v=a[h];v.isStatic||v.isSleeping||i.update(v,m,p,S)}}})()},function(d,P,u){var e={};d.exports=e;var o=u(3),n=u(1);(function(){e._restingThresh=4,e._restingThreshTangent=6,e._positionDampen=.9,e._positionWarming=.8,e._frictionNormalMultiplier=5,e.preSolvePosition=function(r){var c,l,f,s=r.length;for(c=0;c<s;c++)l=r[c],l.isActive&&(f=l.activeContacts.length,l.collision.parentA.totalContacts+=f,l.collision.parentB.totalContacts+=f)},e.solvePosition=function(r,c){var l,f,s,t,i,a,m,p,S=e._positionDampen,w=r.length;for(l=0;l<w;l++)f=r[l],!(!f.isActive||f.isSensor)&&(s=f.collision,t=s.parentA,i=s.parentB,a=s.normal,f.separation=a.x*(i.positionImpulse.x+s.penetration.x-t.positionImpulse.x)+a.y*(i.positionImpulse.y+s.penetration.y-t.positionImpulse.y));for(l=0;l<w;l++)f=r[l],!(!f.isActive||f.isSensor)&&(s=f.collision,t=s.parentA,i=s.parentB,a=s.normal,p=(f.separation-f.slop)*c,(t.isStatic||i.isStatic)&&(p*=2),t.isStatic||t.isSleeping||(m=S/t.totalContacts,t.positionImpulse.x+=a.x*p*m,t.positionImpulse.y+=a.y*p*m),i.isStatic||i.isSleeping||(m=S/i.totalContacts,i.positionImpulse.x-=a.x*p*m,i.positionImpulse.y-=a.y*p*m))},e.postSolvePosition=function(r){for(var c=e._positionWarming,l=r.length,f=o.translate,s=n.update,t=0;t<l;t++){var i=r[t],a=i.positionImpulse,m=a.x,p=a.y,S=i.velocity;if(i.totalContacts=0,m!==0||p!==0){for(var w=0;w<i.parts.length;w++){var h=i.parts[w];f(h.vertices,a),s(h.bounds,h.vertices,S),h.position.x+=m,h.position.y+=p}i.positionPrev.x+=m,i.positionPrev.y+=p,m*S.x+p*S.y<0?(a.x=0,a.y=0):(a.x*=c,a.y*=c)}}},e.preSolveVelocity=function(r){var c=r.length,l,f;for(l=0;l<c;l++){var s=r[l];if(!(!s.isActive||s.isSensor)){var t=s.activeContacts,i=t.length,a=s.collision,m=a.parentA,p=a.parentB,S=a.normal,w=a.tangent;for(f=0;f<i;f++){var h=t[f],v=h.vertex,x=h.normalImpulse,g=h.tangentImpulse;if(x!==0||g!==0){var M=S.x*x+w.x*g,A=S.y*x+w.y*g;m.isStatic||m.isSleeping||(m.positionPrev.x+=M*m.inverseMass,m.positionPrev.y+=A*m.inverseMass,m.anglePrev+=m.inverseInertia*((v.x-m.position.x)*A-(v.y-m.position.y)*M)),p.isStatic||p.isSleeping||(p.positionPrev.x-=M*p.inverseMass,p.positionPrev.y-=A*p.inverseMass,p.anglePrev-=p.inverseInertia*((v.x-p.position.x)*A-(v.y-p.position.y)*M))}}}}},e.solveVelocity=function(r,c){var l=c*c,f=e._restingThresh*l,s=e._frictionNormalMultiplier,t=e._restingThreshTangent*l,i=Number.MAX_VALUE,a=r.length,m,p,S,w;for(S=0;S<a;S++){var h=r[S];if(!(!h.isActive||h.isSensor)){var v=h.collision,x=v.parentA,g=v.parentB,M=x.velocity,A=g.velocity,T=v.normal.x,C=v.normal.y,E=v.tangent.x,I=v.tangent.y,R=h.activeContacts,F=R.length,H=1/F,B=x.inverseMass+g.inverseMass,D=h.friction*h.frictionStatic*s*l;for(M.x=x.position.x-x.positionPrev.x,M.y=x.position.y-x.positionPrev.y,A.x=g.position.x-g.positionPrev.x,A.y=g.position.y-g.positionPrev.y,x.angularVelocity=x.angle-x.anglePrev,g.angularVelocity=g.angle-g.anglePrev,w=0;w<F;w++){var L=R[w],k=L.vertex,b=k.x-x.position.x,z=k.y-x.position.y,W=k.x-g.position.x,$=k.y-g.position.y,G=M.x-z*x.angularVelocity,N=M.y+b*x.angularVelocity,U=A.x-$*g.angularVelocity,_=A.y+W*g.angularVelocity,Z=G-U,K=N-_,J=T*Z+C*K,j=E*Z+I*K,se=h.separation+J,ee=Math.min(se,1);ee=se<0?0:ee;var Pe=ee*D;j>Pe||-j>Pe?(p=j>0?j:-j,m=h.friction*(j>0?1:-1)*l,m<-p?m=-p:m>p&&(m=p)):(m=j,p=i);var Ce=b*C-z*T,Ae=W*C-$*T,Me=H/(B+x.inverseInertia*Ce*Ce+g.inverseInertia*Ae*Ae),re=(1+h.restitution)*J*Me;if(m*=Me,J*J>f&&J<0)L.normalImpulse=0;else{var We=L.normalImpulse;L.normalImpulse+=re,L.normalImpulse=Math.min(L.normalImpulse,0),re=L.normalImpulse-We}if(j*j>t)L.tangentImpulse=0;else{var ze=L.tangentImpulse;L.tangentImpulse+=m,L.tangentImpulse<-p&&(L.tangentImpulse=-p),L.tangentImpulse>p&&(L.tangentImpulse=p),m=L.tangentImpulse-ze}var ae=T*re+E*m,oe=C*re+I*m;x.isStatic||x.isSleeping||(x.positionPrev.x+=ae*x.inverseMass,x.positionPrev.y+=oe*x.inverseMass,x.anglePrev+=(b*oe-z*ae)*x.inverseInertia),g.isStatic||g.isSleeping||(g.positionPrev.x-=ae*g.inverseMass,g.positionPrev.y-=oe*g.inverseMass,g.anglePrev-=(W*oe-$*ae)*g.inverseInertia)}}}}})()},function(d,P,u){var e={};d.exports=e;var o=u(9),n=u(0);(function(){e.create=function(r){return n.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},r)},e.update=function(r,c,l){var f=r.list,s=f.length,t=r.table,i=c.length,a=r.collisionStart,m=r.collisionEnd,p=r.collisionActive,S,w,h,v;for(a.length=0,m.length=0,p.length=0,v=0;v<s;v++)f[v].confirmedActive=!1;for(v=0;v<i;v++)S=c[v],h=S.pair,h?(h.isActive?p.push(h):a.push(h),o.update(h,S,l),h.confirmedActive=!0):(h=o.create(S,l),t[h.id]=h,a.push(h),f.push(h));var x=[];for(s=f.length,v=0;v<s;v++)h=f[v],h.confirmedActive||(o.setActive(h,!1,l),m.push(h),!h.collision.bodyA.isSleeping&&!h.collision.bodyB.isSleeping&&x.push(v));for(v=0;v<x.length;v++)w=x[v]-v,h=f[w],f.splice(w,1),delete t[h.id]},e.clear=function(r){return r.table={},r.list.length=0,r.collisionStart.length=0,r.collisionActive.length=0,r.collisionEnd.length=0,r}})()},function(d,P,u){var e=d.exports=u(22);e.Axes=u(11),e.Bodies=u(12),e.Body=u(6),e.Bounds=u(1),e.Collision=u(8),e.Common=u(0),e.Composite=u(5),e.Composites=u(23),e.Constraint=u(10),e.Contact=u(17),e.Detector=u(14),e.Engine=u(18),e.Events=u(4),e.Grid=u(24),e.Mouse=u(13),e.MouseConstraint=u(25),e.Pair=u(9),e.Pairs=u(20),e.Plugin=u(15),e.Query=u(26),e.Render=u(16),e.Resolver=u(19),e.Runner=u(27),e.SAT=u(28),e.Sleeping=u(7),e.Svg=u(29),e.Vector=u(2),e.Vertices=u(3),e.World=u(30),e.Engine.run=e.Runner.run,e.Common.deprecated(e.Engine,"run","Engine.run \u27A4 use Matter.Runner.run(engine) instead")},function(d,P,u){var e={};d.exports=e;var o=u(15),n=u(0);(function(){e.name="matter-js",e.version="0.18.0",e.uses=[],e.used=[],e.use=function(){o.use(e,Array.prototype.slice.call(arguments))},e.before=function(r,c){return r=r.replace(/^Matter./,""),n.chainPathBefore(e,r,c)},e.after=function(r,c){return r=r.replace(/^Matter./,""),n.chainPathAfter(e,r,c)}})()},function(d,P,u){var e={};d.exports=e;var o=u(5),n=u(10),r=u(0),c=u(6),l=u(12),f=r.deprecated;(function(){e.stack=function(s,t,i,a,m,p,S){for(var w=o.create({label:"Stack"}),h=s,v=t,x,g=0,M=0;M<a;M++){for(var A=0,T=0;T<i;T++){var C=S(h,v,T,M,x,g);if(C){var E=C.bounds.max.y-C.bounds.min.y,I=C.bounds.max.x-C.bounds.min.x;E>A&&(A=E),c.translate(C,{x:I*.5,y:E*.5}),h=C.bounds.max.x+m,o.addBody(w,C),x=C,g+=1}else h+=m}v+=A+p,h=s}return w},e.chain=function(s,t,i,a,m,p){for(var S=s.bodies,w=1;w<S.length;w++){var h=S[w-1],v=S[w],x=h.bounds.max.y-h.bounds.min.y,g=h.bounds.max.x-h.bounds.min.x,M=v.bounds.max.y-v.bounds.min.y,A=v.bounds.max.x-v.bounds.min.x,T={bodyA:h,pointA:{x:g*t,y:x*i},bodyB:v,pointB:{x:A*a,y:M*m}},C=r.extend(T,p);o.addConstraint(s,n.create(C))}return s.label+=" Chain",s},e.mesh=function(s,t,i,a,m){var p=s.bodies,S,w,h,v,x;for(S=0;S<i;S++){for(w=1;w<t;w++)h=p[w-1+S*t],v=p[w+S*t],o.addConstraint(s,n.create(r.extend({bodyA:h,bodyB:v},m)));if(S>0)for(w=0;w<t;w++)h=p[w+(S-1)*t],v=p[w+S*t],o.addConstraint(s,n.create(r.extend({bodyA:h,bodyB:v},m))),a&&w>0&&(x=p[w-1+(S-1)*t],o.addConstraint(s,n.create(r.extend({bodyA:x,bodyB:v},m)))),a&&w<t-1&&(x=p[w+1+(S-1)*t],o.addConstraint(s,n.create(r.extend({bodyA:x,bodyB:v},m))))}return s.label+=" Mesh",s},e.pyramid=function(s,t,i,a,m,p,S){return e.stack(s,t,i,a,m,p,function(w,h,v,x,g,M){var A=Math.min(a,Math.ceil(i/2)),T=g?g.bounds.max.x-g.bounds.min.x:0;if(!(x>A)){x=A-x;var C=x,E=i-1-x;if(!(v<C||v>E)){M===1&&c.translate(g,{x:(v+(i%2===1?1:-1))*T,y:0});var I=g?v*T:0;return S(s+I+v*m,h,v,x,g,M)}}})},e.newtonsCradle=function(s,t,i,a,m){for(var p=o.create({label:"Newtons Cradle"}),S=0;S<i;S++){var w=1.9,h=l.circle(s+S*(a*w),t+m,a,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),v=n.create({pointA:{x:s+S*(a*w),y:t},bodyB:h});o.addBody(p,h),o.addConstraint(p,v)}return p},f(e,"newtonsCradle","Composites.newtonsCradle \u27A4 moved to newtonsCradle example"),e.car=function(s,t,i,a,m){var p=c.nextGroup(!0),S=20,w=-i*.5+S,h=i*.5-S,v=0,x=o.create({label:"Car"}),g=l.rectangle(s,t,i,a,{collisionFilter:{group:p},chamfer:{radius:a*.5},density:2e-4}),M=l.circle(s+w,t+v,m,{collisionFilter:{group:p},friction:.8}),A=l.circle(s+h,t+v,m,{collisionFilter:{group:p},friction:.8}),T=n.create({bodyB:g,pointB:{x:w,y:v},bodyA:M,stiffness:1,length:0}),C=n.create({bodyB:g,pointB:{x:h,y:v},bodyA:A,stiffness:1,length:0});return o.addBody(x,g),o.addBody(x,M),o.addBody(x,A),o.addConstraint(x,T),o.addConstraint(x,C),x},f(e,"car","Composites.car \u27A4 moved to car example"),e.softBody=function(s,t,i,a,m,p,S,w,h,v){h=r.extend({inertia:1/0},h),v=r.extend({stiffness:.2,render:{type:"line",anchors:!1}},v);var x=e.stack(s,t,i,a,m,p,function(g,M){return l.circle(g,M,w,h)});return e.mesh(x,i,a,S,v),x.label="Soft Body",x},f(e,"softBody","Composites.softBody \u27A4 moved to softBody and cloth examples")})()},function(d,P,u){var e={};d.exports=e;var o=u(9),n=u(0),r=n.deprecated;(function(){e.create=function(c){var l={buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48};return n.extend(l,c)},e.update=function(c,l,f,s){var t,i,a,m=f.world,p=c.buckets,S,w,h=!1;for(t=0;t<l.length;t++){var v=l[t];if(!(v.isSleeping&&!s)&&!(m.bounds&&(v.bounds.max.x<m.bounds.min.x||v.bounds.min.x>m.bounds.max.x||v.bounds.max.y<m.bounds.min.y||v.bounds.min.y>m.bounds.max.y))){var x=e._getRegion(c,v);if(!v.region||x.id!==v.region.id||s){(!v.region||s)&&(v.region=x);var g=e._regionUnion(x,v.region);for(i=g.startCol;i<=g.endCol;i++)for(a=g.startRow;a<=g.endRow;a++){w=e._getBucketId(i,a),S=p[w];var M=i>=x.startCol&&i<=x.endCol&&a>=x.startRow&&a<=x.endRow,A=i>=v.region.startCol&&i<=v.region.endCol&&a>=v.region.startRow&&a<=v.region.endRow;!M&&A&&A&&S&&e._bucketRemoveBody(c,S,v),(v.region===x||M&&!A||s)&&(S||(S=e._createBucket(p,w)),e._bucketAddBody(c,S,v))}v.region=x,h=!0}}}h&&(c.pairsList=e._createActivePairsList(c))},r(e,"update","Grid.update \u27A4 replaced by Matter.Detector"),e.clear=function(c){c.buckets={},c.pairs={},c.pairsList=[]},r(e,"clear","Grid.clear \u27A4 replaced by Matter.Detector"),e._regionUnion=function(c,l){var f=Math.min(c.startCol,l.startCol),s=Math.max(c.endCol,l.endCol),t=Math.min(c.startRow,l.startRow),i=Math.max(c.endRow,l.endRow);return e._createRegion(f,s,t,i)},e._getRegion=function(c,l){var f=l.bounds,s=Math.floor(f.min.x/c.bucketWidth),t=Math.floor(f.max.x/c.bucketWidth),i=Math.floor(f.min.y/c.bucketHeight),a=Math.floor(f.max.y/c.bucketHeight);return e._createRegion(s,t,i,a)},e._createRegion=function(c,l,f,s){return{id:c+","+l+","+f+","+s,startCol:c,endCol:l,startRow:f,endRow:s}},e._getBucketId=function(c,l){return"C"+c+"R"+l},e._createBucket=function(c,l){var f=c[l]=[];return f},e._bucketAddBody=function(c,l,f){var s=c.pairs,t=o.id,i=l.length,a;for(a=0;a<i;a++){var m=l[a];if(!(f.id===m.id||f.isStatic&&m.isStatic)){var p=t(f,m),S=s[p];S?S[2]+=1:s[p]=[f,m,1]}}l.push(f)},e._bucketRemoveBody=function(c,l,f){var s=c.pairs,t=o.id,i;l.splice(n.indexOf(l,f),1);var a=l.length;for(i=0;i<a;i++){var m=s[t(f,l[i])];m&&(m[2]-=1)}},e._createActivePairsList=function(c){var l,f=c.pairs,s=n.keys(f),t=s.length,i=[],a;for(a=0;a<t;a++)l=f[s[a]],l[2]>0?i.push(l):delete f[s[a]];return i}})()},function(d,P,u){var e={};d.exports=e;var o=u(3),n=u(7),r=u(13),c=u(4),l=u(14),f=u(10),s=u(5),t=u(0),i=u(1);(function(){e.create=function(a,m){var p=(a?a.mouse:null)||(m?m.mouse:null);p||(a&&a.render&&a.render.canvas?p=r.create(a.render.canvas):m&&m.element?p=r.create(m.element):(p=r.create(),t.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var S=f.create({label:"Mouse Constraint",pointA:p.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),w={type:"mouseConstraint",mouse:p,element:null,body:null,constraint:S,collisionFilter:{category:1,mask:4294967295,group:0}},h=t.extend(w,m);return c.on(a,"beforeUpdate",function(){var v=s.allBodies(a.world);e.update(h,v),e._triggerEvents(h)}),h},e.update=function(a,m){var p=a.mouse,S=a.constraint,w=a.body;if(p.button===0){if(S.bodyB)n.set(S.bodyB,!1),S.pointA=p.position;else for(var h=0;h<m.length;h++)if(w=m[h],i.contains(w.bounds,p.position)&&l.canCollide(w.collisionFilter,a.collisionFilter))for(var v=w.parts.length>1?1:0;v<w.parts.length;v++){var x=w.parts[v];if(o.contains(x.vertices,p.position)){S.pointA=p.position,S.bodyB=a.body=w,S.pointB={x:p.position.x-w.position.x,y:p.position.y-w.position.y},S.angleB=w.angle,n.set(w,!1),c.trigger(a,"startdrag",{mouse:p,body:w});break}}}else S.bodyB=a.body=null,S.pointB=null,w&&c.trigger(a,"enddrag",{mouse:p,body:w})},e._triggerEvents=function(a){var m=a.mouse,p=m.sourceEvents;p.mousemove&&c.trigger(a,"mousemove",{mouse:m}),p.mousedown&&c.trigger(a,"mousedown",{mouse:m}),p.mouseup&&c.trigger(a,"mouseup",{mouse:m}),r.clearSourceEvents(m)}})()},function(d,P,u){var e={};d.exports=e;var o=u(2),n=u(8),r=u(1),c=u(12),l=u(3);(function(){e.collides=function(f,s){for(var t=[],i=s.length,a=f.bounds,m=n.collides,p=r.overlaps,S=0;S<i;S++){var w=s[S],h=w.parts.length,v=h===1?0:1;if(p(w.bounds,a))for(var x=v;x<h;x++){var g=w.parts[x];if(p(g.bounds,a)){var M=m(g,f);if(M){t.push(M);break}}}}return t},e.ray=function(f,s,t,i){i=i||1e-100;for(var a=o.angle(s,t),m=o.magnitude(o.sub(s,t)),p=(t.x+s.x)*.5,S=(t.y+s.y)*.5,w=c.rectangle(p,S,m,i,{angle:a}),h=e.collides(w,f),v=0;v<h.length;v+=1){var x=h[v];x.body=x.bodyB=x.bodyA}return h},e.region=function(f,s,t){for(var i=[],a=0;a<f.length;a++){var m=f[a],p=r.overlaps(m.bounds,s);(p&&!t||!p&&t)&&i.push(m)}return i},e.point=function(f,s){for(var t=[],i=0;i<f.length;i++){var a=f[i];if(r.contains(a.bounds,s))for(var m=a.parts.length===1?0:1;m<a.parts.length;m++){var p=a.parts[m];if(r.contains(p.bounds,s)&&l.contains(p.vertices,s)){t.push(a);break}}}return t}})()},function(d,P,u){var e={};d.exports=e;var o=u(4),n=u(18),r=u(0);(function(){var c,l;if(typeof window<"u"&&(c=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,l=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),!c){var f;c=function(s){f=setTimeout(function(){s(r.now())},1e3/60)},l=function(){clearTimeout(f)}}e.create=function(s){var t={fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},i=r.extend(t,s);return i.delta=i.delta||1e3/i.fps,i.deltaMin=i.deltaMin||1e3/i.fps,i.deltaMax=i.deltaMax||1e3/(i.fps*.5),i.fps=1e3/i.delta,i},e.run=function(s,t){return typeof s.positionIterations<"u"&&(t=s,s=e.create()),function i(a){s.frameRequestId=c(i),a&&s.enabled&&e.tick(s,t,a)}(),s},e.tick=function(s,t,i){var a=t.timing,m=1,p,S={timestamp:a.timestamp};o.trigger(s,"beforeTick",S),s.isFixed?p=s.delta:(p=i-s.timePrev||s.delta,s.timePrev=i,s.deltaHistory.push(p),s.deltaHistory=s.deltaHistory.slice(-s.deltaSampleSize),p=Math.min.apply(null,s.deltaHistory),p=p<s.deltaMin?s.deltaMin:p,p=p>s.deltaMax?s.deltaMax:p,m=p/s.delta,s.delta=p),s.timeScalePrev!==0&&(m*=a.timeScale/s.timeScalePrev),a.timeScale===0&&(m=0),s.timeScalePrev=a.timeScale,s.correction=m,s.frameCounter+=1,i-s.counterTimestamp>=1e3&&(s.fps=s.frameCounter*((i-s.counterTimestamp)/1e3),s.counterTimestamp=i,s.frameCounter=0),o.trigger(s,"tick",S),o.trigger(s,"beforeUpdate",S),n.update(t,p,m),o.trigger(s,"afterUpdate",S),o.trigger(s,"afterTick",S)},e.stop=function(s){l(s.frameRequestId)},e.start=function(s,t){e.run(s,t)}})()},function(d,P,u){var e={};d.exports=e;var o=u(8),n=u(0),r=n.deprecated;(function(){e.collides=function(c,l){return o.collides(c,l)},r(e,"collides","SAT.collides \u27A4 replaced by Collision.collides")})()},function(d,P,u){var e={};d.exports=e,u(1);var o=u(0);(function(){e.pathToVertices=function(n,r){typeof window<"u"&&!("SVGPathSeg"in window)&&o.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var c,l,f,s,t,i,a,m,p,S,w=[],h,v,x=0,g=0,M=0;r=r||15;var A=function(C,E,I){var R=I%2===1&&I>1;if(!p||C!=p.x||E!=p.y){p&&R?(h=p.x,v=p.y):(h=0,v=0);var F={x:h+C,y:v+E};(R||!p)&&(p=F),w.push(F),g=h+C,M=v+E}},T=function(C){var E=C.pathSegTypeAsLetter.toUpperCase();if(E!=="Z"){switch(E){case"M":case"L":case"T":case"C":case"S":case"Q":g=C.x,M=C.y;break;case"H":g=C.x;break;case"V":M=C.y;break}A(g,M,C.pathSegType)}};for(e._svgPathToAbsolute(n),f=n.getTotalLength(),i=[],c=0;c<n.pathSegList.numberOfItems;c+=1)i.push(n.pathSegList.getItem(c));for(a=i.concat();x<f;){if(S=n.getPathSegAtLength(x),t=i[S],t!=m){for(;a.length&&a[0]!=t;)T(a.shift());m=t}switch(t.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":s=n.getPointAtLength(x),A(s.x,s.y,0);break}x+=r}for(c=0,l=a.length;c<l;++c)T(a[c]);return w},e._svgPathToAbsolute=function(n){for(var r,c,l,f,s,t,i=n.pathSegList,a=0,m=0,p=i.numberOfItems,S=0;S<p;++S){var w=i.getItem(S),h=w.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(h))"x"in w&&(a=w.x),"y"in w&&(m=w.y);else switch("x1"in w&&(l=a+w.x1),"x2"in w&&(s=a+w.x2),"y1"in w&&(f=m+w.y1),"y2"in w&&(t=m+w.y2),"x"in w&&(a+=w.x),"y"in w&&(m+=w.y),h){case"m":i.replaceItem(n.createSVGPathSegMovetoAbs(a,m),S);break;case"l":i.replaceItem(n.createSVGPathSegLinetoAbs(a,m),S);break;case"h":i.replaceItem(n.createSVGPathSegLinetoHorizontalAbs(a),S);break;case"v":i.replaceItem(n.createSVGPathSegLinetoVerticalAbs(m),S);break;case"c":i.replaceItem(n.createSVGPathSegCurvetoCubicAbs(a,m,l,f,s,t),S);break;case"s":i.replaceItem(n.createSVGPathSegCurvetoCubicSmoothAbs(a,m,s,t),S);break;case"q":i.replaceItem(n.createSVGPathSegCurvetoQuadraticAbs(a,m,l,f),S);break;case"t":i.replaceItem(n.createSVGPathSegCurvetoQuadraticSmoothAbs(a,m),S);break;case"a":i.replaceItem(n.createSVGPathSegArcAbs(a,m,w.r1,w.r2,w.angle,w.largeArcFlag,w.sweepFlag),S);break;case"z":case"Z":a=r,m=c;break}(h=="M"||h=="m")&&(r=a,c=m)}}})()},function(d,P,u){var e={};d.exports=e;var o=u(5);u(0),function(){e.create=o.create,e.add=o.add,e.remove=o.remove,e.clear=o.clear,e.addComposite=o.addComposite,e.addBody=o.addBody,e.addConstraint=o.addConstraint}()}])})})(ht);export{ft as A,X as C,pt as E,Xe as a,St as b,lt as c,yt as d,xt as e,dt as f,gt as g,wt as i,Y as l};
